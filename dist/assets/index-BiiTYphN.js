import{r as bn,a as jn,g as vn}from"./vendor-DavUf6mE.js";import{r as l,u as he,a as Rt,R as we,b as Mt,B as wn,c as Nn,d as Q,N as qs}from"./router-DQvsklb9.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(o){if(o.ep)return;o.ep=!0;const n=r(o);fetch(o.href,n)}})();var Es={exports:{}},wt={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gr;function Sn(){if(gr)return wt;gr=1;var t=bn(),s=Symbol.for("react.element"),r=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,n={key:!0,ref:!0,__self:!0,__source:!0};function i(c,m,u){var h,f={},b=null,w=null;u!==void 0&&(b=""+u),m.key!==void 0&&(b=""+m.key),m.ref!==void 0&&(w=m.ref);for(h in m)a.call(m,h)&&!n.hasOwnProperty(h)&&(f[h]=m[h]);if(c&&c.defaultProps)for(h in m=c.defaultProps,m)f[h]===void 0&&(f[h]=m[h]);return{$$typeof:s,type:c,key:b,ref:w,props:f,_owner:o.current}}return wt.Fragment=r,wt.jsx=i,wt.jsxs=i,wt}var fr;function kn(){return fr||(fr=1,Es.exports=Sn()),Es.exports}var e=kn(),Kt={},yr;function Cn(){if(yr)return Kt;yr=1;var t=jn();return Kt.createRoot=t.createRoot,Kt.hydrateRoot=t.hydrateRoot,Kt}var An=Cn();const Tn=vn(An);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pn=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),En=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(s,r,a)=>a?a.toUpperCase():r.toLowerCase()),br=t=>{const s=En(t);return s.charAt(0).toUpperCase()+s.slice(1)},oa=(...t)=>t.filter((s,r,a)=>!!s&&s.trim()!==""&&a.indexOf(s)===r).join(" ").trim(),Dn=t=>{for(const s in t)if(s.startsWith("aria-")||s==="role"||s==="title")return!0};/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var On={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ln=l.forwardRef(({color:t="currentColor",size:s=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:o="",children:n,iconNode:i,...c},m)=>l.createElement("svg",{ref:m,...On,width:s,height:s,stroke:t,strokeWidth:a?Number(r)*24/Number(s):r,className:oa("lucide",o),...!n&&!Dn(c)&&{"aria-hidden":"true"},...c},[...i.map(([u,h])=>l.createElement(u,h)),...Array.isArray(n)?n:[n]]));/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=(t,s)=>{const r=l.forwardRef(({className:a,...o},n)=>l.createElement(Ln,{ref:n,iconNode:s,className:oa(`lucide-${Pn(br(t))}`,`lucide-${t}`,a),...o}));return r.displayName=br(t),r};/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rn=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],jr=$("activity",Rn);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mn=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Oe=$("arrow-left",Mn);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fn=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Qe=$("arrow-right",Fn);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const In=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],vr=$("bot",In);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _n=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],$n=$("brain",_n);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vn=[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]],sr=$("building-2",Vn);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Un=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],rr=$("check",Un);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zn=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],et=$("chevron-down",zn);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bn=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],fs=$("chevron-left",Bn);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qn=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],gt=$("chevron-right",qn);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hn=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Gn=$("chevron-up",Hn);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wn=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],be=$("circle-alert",Wn);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yn=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Pe=$("circle-check-big",Yn);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xn=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],wr=$("circle",Xn);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jn=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ft=$("clock",Jn);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kn=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],ia=$("cloud-upload",Kn);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qn=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],Je=$("code",Qn);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zn=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Ds=$("copy",Zn);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eo=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],la=$("cpu",eo);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const to=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],so=$("credit-card",to);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],at=$("database",ro);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ao=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Ze=$("download",ao);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const no=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],cs=$("eye-off",no);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oo=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],xt=$("eye",oo);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const io=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],lo=$("file-down",io);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const co=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Me=$("file-text",co);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uo=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],Hs=$("folder-open",uo);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mo=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],ho=$("git-branch",mo);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xo=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["path",{d:"M11 18H8a2 2 0 0 1-2-2V9",key:"19pyzm"}]],po=$("git-compare",xo);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const go=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],fo=$("grid-3x3",go);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yo=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],ca=$("history",yo);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bo=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],jo=$("house",bo);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vo=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],wo=$("image",vo);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const No=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],da=$("info",No);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const So=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],ko=$("key",So);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Co=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],Gs=$("lightbulb",Co);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ao=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],To=$("list",Ao);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Po=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Ws=$("loader-circle",Po);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eo=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],ua=$("loader",Eo);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Do=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Ys=$("log-out",Do);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oo=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Nr=$("map-pin",Oo);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lo=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],Ro=$("maximize-2",Lo);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mo=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],Fo=$("menu",Mo);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Io=[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]],ar=$("message-circle",Io);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _o=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],ds=$("message-square",_o);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $o=[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]],Vo=$("minimize-2",$o);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uo=[["path",{d:"M5 12h14",key:"1ays0h"}]],zo=$("minus",Uo);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bo=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],ma=$("monitor",Bo);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qo=[["path",{d:"M12 22v-5",key:"1ega77"}],["path",{d:"M9 8V2",key:"14iosj"}],["path",{d:"M15 8V2",key:"18g5xt"}],["path",{d:"M18 8v5a4 4 0 0 1-4 4h-4a4 4 0 0 1-4-4V8Z",key:"osxo6l"}]],Ho=$("plug",qo);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Go=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],pt=$("plus",Go);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wo=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Ne=$("refresh-cw",Wo);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yo=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],us=$("rotate-ccw",Yo);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xo=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],He=$("save",Xo);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jo=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Pt=$("search",Jo);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ko=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],ys=$("send",Ko);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qo=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],nr=$("settings",Qo);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zo=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],qe=$("shield",Zo);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ei=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],ti=$("smartphone",ei);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const si=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],ri=$("sparkles",si);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ai=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],ni=$("square-pen",ai);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oi=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],ii=$("tag",oi);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const li=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Ft=$("trash-2",li);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ci=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],It=$("triangle-alert",ci);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const di=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],_t=$("upload",di);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ui=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ha=$("user",ui);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mi=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],bs=$("users",mi);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hi=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],xa=$("wand-sparkles",hi);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xi=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],pa=$("wifi-off",xi);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pi=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],ga=$("wifi",pi);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gi=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ie=$("x",gi);/**
 * @license lucide-react v0.533.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fi=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],js=$("zap",fi),je="/assets/logo-CwhF-OLf.png";function fa(t,s){return function(){return t.apply(s,arguments)}}const{toString:yi}=Object.prototype,{getPrototypeOf:or}=Object,{iterator:vs,toStringTag:ya}=Symbol,ws=(t=>s=>{const r=yi.call(s);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),_e=t=>(t=t.toLowerCase(),s=>ws(s)===t),Ns=t=>s=>typeof s===t,{isArray:yt}=Array,Ot=Ns("undefined");function $t(t){return t!==null&&!Ot(t)&&t.constructor!==null&&!Ot(t.constructor)&&ke(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const ba=_e("ArrayBuffer");function bi(t){let s;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?s=ArrayBuffer.isView(t):s=t&&t.buffer&&ba(t.buffer),s}const ji=Ns("string"),ke=Ns("function"),ja=Ns("number"),Vt=t=>t!==null&&typeof t=="object",vi=t=>t===!0||t===!1,os=t=>{if(ws(t)!=="object")return!1;const s=or(t);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(ya in t)&&!(vs in t)},wi=t=>{if(!Vt(t)||$t(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},Ni=_e("Date"),Si=_e("File"),ki=_e("Blob"),Ci=_e("FileList"),Ai=t=>Vt(t)&&ke(t.pipe),Ti=t=>{let s;return t&&(typeof FormData=="function"&&t instanceof FormData||ke(t.append)&&((s=ws(t))==="formdata"||s==="object"&&ke(t.toString)&&t.toString()==="[object FormData]"))},Pi=_e("URLSearchParams"),[Ei,Di,Oi,Li]=["ReadableStream","Request","Response","Headers"].map(_e),Ri=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ut(t,s,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let a,o;if(typeof t!="object"&&(t=[t]),yt(t))for(a=0,o=t.length;a<o;a++)s.call(null,t[a],a,t);else{if($t(t))return;const n=r?Object.getOwnPropertyNames(t):Object.keys(t),i=n.length;let c;for(a=0;a<i;a++)c=n[a],s.call(null,t[c],c,t)}}function va(t,s){if($t(t))return null;s=s.toLowerCase();const r=Object.keys(t);let a=r.length,o;for(;a-- >0;)if(o=r[a],s===o.toLowerCase())return o;return null}const rt=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,wa=t=>!Ot(t)&&t!==rt;function Xs(){const{caseless:t}=wa(this)&&this||{},s={},r=(a,o)=>{const n=t&&va(s,o)||o;os(s[n])&&os(a)?s[n]=Xs(s[n],a):os(a)?s[n]=Xs({},a):yt(a)?s[n]=a.slice():s[n]=a};for(let a=0,o=arguments.length;a<o;a++)arguments[a]&&Ut(arguments[a],r);return s}const Mi=(t,s,r,{allOwnKeys:a}={})=>(Ut(s,(o,n)=>{r&&ke(o)?t[n]=fa(o,r):t[n]=o},{allOwnKeys:a}),t),Fi=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),Ii=(t,s,r,a)=>{t.prototype=Object.create(s.prototype,a),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:s.prototype}),r&&Object.assign(t.prototype,r)},_i=(t,s,r,a)=>{let o,n,i;const c={};if(s=s||{},t==null)return s;do{for(o=Object.getOwnPropertyNames(t),n=o.length;n-- >0;)i=o[n],(!a||a(i,t,s))&&!c[i]&&(s[i]=t[i],c[i]=!0);t=r!==!1&&or(t)}while(t&&(!r||r(t,s))&&t!==Object.prototype);return s},$i=(t,s,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=s.length;const a=t.indexOf(s,r);return a!==-1&&a===r},Vi=t=>{if(!t)return null;if(yt(t))return t;let s=t.length;if(!ja(s))return null;const r=new Array(s);for(;s-- >0;)r[s]=t[s];return r},Ui=(t=>s=>t&&s instanceof t)(typeof Uint8Array<"u"&&or(Uint8Array)),zi=(t,s)=>{const a=(t&&t[vs]).call(t);let o;for(;(o=a.next())&&!o.done;){const n=o.value;s.call(t,n[0],n[1])}},Bi=(t,s)=>{let r;const a=[];for(;(r=t.exec(s))!==null;)a.push(r);return a},qi=_e("HTMLFormElement"),Hi=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,a,o){return a.toUpperCase()+o}),Sr=(({hasOwnProperty:t})=>(s,r)=>t.call(s,r))(Object.prototype),Gi=_e("RegExp"),Na=(t,s)=>{const r=Object.getOwnPropertyDescriptors(t),a={};Ut(r,(o,n)=>{let i;(i=s(o,n,t))!==!1&&(a[n]=i||o)}),Object.defineProperties(t,a)},Wi=t=>{Na(t,(s,r)=>{if(ke(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const a=t[r];if(ke(a)){if(s.enumerable=!1,"writable"in s){s.writable=!1;return}s.set||(s.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},Yi=(t,s)=>{const r={},a=o=>{o.forEach(n=>{r[n]=!0})};return yt(t)?a(t):a(String(t).split(s)),r},Xi=()=>{},Ji=(t,s)=>t!=null&&Number.isFinite(t=+t)?t:s;function Ki(t){return!!(t&&ke(t.append)&&t[ya]==="FormData"&&t[vs])}const Qi=t=>{const s=new Array(10),r=(a,o)=>{if(Vt(a)){if(s.indexOf(a)>=0)return;if($t(a))return a;if(!("toJSON"in a)){s[o]=a;const n=yt(a)?[]:{};return Ut(a,(i,c)=>{const m=r(i,o+1);!Ot(m)&&(n[c]=m)}),s[o]=void 0,n}}return a};return r(t,0)},Zi=_e("AsyncFunction"),el=t=>t&&(Vt(t)||ke(t))&&ke(t.then)&&ke(t.catch),Sa=((t,s)=>t?setImmediate:s?((r,a)=>(rt.addEventListener("message",({source:o,data:n})=>{o===rt&&n===r&&a.length&&a.shift()()},!1),o=>{a.push(o),rt.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",ke(rt.postMessage)),tl=typeof queueMicrotask<"u"?queueMicrotask.bind(rt):typeof process<"u"&&process.nextTick||Sa,sl=t=>t!=null&&ke(t[vs]),E={isArray:yt,isArrayBuffer:ba,isBuffer:$t,isFormData:Ti,isArrayBufferView:bi,isString:ji,isNumber:ja,isBoolean:vi,isObject:Vt,isPlainObject:os,isEmptyObject:wi,isReadableStream:Ei,isRequest:Di,isResponse:Oi,isHeaders:Li,isUndefined:Ot,isDate:Ni,isFile:Si,isBlob:ki,isRegExp:Gi,isFunction:ke,isStream:Ai,isURLSearchParams:Pi,isTypedArray:Ui,isFileList:Ci,forEach:Ut,merge:Xs,extend:Mi,trim:Ri,stripBOM:Fi,inherits:Ii,toFlatObject:_i,kindOf:ws,kindOfTest:_e,endsWith:$i,toArray:Vi,forEachEntry:zi,matchAll:Bi,isHTMLForm:qi,hasOwnProperty:Sr,hasOwnProp:Sr,reduceDescriptors:Na,freezeMethods:Wi,toObjectSet:Yi,toCamelCase:Hi,noop:Xi,toFiniteNumber:Ji,findKey:va,global:rt,isContextDefined:wa,isSpecCompliantForm:Ki,toJSONObject:Qi,isAsyncFn:Zi,isThenable:el,setImmediate:Sa,asap:tl,isIterable:sl};function q(t,s,r,a,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",s&&(this.code=s),r&&(this.config=r),a&&(this.request=a),o&&(this.response=o,this.status=o.status?o.status:null)}E.inherits(q,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:E.toJSONObject(this.config),code:this.code,status:this.status}}});const ka=q.prototype,Ca={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Ca[t]={value:t}});Object.defineProperties(q,Ca);Object.defineProperty(ka,"isAxiosError",{value:!0});q.from=(t,s,r,a,o,n)=>{const i=Object.create(ka);return E.toFlatObject(t,i,function(m){return m!==Error.prototype},c=>c!=="isAxiosError"),q.call(i,t.message,s,r,a,o),i.cause=t,i.name=t.name,n&&Object.assign(i,n),i};const rl=null;function Js(t){return E.isPlainObject(t)||E.isArray(t)}function Aa(t){return E.endsWith(t,"[]")?t.slice(0,-2):t}function kr(t,s,r){return t?t.concat(s).map(function(o,n){return o=Aa(o),!r&&n?"["+o+"]":o}).join(r?".":""):s}function al(t){return E.isArray(t)&&!t.some(Js)}const nl=E.toFlatObject(E,{},null,function(s){return/^is[A-Z]/.test(s)});function Ss(t,s,r){if(!E.isObject(t))throw new TypeError("target must be an object");s=s||new FormData,r=E.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(S,N){return!E.isUndefined(N[S])});const a=r.metaTokens,o=r.visitor||h,n=r.dots,i=r.indexes,m=(r.Blob||typeof Blob<"u"&&Blob)&&E.isSpecCompliantForm(s);if(!E.isFunction(o))throw new TypeError("visitor must be a function");function u(p){if(p===null)return"";if(E.isDate(p))return p.toISOString();if(E.isBoolean(p))return p.toString();if(!m&&E.isBlob(p))throw new q("Blob is not supported. Use a Buffer instead.");return E.isArrayBuffer(p)||E.isTypedArray(p)?m&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function h(p,S,N){let C=p;if(p&&!N&&typeof p=="object"){if(E.endsWith(S,"{}"))S=a?S:S.slice(0,-2),p=JSON.stringify(p);else if(E.isArray(p)&&al(p)||(E.isFileList(p)||E.endsWith(S,"[]"))&&(C=E.toArray(p)))return S=Aa(S),C.forEach(function(j,v){!(E.isUndefined(j)||j===null)&&s.append(i===!0?kr([S],v,n):i===null?S:S+"[]",u(j))}),!1}return Js(p)?!0:(s.append(kr(N,S,n),u(p)),!1)}const f=[],b=Object.assign(nl,{defaultVisitor:h,convertValue:u,isVisitable:Js});function w(p,S){if(!E.isUndefined(p)){if(f.indexOf(p)!==-1)throw Error("Circular reference detected in "+S.join("."));f.push(p),E.forEach(p,function(C,k){(!(E.isUndefined(C)||C===null)&&o.call(s,C,E.isString(k)?k.trim():k,S,b))===!0&&w(C,S?S.concat(k):[k])}),f.pop()}}if(!E.isObject(t))throw new TypeError("data must be an object");return w(t),s}function Cr(t){const s={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(a){return s[a]})}function ir(t,s){this._pairs=[],t&&Ss(t,this,s)}const Ta=ir.prototype;Ta.append=function(s,r){this._pairs.push([s,r])};Ta.toString=function(s){const r=s?function(a){return s.call(this,a,Cr)}:Cr;return this._pairs.map(function(o){return r(o[0])+"="+r(o[1])},"").join("&")};function ol(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Pa(t,s,r){if(!s)return t;const a=r&&r.encode||ol;E.isFunction(r)&&(r={serialize:r});const o=r&&r.serialize;let n;if(o?n=o(s,r):n=E.isURLSearchParams(s)?s.toString():new ir(s,r).toString(a),n){const i=t.indexOf("#");i!==-1&&(t=t.slice(0,i)),t+=(t.indexOf("?")===-1?"?":"&")+n}return t}class Ar{constructor(){this.handlers=[]}use(s,r,a){return this.handlers.push({fulfilled:s,rejected:r,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(s){this.handlers[s]&&(this.handlers[s]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(s){E.forEach(this.handlers,function(a){a!==null&&s(a)})}}const Ea={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},il=typeof URLSearchParams<"u"?URLSearchParams:ir,ll=typeof FormData<"u"?FormData:null,cl=typeof Blob<"u"?Blob:null,dl={isBrowser:!0,classes:{URLSearchParams:il,FormData:ll,Blob:cl},protocols:["http","https","file","blob","url","data"]},lr=typeof window<"u"&&typeof document<"u",Ks=typeof navigator=="object"&&navigator||void 0,ul=lr&&(!Ks||["ReactNative","NativeScript","NS"].indexOf(Ks.product)<0),ml=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",hl=lr&&window.location.href||"http://localhost",xl=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:lr,hasStandardBrowserEnv:ul,hasStandardBrowserWebWorkerEnv:ml,navigator:Ks,origin:hl},Symbol.toStringTag,{value:"Module"})),ye={...xl,...dl};function pl(t,s){return Ss(t,new ye.classes.URLSearchParams,{visitor:function(r,a,o,n){return ye.isNode&&E.isBuffer(r)?(this.append(a,r.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)},...s})}function gl(t){return E.matchAll(/\w+|\[(\w*)]/g,t).map(s=>s[0]==="[]"?"":s[1]||s[0])}function fl(t){const s={},r=Object.keys(t);let a;const o=r.length;let n;for(a=0;a<o;a++)n=r[a],s[n]=t[n];return s}function Da(t){function s(r,a,o,n){let i=r[n++];if(i==="__proto__")return!0;const c=Number.isFinite(+i),m=n>=r.length;return i=!i&&E.isArray(o)?o.length:i,m?(E.hasOwnProp(o,i)?o[i]=[o[i],a]:o[i]=a,!c):((!o[i]||!E.isObject(o[i]))&&(o[i]=[]),s(r,a,o[i],n)&&E.isArray(o[i])&&(o[i]=fl(o[i])),!c)}if(E.isFormData(t)&&E.isFunction(t.entries)){const r={};return E.forEachEntry(t,(a,o)=>{s(gl(a),o,r,0)}),r}return null}function yl(t,s,r){if(E.isString(t))try{return(s||JSON.parse)(t),E.trim(t)}catch(a){if(a.name!=="SyntaxError")throw a}return(r||JSON.stringify)(t)}const zt={transitional:Ea,adapter:["xhr","http","fetch"],transformRequest:[function(s,r){const a=r.getContentType()||"",o=a.indexOf("application/json")>-1,n=E.isObject(s);if(n&&E.isHTMLForm(s)&&(s=new FormData(s)),E.isFormData(s))return o?JSON.stringify(Da(s)):s;if(E.isArrayBuffer(s)||E.isBuffer(s)||E.isStream(s)||E.isFile(s)||E.isBlob(s)||E.isReadableStream(s))return s;if(E.isArrayBufferView(s))return s.buffer;if(E.isURLSearchParams(s))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),s.toString();let c;if(n){if(a.indexOf("application/x-www-form-urlencoded")>-1)return pl(s,this.formSerializer).toString();if((c=E.isFileList(s))||a.indexOf("multipart/form-data")>-1){const m=this.env&&this.env.FormData;return Ss(c?{"files[]":s}:s,m&&new m,this.formSerializer)}}return n||o?(r.setContentType("application/json",!1),yl(s)):s}],transformResponse:[function(s){const r=this.transitional||zt.transitional,a=r&&r.forcedJSONParsing,o=this.responseType==="json";if(E.isResponse(s)||E.isReadableStream(s))return s;if(s&&E.isString(s)&&(a&&!this.responseType||o)){const i=!(r&&r.silentJSONParsing)&&o;try{return JSON.parse(s)}catch(c){if(i)throw c.name==="SyntaxError"?q.from(c,q.ERR_BAD_RESPONSE,this,null,this.response):c}}return s}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ye.classes.FormData,Blob:ye.classes.Blob},validateStatus:function(s){return s>=200&&s<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};E.forEach(["delete","get","head","post","put","patch"],t=>{zt.headers[t]={}});const bl=E.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),jl=t=>{const s={};let r,a,o;return t&&t.split(`
`).forEach(function(i){o=i.indexOf(":"),r=i.substring(0,o).trim().toLowerCase(),a=i.substring(o+1).trim(),!(!r||s[r]&&bl[r])&&(r==="set-cookie"?s[r]?s[r].push(a):s[r]=[a]:s[r]=s[r]?s[r]+", "+a:a)}),s},Tr=Symbol("internals");function Nt(t){return t&&String(t).trim().toLowerCase()}function is(t){return t===!1||t==null?t:E.isArray(t)?t.map(is):String(t)}function vl(t){const s=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=r.exec(t);)s[a[1]]=a[2];return s}const wl=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Os(t,s,r,a,o){if(E.isFunction(a))return a.call(this,s,r);if(o&&(s=r),!!E.isString(s)){if(E.isString(a))return s.indexOf(a)!==-1;if(E.isRegExp(a))return a.test(s)}}function Nl(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(s,r,a)=>r.toUpperCase()+a)}function Sl(t,s){const r=E.toCamelCase(" "+s);["get","set","has"].forEach(a=>{Object.defineProperty(t,a+r,{value:function(o,n,i){return this[a].call(this,s,o,n,i)},configurable:!0})})}let Ce=class{constructor(s){s&&this.set(s)}set(s,r,a){const o=this;function n(c,m,u){const h=Nt(m);if(!h)throw new Error("header name must be a non-empty string");const f=E.findKey(o,h);(!f||o[f]===void 0||u===!0||u===void 0&&o[f]!==!1)&&(o[f||m]=is(c))}const i=(c,m)=>E.forEach(c,(u,h)=>n(u,h,m));if(E.isPlainObject(s)||s instanceof this.constructor)i(s,r);else if(E.isString(s)&&(s=s.trim())&&!wl(s))i(jl(s),r);else if(E.isObject(s)&&E.isIterable(s)){let c={},m,u;for(const h of s){if(!E.isArray(h))throw TypeError("Object iterator must return a key-value pair");c[u=h[0]]=(m=c[u])?E.isArray(m)?[...m,h[1]]:[m,h[1]]:h[1]}i(c,r)}else s!=null&&n(r,s,a);return this}get(s,r){if(s=Nt(s),s){const a=E.findKey(this,s);if(a){const o=this[a];if(!r)return o;if(r===!0)return vl(o);if(E.isFunction(r))return r.call(this,o,a);if(E.isRegExp(r))return r.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(s,r){if(s=Nt(s),s){const a=E.findKey(this,s);return!!(a&&this[a]!==void 0&&(!r||Os(this,this[a],a,r)))}return!1}delete(s,r){const a=this;let o=!1;function n(i){if(i=Nt(i),i){const c=E.findKey(a,i);c&&(!r||Os(a,a[c],c,r))&&(delete a[c],o=!0)}}return E.isArray(s)?s.forEach(n):n(s),o}clear(s){const r=Object.keys(this);let a=r.length,o=!1;for(;a--;){const n=r[a];(!s||Os(this,this[n],n,s,!0))&&(delete this[n],o=!0)}return o}normalize(s){const r=this,a={};return E.forEach(this,(o,n)=>{const i=E.findKey(a,n);if(i){r[i]=is(o),delete r[n];return}const c=s?Nl(n):String(n).trim();c!==n&&delete r[n],r[c]=is(o),a[c]=!0}),this}concat(...s){return this.constructor.concat(this,...s)}toJSON(s){const r=Object.create(null);return E.forEach(this,(a,o)=>{a!=null&&a!==!1&&(r[o]=s&&E.isArray(a)?a.join(", "):a)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([s,r])=>s+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(s){return s instanceof this?s:new this(s)}static concat(s,...r){const a=new this(s);return r.forEach(o=>a.set(o)),a}static accessor(s){const a=(this[Tr]=this[Tr]={accessors:{}}).accessors,o=this.prototype;function n(i){const c=Nt(i);a[c]||(Sl(o,i),a[c]=!0)}return E.isArray(s)?s.forEach(n):n(s),this}};Ce.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);E.reduceDescriptors(Ce.prototype,({value:t},s)=>{let r=s[0].toUpperCase()+s.slice(1);return{get:()=>t,set(a){this[r]=a}}});E.freezeMethods(Ce);function Ls(t,s){const r=this||zt,a=s||r,o=Ce.from(a.headers);let n=a.data;return E.forEach(t,function(c){n=c.call(r,n,o.normalize(),s?s.status:void 0)}),o.normalize(),n}function Oa(t){return!!(t&&t.__CANCEL__)}function bt(t,s,r){q.call(this,t??"canceled",q.ERR_CANCELED,s,r),this.name="CanceledError"}E.inherits(bt,q,{__CANCEL__:!0});function La(t,s,r){const a=r.config.validateStatus;!r.status||!a||a(r.status)?t(r):s(new q("Request failed with status code "+r.status,[q.ERR_BAD_REQUEST,q.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function kl(t){const s=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return s&&s[1]||""}function Cl(t,s){t=t||10;const r=new Array(t),a=new Array(t);let o=0,n=0,i;return s=s!==void 0?s:1e3,function(m){const u=Date.now(),h=a[n];i||(i=u),r[o]=m,a[o]=u;let f=n,b=0;for(;f!==o;)b+=r[f++],f=f%t;if(o=(o+1)%t,o===n&&(n=(n+1)%t),u-i<s)return;const w=h&&u-h;return w?Math.round(b*1e3/w):void 0}}function Al(t,s){let r=0,a=1e3/s,o,n;const i=(u,h=Date.now())=>{r=h,o=null,n&&(clearTimeout(n),n=null),t(...u)};return[(...u)=>{const h=Date.now(),f=h-r;f>=a?i(u,h):(o=u,n||(n=setTimeout(()=>{n=null,i(o)},a-f)))},()=>o&&i(o)]}const ms=(t,s,r=3)=>{let a=0;const o=Cl(50,250);return Al(n=>{const i=n.loaded,c=n.lengthComputable?n.total:void 0,m=i-a,u=o(m),h=i<=c;a=i;const f={loaded:i,total:c,progress:c?i/c:void 0,bytes:m,rate:u||void 0,estimated:u&&c&&h?(c-i)/u:void 0,event:n,lengthComputable:c!=null,[s?"download":"upload"]:!0};t(f)},r)},Pr=(t,s)=>{const r=t!=null;return[a=>s[0]({lengthComputable:r,total:t,loaded:a}),s[1]]},Er=t=>(...s)=>E.asap(()=>t(...s)),Tl=ye.hasStandardBrowserEnv?((t,s)=>r=>(r=new URL(r,ye.origin),t.protocol===r.protocol&&t.host===r.host&&(s||t.port===r.port)))(new URL(ye.origin),ye.navigator&&/(msie|trident)/i.test(ye.navigator.userAgent)):()=>!0,Pl=ye.hasStandardBrowserEnv?{write(t,s,r,a,o,n){const i=[t+"="+encodeURIComponent(s)];E.isNumber(r)&&i.push("expires="+new Date(r).toGMTString()),E.isString(a)&&i.push("path="+a),E.isString(o)&&i.push("domain="+o),n===!0&&i.push("secure"),document.cookie=i.join("; ")},read(t){const s=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return s?decodeURIComponent(s[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function El(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function Dl(t,s){return s?t.replace(/\/?\/$/,"")+"/"+s.replace(/^\/+/,""):t}function Ra(t,s,r){let a=!El(s);return t&&(a||r==!1)?Dl(t,s):s}const Dr=t=>t instanceof Ce?{...t}:t;function ot(t,s){s=s||{};const r={};function a(u,h,f,b){return E.isPlainObject(u)&&E.isPlainObject(h)?E.merge.call({caseless:b},u,h):E.isPlainObject(h)?E.merge({},h):E.isArray(h)?h.slice():h}function o(u,h,f,b){if(E.isUndefined(h)){if(!E.isUndefined(u))return a(void 0,u,f,b)}else return a(u,h,f,b)}function n(u,h){if(!E.isUndefined(h))return a(void 0,h)}function i(u,h){if(E.isUndefined(h)){if(!E.isUndefined(u))return a(void 0,u)}else return a(void 0,h)}function c(u,h,f){if(f in s)return a(u,h);if(f in t)return a(void 0,u)}const m={url:n,method:n,data:n,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:c,headers:(u,h,f)=>o(Dr(u),Dr(h),f,!0)};return E.forEach(Object.keys({...t,...s}),function(h){const f=m[h]||o,b=f(t[h],s[h],h);E.isUndefined(b)&&f!==c||(r[h]=b)}),r}const Ma=t=>{const s=ot({},t);let{data:r,withXSRFToken:a,xsrfHeaderName:o,xsrfCookieName:n,headers:i,auth:c}=s;s.headers=i=Ce.from(i),s.url=Pa(Ra(s.baseURL,s.url,s.allowAbsoluteUrls),t.params,t.paramsSerializer),c&&i.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):"")));let m;if(E.isFormData(r)){if(ye.hasStandardBrowserEnv||ye.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((m=i.getContentType())!==!1){const[u,...h]=m?m.split(";").map(f=>f.trim()).filter(Boolean):[];i.setContentType([u||"multipart/form-data",...h].join("; "))}}if(ye.hasStandardBrowserEnv&&(a&&E.isFunction(a)&&(a=a(s)),a||a!==!1&&Tl(s.url))){const u=o&&n&&Pl.read(n);u&&i.set(o,u)}return s},Ol=typeof XMLHttpRequest<"u",Ll=Ol&&function(t){return new Promise(function(r,a){const o=Ma(t);let n=o.data;const i=Ce.from(o.headers).normalize();let{responseType:c,onUploadProgress:m,onDownloadProgress:u}=o,h,f,b,w,p;function S(){w&&w(),p&&p(),o.cancelToken&&o.cancelToken.unsubscribe(h),o.signal&&o.signal.removeEventListener("abort",h)}let N=new XMLHttpRequest;N.open(o.method.toUpperCase(),o.url,!0),N.timeout=o.timeout;function C(){if(!N)return;const j=Ce.from("getAllResponseHeaders"in N&&N.getAllResponseHeaders()),x={data:!c||c==="text"||c==="json"?N.responseText:N.response,status:N.status,statusText:N.statusText,headers:j,config:t,request:N};La(function(y){r(y),S()},function(y){a(y),S()},x),N=null}"onloadend"in N?N.onloadend=C:N.onreadystatechange=function(){!N||N.readyState!==4||N.status===0&&!(N.responseURL&&N.responseURL.indexOf("file:")===0)||setTimeout(C)},N.onabort=function(){N&&(a(new q("Request aborted",q.ECONNABORTED,t,N)),N=null)},N.onerror=function(){a(new q("Network Error",q.ERR_NETWORK,t,N)),N=null},N.ontimeout=function(){let v=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const x=o.transitional||Ea;o.timeoutErrorMessage&&(v=o.timeoutErrorMessage),a(new q(v,x.clarifyTimeoutError?q.ETIMEDOUT:q.ECONNABORTED,t,N)),N=null},n===void 0&&i.setContentType(null),"setRequestHeader"in N&&E.forEach(i.toJSON(),function(v,x){N.setRequestHeader(x,v)}),E.isUndefined(o.withCredentials)||(N.withCredentials=!!o.withCredentials),c&&c!=="json"&&(N.responseType=o.responseType),u&&([b,p]=ms(u,!0),N.addEventListener("progress",b)),m&&N.upload&&([f,w]=ms(m),N.upload.addEventListener("progress",f),N.upload.addEventListener("loadend",w)),(o.cancelToken||o.signal)&&(h=j=>{N&&(a(!j||j.type?new bt(null,t,N):j),N.abort(),N=null)},o.cancelToken&&o.cancelToken.subscribe(h),o.signal&&(o.signal.aborted?h():o.signal.addEventListener("abort",h)));const k=kl(o.url);if(k&&ye.protocols.indexOf(k)===-1){a(new q("Unsupported protocol "+k+":",q.ERR_BAD_REQUEST,t));return}N.send(n||null)})},Rl=(t,s)=>{const{length:r}=t=t?t.filter(Boolean):[];if(s||r){let a=new AbortController,o;const n=function(u){if(!o){o=!0,c();const h=u instanceof Error?u:this.reason;a.abort(h instanceof q?h:new bt(h instanceof Error?h.message:h))}};let i=s&&setTimeout(()=>{i=null,n(new q(`timeout ${s} of ms exceeded`,q.ETIMEDOUT))},s);const c=()=>{t&&(i&&clearTimeout(i),i=null,t.forEach(u=>{u.unsubscribe?u.unsubscribe(n):u.removeEventListener("abort",n)}),t=null)};t.forEach(u=>u.addEventListener("abort",n));const{signal:m}=a;return m.unsubscribe=()=>E.asap(c),m}},Ml=function*(t,s){let r=t.byteLength;if(r<s){yield t;return}let a=0,o;for(;a<r;)o=a+s,yield t.slice(a,o),a=o},Fl=async function*(t,s){for await(const r of Il(t))yield*Ml(r,s)},Il=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const s=t.getReader();try{for(;;){const{done:r,value:a}=await s.read();if(r)break;yield a}}finally{await s.cancel()}},Or=(t,s,r,a)=>{const o=Fl(t,s);let n=0,i,c=m=>{i||(i=!0,a&&a(m))};return new ReadableStream({async pull(m){try{const{done:u,value:h}=await o.next();if(u){c(),m.close();return}let f=h.byteLength;if(r){let b=n+=f;r(b)}m.enqueue(new Uint8Array(h))}catch(u){throw c(u),u}},cancel(m){return c(m),o.return()}},{highWaterMark:2})},ks=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Fa=ks&&typeof ReadableStream=="function",_l=ks&&(typeof TextEncoder=="function"?(t=>s=>t.encode(s))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),Ia=(t,...s)=>{try{return!!t(...s)}catch{return!1}},$l=Fa&&Ia(()=>{let t=!1;const s=new Request(ye.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!s}),Lr=64*1024,Qs=Fa&&Ia(()=>E.isReadableStream(new Response("").body)),hs={stream:Qs&&(t=>t.body)};ks&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(s=>{!hs[s]&&(hs[s]=E.isFunction(t[s])?r=>r[s]():(r,a)=>{throw new q(`Response type '${s}' is not supported`,q.ERR_NOT_SUPPORT,a)})})})(new Response);const Vl=async t=>{if(t==null)return 0;if(E.isBlob(t))return t.size;if(E.isSpecCompliantForm(t))return(await new Request(ye.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(E.isArrayBufferView(t)||E.isArrayBuffer(t))return t.byteLength;if(E.isURLSearchParams(t)&&(t=t+""),E.isString(t))return(await _l(t)).byteLength},Ul=async(t,s)=>{const r=E.toFiniteNumber(t.getContentLength());return r??Vl(s)},zl=ks&&(async t=>{let{url:s,method:r,data:a,signal:o,cancelToken:n,timeout:i,onDownloadProgress:c,onUploadProgress:m,responseType:u,headers:h,withCredentials:f="same-origin",fetchOptions:b}=Ma(t);u=u?(u+"").toLowerCase():"text";let w=Rl([o,n&&n.toAbortSignal()],i),p;const S=w&&w.unsubscribe&&(()=>{w.unsubscribe()});let N;try{if(m&&$l&&r!=="get"&&r!=="head"&&(N=await Ul(h,a))!==0){let x=new Request(s,{method:"POST",body:a,duplex:"half"}),T;if(E.isFormData(a)&&(T=x.headers.get("content-type"))&&h.setContentType(T),x.body){const[y,d]=Pr(N,ms(Er(m)));a=Or(x.body,Lr,y,d)}}E.isString(f)||(f=f?"include":"omit");const C="credentials"in Request.prototype;p=new Request(s,{...b,signal:w,method:r.toUpperCase(),headers:h.normalize().toJSON(),body:a,duplex:"half",credentials:C?f:void 0});let k=await fetch(p,b);const j=Qs&&(u==="stream"||u==="response");if(Qs&&(c||j&&S)){const x={};["status","statusText","headers"].forEach(g=>{x[g]=k[g]});const T=E.toFiniteNumber(k.headers.get("content-length")),[y,d]=c&&Pr(T,ms(Er(c),!0))||[];k=new Response(Or(k.body,Lr,y,()=>{d&&d(),S&&S()}),x)}u=u||"text";let v=await hs[E.findKey(hs,u)||"text"](k,t);return!j&&S&&S(),await new Promise((x,T)=>{La(x,T,{data:v,headers:Ce.from(k.headers),status:k.status,statusText:k.statusText,config:t,request:p})})}catch(C){throw S&&S(),C&&C.name==="TypeError"&&/Load failed|fetch/i.test(C.message)?Object.assign(new q("Network Error",q.ERR_NETWORK,t,p),{cause:C.cause||C}):q.from(C,C&&C.code,t,p)}}),Zs={http:rl,xhr:Ll,fetch:zl};E.forEach(Zs,(t,s)=>{if(t){try{Object.defineProperty(t,"name",{value:s})}catch{}Object.defineProperty(t,"adapterName",{value:s})}});const Rr=t=>`- ${t}`,Bl=t=>E.isFunction(t)||t===null||t===!1,_a={getAdapter:t=>{t=E.isArray(t)?t:[t];const{length:s}=t;let r,a;const o={};for(let n=0;n<s;n++){r=t[n];let i;if(a=r,!Bl(r)&&(a=Zs[(i=String(r)).toLowerCase()],a===void 0))throw new q(`Unknown adapter '${i}'`);if(a)break;o[i||"#"+n]=a}if(!a){const n=Object.entries(o).map(([c,m])=>`adapter ${c} `+(m===!1?"is not supported by the environment":"is not available in the build"));let i=s?n.length>1?`since :
`+n.map(Rr).join(`
`):" "+Rr(n[0]):"as no adapter specified";throw new q("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return a},adapters:Zs};function Rs(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new bt(null,t)}function Mr(t){return Rs(t),t.headers=Ce.from(t.headers),t.data=Ls.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),_a.getAdapter(t.adapter||zt.adapter)(t).then(function(a){return Rs(t),a.data=Ls.call(t,t.transformResponse,a),a.headers=Ce.from(a.headers),a},function(a){return Oa(a)||(Rs(t),a&&a.response&&(a.response.data=Ls.call(t,t.transformResponse,a.response),a.response.headers=Ce.from(a.response.headers))),Promise.reject(a)})}const $a="1.11.0",Cs={};["object","boolean","number","function","string","symbol"].forEach((t,s)=>{Cs[t]=function(a){return typeof a===t||"a"+(s<1?"n ":" ")+t}});const Fr={};Cs.transitional=function(s,r,a){function o(n,i){return"[Axios v"+$a+"] Transitional option '"+n+"'"+i+(a?". "+a:"")}return(n,i,c)=>{if(s===!1)throw new q(o(i," has been removed"+(r?" in "+r:"")),q.ERR_DEPRECATED);return r&&!Fr[i]&&(Fr[i]=!0,console.warn(o(i," has been deprecated since v"+r+" and will be removed in the near future"))),s?s(n,i,c):!0}};Cs.spelling=function(s){return(r,a)=>(console.warn(`${a} is likely a misspelling of ${s}`),!0)};function ql(t,s,r){if(typeof t!="object")throw new q("options must be an object",q.ERR_BAD_OPTION_VALUE);const a=Object.keys(t);let o=a.length;for(;o-- >0;){const n=a[o],i=s[n];if(i){const c=t[n],m=c===void 0||i(c,n,t);if(m!==!0)throw new q("option "+n+" must be "+m,q.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new q("Unknown option "+n,q.ERR_BAD_OPTION)}}const ls={assertOptions:ql,validators:Cs},Ve=ls.validators;let nt=class{constructor(s){this.defaults=s||{},this.interceptors={request:new Ar,response:new Ar}}async request(s,r){try{return await this._request(s,r)}catch(a){if(a instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const n=o.stack?o.stack.replace(/^.+\n/,""):"";try{a.stack?n&&!String(a.stack).endsWith(n.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+n):a.stack=n}catch{}}throw a}}_request(s,r){typeof s=="string"?(r=r||{},r.url=s):r=s||{},r=ot(this.defaults,r);const{transitional:a,paramsSerializer:o,headers:n}=r;a!==void 0&&ls.assertOptions(a,{silentJSONParsing:Ve.transitional(Ve.boolean),forcedJSONParsing:Ve.transitional(Ve.boolean),clarifyTimeoutError:Ve.transitional(Ve.boolean)},!1),o!=null&&(E.isFunction(o)?r.paramsSerializer={serialize:o}:ls.assertOptions(o,{encode:Ve.function,serialize:Ve.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),ls.assertOptions(r,{baseUrl:Ve.spelling("baseURL"),withXsrfToken:Ve.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let i=n&&E.merge(n.common,n[r.method]);n&&E.forEach(["delete","get","head","post","put","patch","common"],p=>{delete n[p]}),r.headers=Ce.concat(i,n);const c=[];let m=!0;this.interceptors.request.forEach(function(S){typeof S.runWhen=="function"&&S.runWhen(r)===!1||(m=m&&S.synchronous,c.unshift(S.fulfilled,S.rejected))});const u=[];this.interceptors.response.forEach(function(S){u.push(S.fulfilled,S.rejected)});let h,f=0,b;if(!m){const p=[Mr.bind(this),void 0];for(p.unshift(...c),p.push(...u),b=p.length,h=Promise.resolve(r);f<b;)h=h.then(p[f++],p[f++]);return h}b=c.length;let w=r;for(f=0;f<b;){const p=c[f++],S=c[f++];try{w=p(w)}catch(N){S.call(this,N);break}}try{h=Mr.call(this,w)}catch(p){return Promise.reject(p)}for(f=0,b=u.length;f<b;)h=h.then(u[f++],u[f++]);return h}getUri(s){s=ot(this.defaults,s);const r=Ra(s.baseURL,s.url,s.allowAbsoluteUrls);return Pa(r,s.params,s.paramsSerializer)}};E.forEach(["delete","get","head","options"],function(s){nt.prototype[s]=function(r,a){return this.request(ot(a||{},{method:s,url:r,data:(a||{}).data}))}});E.forEach(["post","put","patch"],function(s){function r(a){return function(n,i,c){return this.request(ot(c||{},{method:s,headers:a?{"Content-Type":"multipart/form-data"}:{},url:n,data:i}))}}nt.prototype[s]=r(),nt.prototype[s+"Form"]=r(!0)});let Hl=class Va{constructor(s){if(typeof s!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(n){r=n});const a=this;this.promise.then(o=>{if(!a._listeners)return;let n=a._listeners.length;for(;n-- >0;)a._listeners[n](o);a._listeners=null}),this.promise.then=o=>{let n;const i=new Promise(c=>{a.subscribe(c),n=c}).then(o);return i.cancel=function(){a.unsubscribe(n)},i},s(function(n,i,c){a.reason||(a.reason=new bt(n,i,c),r(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(s){if(this.reason){s(this.reason);return}this._listeners?this._listeners.push(s):this._listeners=[s]}unsubscribe(s){if(!this._listeners)return;const r=this._listeners.indexOf(s);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const s=new AbortController,r=a=>{s.abort(a)};return this.subscribe(r),s.signal.unsubscribe=()=>this.unsubscribe(r),s.signal}static source(){let s;return{token:new Va(function(o){s=o}),cancel:s}}};function Gl(t){return function(r){return t.apply(null,r)}}function Wl(t){return E.isObject(t)&&t.isAxiosError===!0}const er={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(er).forEach(([t,s])=>{er[s]=t});function Ua(t){const s=new nt(t),r=fa(nt.prototype.request,s);return E.extend(r,nt.prototype,s,{allOwnKeys:!0}),E.extend(r,s,null,{allOwnKeys:!0}),r.create=function(o){return Ua(ot(t,o))},r}const K=Ua(zt);K.Axios=nt;K.CanceledError=bt;K.CancelToken=Hl;K.isCancel=Oa;K.VERSION=$a;K.toFormData=Ss;K.AxiosError=q;K.Cancel=K.CanceledError;K.all=function(s){return Promise.all(s)};K.spread=Gl;K.isAxiosError=Wl;K.mergeConfig=ot;K.AxiosHeaders=Ce;K.formToJSON=t=>Da(E.isHTMLForm(t)?new FormData(t):t);K.getAdapter=_a.getAdapter;K.HttpStatusCode=er;K.default=K;const{Axios:zu,AxiosError:Bu,CanceledError:qu,isCancel:Hu,CancelToken:Gu,VERSION:Wu,all:Yu,Cancel:Xu,isAxiosError:Ju,spread:Ku,toFormData:Qu,AxiosHeaders:Zu,HttpStatusCode:em,formToJSON:tm,getAdapter:sm,mergeConfig:rm}=K;/*! js-cookie v3.0.5 | MIT */function Qt(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var a in r)t[a]=r[a]}return t}var Yl={read:function(t){return t[0]==='"'&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function tr(t,s){function r(o,n,i){if(!(typeof document>"u")){i=Qt({},s,i),typeof i.expires=="number"&&(i.expires=new Date(Date.now()+i.expires*864e5)),i.expires&&(i.expires=i.expires.toUTCString()),o=encodeURIComponent(o).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var c="";for(var m in i)i[m]&&(c+="; "+m,i[m]!==!0&&(c+="="+i[m].split(";")[0]));return document.cookie=o+"="+t.write(n,o)+c}}function a(o){if(!(typeof document>"u"||arguments.length&&!o)){for(var n=document.cookie?document.cookie.split("; "):[],i={},c=0;c<n.length;c++){var m=n[c].split("="),u=m.slice(1).join("=");try{var h=decodeURIComponent(m[0]);if(i[h]=t.read(u,h),o===h)break}catch{}}return o?i[o]:i}}return Object.create({set:r,get:a,remove:function(o,n){r(o,"",Qt({},n,{expires:-1}))},withAttributes:function(o){return tr(this.converter,Qt({},this.attributes,o))},withConverter:function(o){return tr(Qt({},this.converter,o),this.attributes)}},{attributes:{value:Object.freeze(s)},converter:{value:Object.freeze(t)}})}var re=tr(Yl,{path:"/"});const lt="pandaura_auth_token",ct="pandaura_auth_user",Zt="pandaura_auth_orgs",es="pandaura_auth_selected_org",St="pandaura_auth_login_time",dt={expires:30,secure:!1,sameSite:"lax",path:"/"};console.log(" AuthStorage: Cookie options configured:",dt);const xs=24,H={setToken:t=>{console.log(" AuthStorage: Setting token cookie"),re.set(lt,t,dt),re.set(St,Date.now().toString(),dt),console.log(" AuthStorage: Token cookie set, verifying...",!!re.get(lt))},getToken:()=>{const t=re.get(lt)||null;return console.log(" AuthStorage: Getting token cookie:",t?`${t.substring(0,10)}...`:"null"),t},removeToken:()=>{console.log(" AuthStorage: Removing token cookie"),re.remove(lt,{path:"/"}),re.remove(St,{path:"/"})},setUser:t=>{console.log(" AuthStorage: Setting user cookie",t.email),re.set(ct,JSON.stringify(t),dt),console.log(" AuthStorage: User cookie set, verifying...",!!re.get(ct))},getUser:()=>{const t=re.get(ct);if(!t)return console.log(" AuthStorage: No user cookie found"),null;try{const s=JSON.parse(t);return console.log(" AuthStorage: Getting user cookie:",s.email),s}catch(s){return console.error(" AuthStorage: Failed to parse user cookie:",s),null}},removeUser:()=>{console.log(" AuthStorage: Removing user cookie"),re.remove(ct,{path:"/"})},setOrganizations:t=>{console.log(" AuthStorage: Setting organizations cookie",t.length,"orgs"),re.set(Zt,JSON.stringify(t),dt)},getOrganizations:()=>{const t=re.get(Zt);if(!t)return console.log(" AuthStorage: No organizations cookie found"),[];try{const s=JSON.parse(t);return console.log(" AuthStorage: Getting organizations cookie:",s.length,"orgs"),s}catch(s){return console.error(" AuthStorage: Failed to parse organizations cookie:",s),[]}},removeOrganizations:()=>{console.log(" AuthStorage: Removing organizations cookie"),re.remove(Zt,{path:"/"})},setSelectedOrg:t=>{console.log(" AuthStorage: Setting selected org cookie",t.org_name),re.set(es,JSON.stringify(t),dt)},getSelectedOrg:()=>{const t=re.get(es);if(!t)return console.log(" AuthStorage: No selected org cookie found"),null;try{const s=JSON.parse(t);return console.log(" AuthStorage: Getting selected org cookie:",s.org_name),s}catch(s){return console.error(" AuthStorage: Failed to parse selected org cookie:",s),null}},removeSelectedOrg:()=>{console.log(" AuthStorage: Removing selected org cookie"),re.remove(es,{path:"/"})},clearAll:()=>{console.log(" AuthStorage: Clearing all auth cookies"),re.remove(lt,{path:"/"}),re.remove(ct,{path:"/"}),re.remove(Zt,{path:"/"}),re.remove(es,{path:"/"}),re.remove(St,{path:"/"}),console.log(" AuthStorage: All cookies cleared")},hasAuthData:()=>{const t=re.get(lt),s=re.get(ct),r=re.get(St);let a=!1;if(r){const n=parseInt(r,10);a=(Date.now()-n)/(1e3*60*60)>xs}const o=!!(t&&s)&&!a;return console.log(" AuthStorage: Checking auth data:",{hasToken:!!t,hasUser:!!s,expired:a,hasAuth:o}),o},isSessionExpired:()=>{const t=re.get(St);if(!t)return!0;const s=parseInt(t,10);return(Date.now()-s)/(1e3*60*60)>xs}},Xl=Object.freeze(Object.defineProperty({__proto__:null,SESSION_EXPIRY_HOURS:xs,authStorage:H},Symbol.toStringTag,{value:"Module"})),za=!1,Ba=!0;console.log(" Environment Detection:",{"import.meta.env.DEV":!1,"import.meta.env.PROD":!0,"import.meta.env.MODE":"production",VITE_DEPLOYMENT_MODE:"production",isDevelopment:za,isProduction:Ba});const Jl=()=>(console.log(" Using explicit API URL:","https://pandaura-backend-production.up.railway.app"),"https://pandaura-backend-production.up.railway.app"),it={apiBaseUrl:Jl(),deploymentMode:"production",appTitle:"Pandaura AS",features:{analytics:!0,externalFonts:!0,cdnAssets:!0},upload:{maxFileSize:parseInt("10485760"),endpoint:"/api/v1/upload",allowedTypes:["pdf","docx","txt","png","jpg","jpeg"]},auth:{type:"local",sessionTimeout:parseInt("28800000")},network:{timeout:3e4,retries:3},onPremise:{showStatus:!0,offlineMode:!0,localOnly:!0}},Kl=()=>{const t=window.location.hostname,s=window.location.port;return{hostname:t,port:s,isLocal:t==="localhost"||t==="127.0.0.1",displayUrl:s?`${t}:${s}`:t}},cr=()=>{console.log(" Environment Debug:",{isDevelopment:za,isProduction:Ba,"import.meta.env.DEV":!1,"import.meta.env.PROD":!0,"import.meta.env.MODE":"production",VITE_API_BASE_URL:"https://pandaura-backend-production.up.railway.app","Final API URL":it.apiBaseUrl})},qa=l.createContext(void 0),Ql=`${it.apiBaseUrl}/api/v1`;K.defaults.baseURL=Ql;const Zl=({children:t})=>{const[s,r]=l.useState(null),[a,o]=l.useState(null),[n,i]=l.useState([]),[c,m]=l.useState(null),[u,h]=l.useState(!0),[f,b]=l.useState(!1),[w,p]=l.useState(!1),S=!!a&&!!s&&!w,N=g=>{m(g),g?H.setSelectedOrg(g):H.removeSelectedOrg()};l.useEffect(()=>{console.log(" AuthContext: Authentication state changed:",{isAuthenticated:S,hasToken:!!a,hasUser:!!s,userEmail:s?.email,isLoading:u})},[S,a,s,u]),l.useEffect(()=>{console.log(" AuthContext: Token effect triggered, token:",a?`${a.substring(0,10)}...`:"null","isInitialized:",f),a?(K.defaults.headers.common.Authorization=`Bearer ${a}`,console.log(" AuthContext: Setting token to cookies..."),H.setToken(a)):f?(delete K.defaults.headers.common.Authorization,console.log(" AuthContext: Removing token from cookies (post-initialization)..."),H.removeToken()):(delete K.defaults.headers.common.Authorization,console.log(" AuthContext: Removing auth header only (during initialization)..."))},[a,f]),l.useEffect(()=>{let g=!0;console.log(" AuthContext: Starting initialization...");const A=H.getToken(),O=H.getUser(),D=H.getOrganizations(),L=H.getSelectedOrg();if(console.log(" AuthContext: Raw cookie data:",{storedToken:A,storedUser:O,storedOrgs:D,storedSelectedOrg:L}),console.log(" AuthContext: Stored data analysis:",{hasToken:!!A,hasUser:!!O,hasOrgs:D&&D.length>0,hasSelectedOrg:!!L,tokenPrefix:A?`${A.substring(0,10)}...`:"none",userEmail:O?.email||"none"}),A&&O)if(H.isSessionExpired())p(!0),k();else try{g&&(r(O),o(A),D&&D.length>0&&i(D),L&&m(L))}catch{g&&H.clearAll()}return g&&(console.log(" AuthContext: Setting loading to false and marking as initialized"),h(!1),b(!0)),()=>{console.log(" AuthContext: Cleanup called"),g=!1}},[]);const C=async(g,A,O)=>{try{const D=await K.post("/auth/login",{email:g,password:A,twoFactorToken:O});if(D.data.requiresTwoFactor)return{requiresTwoFactor:!0,success:!1,message:D.data.message};const{token:L,userId:U,fullName:M,email:R,twoFactorEnabled:z,orgId:J,role:te,orgName:ue,organizations:I}=D.data;o(L);const Y={userId:U,fullName:M||"",email:R||g,twoFactorEnabled:z||!1};r(Y),H.setUser(Y);const W=I.map(xe=>({org_id:xe.org_id,org_name:xe.org_name,role:xe.role,industry:xe.industry,size:xe.size}));i(W),H.setOrganizations(W);const oe=W.find(xe=>xe.org_id===J)||W[0];return m(oe),H.setSelectedOrg(oe),{success:!0,message:"Login successful"}}catch(D){return console.error("Login error:",D),{success:!1,message:D.response?.data?.error||"Login failed"}}},k=()=>{console.log(" AuthContext: Logging out user"),o(null),r(null),i([]),m(null),H.clearAll(),console.log(" AuthContext: Logout complete, cookies cleared")},j=async g=>{try{const A=await K.post("/auth/orgs",g),{token:O,userId:D,orgId:L,role:U}=A.data;o(O);const M={userId:D,fullName:g.fullName,email:g.email,twoFactorEnabled:!1};r(M);const R={org_id:L,org_name:g.orgName,role:U,industry:g.industry,size:g.size};return i([R]),m(R),H.setUser(M),H.setOrganizations([R]),H.setSelectedOrg(R),{success:!0,message:"Organization created successfully"}}catch(A){return console.error("Create organization error:",A),{success:!1,message:A.response?.data?.error||"Failed to create organization"}}},v=async g=>{try{const A=await K.get(`/auth/invites/validate?code=${g}`);return{valid:A.data.valid,orgName:A.data.orgName,role:A.data.role,email:A.data.email}}catch(A){return console.error("Validate invite error:",A),{valid:!1,message:A.response?.data?.error||"Invalid invite code"}}},x=async g=>{try{const A=await K.post("/auth/invites/accept",g),{token:O,userId:D,orgId:L,role:U}=A.data;o(O);const M={userId:D,fullName:g.fullName,email:g.email,twoFactorEnabled:!1};r(M);const z=(await K.get(`/auth/users/${D}/orgs`,{headers:{Authorization:`Bearer ${O}`}})).data.map(te=>({org_id:te.org_id,org_name:te.org_name,role:te.role,industry:te.industry,size:te.size}));i(z);const J=z.find(te=>te.org_id===L)||z[0];return m(J),H.setUser(M),H.setOrganizations(z),H.setSelectedOrg(J),{success:!0,message:"Successfully joined organization"}}catch(A){return console.error("Accept invite error:",A),{success:!1,message:A.response?.data?.error||"Failed to accept invite"}}},T=async()=>{try{const g=a||H.getToken();if(!g)throw new Error("No authentication token available");const A=await K.post("/auth/setup-2fa",{},{headers:{Authorization:`Bearer ${g}`}});return{secret:A.data.secret,qrCodeUrl:A.data.qrCode||A.data.otpauth_url}}catch(g){throw console.error("Setup 2FA error:",g),new Error(g.response?.data?.error||"Failed to setup 2FA")}},y=async g=>{try{return await K.post("/auth/verify-2fa",{token:g}),s&&r({...s,twoFactorEnabled:!0}),{success:!0,message:"2FA enabled successfully"}}catch(A){return{success:!1,message:A.response?.data?.error||"2FA verification failed"}}},d=async(g,A)=>{try{return await K.post("/auth/device-bind",{instanceId:g,deviceFingerprintHash:A}),{success:!0,message:"Device bound successfully"}}catch(O){return{success:!1,message:O.response?.data?.error||"Device binding failed"}}};return w?e.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-surface",children:e.jsxs("div",{className:"bg-white border border-error/30 rounded-lg shadow-lg p-8 max-w-md text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-error mb-4",children:"Session Expired"}),e.jsxs("p",{className:"text-muted mb-6",children:["For security purposes, you must log in once every ",xs," hours."]}),e.jsx("a",{href:"/signin",className:"inline-block px-6 py-2 bg-primary text-white rounded hover:bg-secondary transition-colors font-semibold",children:"Go to Login"})]})}):e.jsx(qa.Provider,{value:{user:s,token:a,organizations:n,selectedOrg:c,isAuthenticated:S,isLoading:u,setSelectedOrg:N,login:C,logout:k,createOrganization:j,validateInvite:v,acceptInvite:x,setupTwoFactor:T,verifyTwoFactor:y,bindDevice:d},children:t})},Le=()=>{const t=l.useContext(qa);if(!t)throw new Error("useAuth must be used within AuthProvider");return t};function ut(){const[t,s]=l.useState(null),r=he(),a=Rt(),o=l.useRef(null),{logout:n}=Le(),i=c=>{s(m=>m===c?null:c)};return l.useEffect(()=>{const c=m=>{o.current&&!o.current.contains(m.target)&&s(null)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[]),e.jsxs("div",{ref:o,className:"flex space-x-4 items-center relative",children:[e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>i("integrations"),title:"Integrations",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Ho,{className:"w-5 h-5"})}),t==="integrations"&&e.jsxs("div",{className:"absolute right-0 mt-2 w-72 bg-white rounded shadow-lg p-4 text-sm z-50",children:[e.jsx("div",{className:"font-semibold mb-3 text-primary",children:"Productivity Tools"}),e.jsxs("ul",{className:"space-y-3",children:[e.jsxs("li",{onClick:()=>{console.log("Connecting to Google Drive API..."),alert("Google Drive integration would be configured here"),s(null)},className:"flex items-center gap-3 p-2 rounded-md hover:bg-gray-100 cursor-pointer transition-colors",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"G"})}),e.jsx("span",{children:"Google Drive API"})]}),e.jsxs("li",{onClick:()=>{console.log("Connecting to Google Docs API..."),alert("Google Docs integration would be configured here"),s(null)},className:"flex items-center gap-3 p-2 rounded-md hover:bg-gray-100 cursor-pointer transition-colors",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-600 rounded flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs",children:""})}),e.jsx("span",{children:"Google Docs API"})]}),e.jsxs("li",{onClick:()=>{console.log("Connecting to Dropbox API..."),alert("Dropbox integration would be configured here"),s(null)},className:"flex items-center gap-3 p-2 rounded-md hover:bg-gray-100 cursor-pointer transition-colors",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-700 rounded flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs",children:""})}),e.jsx("span",{children:"Dropbox API"})]}),e.jsxs("li",{onClick:()=>{console.log("Connecting to Excel API..."),alert("Excel API integration would be configured here"),s(null)},className:"flex items-center gap-3 p-2 rounded-md hover:bg-gray-100 cursor-pointer transition-colors",children:[e.jsx("div",{className:"w-6 h-6 bg-green-600 rounded flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs",children:""})}),e.jsx("span",{children:"Excel API"})]})]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>i("profile"),title:"User Profile",className:"p-2 rounded-full border hover:bg-gray-200",children:e.jsx(ha,{className:"w-5 h-5"})}),t==="profile"&&e.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded shadow-lg py-2 text-sm z-50",children:e.jsxs("ul",{className:"text-gray-800",children:[e.jsx("li",{onClick:()=>{console.log("Navigating to profile..."),r("/profile",{state:{from:a.pathname}}),s(null)},className:"px-4 py-2 hover:bg-gray-100 cursor-pointer",children:" Profile"}),e.jsx("li",{onClick:()=>{console.log("Navigating to feedback..."),r("/feedback"),s(null)},className:"px-4 py-2 hover:bg-gray-100 cursor-pointer",children:" Feedback"}),e.jsx("li",{onClick:()=>{console.log("Navigating to privacy..."),r("/privacy"),s(null)},className:"px-4 py-2 hover:bg-gray-100 cursor-pointer",children:" Privacy"}),e.jsx("li",{onClick:()=>{console.log("Navigating to case study library..."),r("/case-study-library"),s(null)},className:"px-4 py-2 hover:bg-gray-100 cursor-pointer",children:" Case Studies"}),e.jsxs("li",{onClick:()=>{n(),r("/signin"),s(null)},className:"px-4 py-2 hover:bg-gray-100 cursor-pointer flex items-center gap-2",children:[e.jsx(Ys,{className:"w-4 h-4"}),"Log Out"]})]})})]})]})}function Ha(){const[t,s]=l.useState(!1),[r,a]=l.useState(!1),[o,n]=l.useState(""),[i,c]=l.useState([{id:"1",text:"Pandaura AS (Mini) is your smart co-engineer. It adapts to whatever page you're on and helps with tips, training, logic guidance, and more  always context-aware, always available.",sender:"pandaura",timestamp:new Date().toLocaleTimeString()}]),m=l.useRef(null),u=l.useRef(null),h=()=>{u.current?.scrollIntoView({behavior:"smooth"})};l.useEffect(()=>{h()},[i]),l.useEffect(()=>{const w=p=>{if(m.current&&!m.current.contains(p.target)){const S=document.querySelector("[data-pandaura-orb]");S&&!S.contains(p.target)&&s(!1)}};return t&&document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[t]);const f=()=>{if(!o.trim())return;const w={id:Date.now().toString(),text:o,sender:"user",timestamp:new Date().toLocaleTimeString()};c(p=>[...p,w]),n(""),setTimeout(()=>{const p=["I understand you're working on that. Let me help you with the PLC logic structure. Would you like me to explain the safety interlocks?","That's a great question about motor control. In industrial automation, we typically use three-wire control circuits for safety. Let me walk you through it.","For tag management, I recommend organizing your variables by function: Inputs (I_), Outputs (O_), and Memory (M_). This follows industry best practices.","I can help you generate the structured text code for that. Which PLC vendor are you targeting - Rockwell, Siemens, or Beckhoff?","Let me analyze your logic. Based on what you've described, you'll need to consider emergency stop circuits, guard door interlocks, and overload protection."],S=p[Math.floor(Math.random()*p.length)],N={id:(Date.now()+1).toString(),text:S,sender:"pandaura",timestamp:new Date().toLocaleTimeString()};c(C=>[...C,N])},1e3)},b=w=>{w.key==="Enter"&&!w.shiftKey&&(w.preventDefault(),f())};return e.jsxs(e.Fragment,{children:[e.jsx("button",{"data-pandaura-orb":!0,onClick:()=>s(!t),className:"fixed bottom-6 right-6 w-14 h-14 bg-primary rounded-full flex items-center justify-center shadow-lg hover:scale-105 transition-transform z-50",title:"Ask Pandaura AS (Mini)",children:e.jsx(vr,{className:"w-6 h-6 text-white"})}),t&&e.jsxs("div",{ref:m,className:`fixed bottom-24 right-6 bg-white border border-light rounded-lg shadow-xl z-50 transition-all duration-300 ${r?"w-80 h-16":"w-80 h-96"}`,children:[e.jsxs("div",{className:"bg-primary text-white p-3 rounded-t-lg flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(vr,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Pandaura AS (Mini)"}),e.jsx("span",{className:"text-xs bg-green-500 px-1 rounded",children:"Online"})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>a(!r),className:"hover:bg-white hover:bg-opacity-20 p-1 rounded",children:r?e.jsx(Ro,{className:"w-3 h-3"}):e.jsx(Vo,{className:"w-3 h-3"})}),e.jsx("button",{onClick:()=>s(!1),className:"hover:bg-white hover:bg-opacity-20 p-1 rounded",children:e.jsx(Ie,{className:"w-3 h-3"})})]})]}),!r&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"h-64 overflow-y-auto p-3 space-y-3",children:[i.map(w=>e.jsx("div",{className:`flex ${w.sender==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[80%] rounded-lg p-2 text-sm ${w.sender==="user"?"bg-primary text-white":"bg-gray-100 text-primary"}`,children:[e.jsx("div",{children:w.text}),e.jsx("div",{className:`text-xs mt-1 ${w.sender==="user"?"text-blue-200":"text-gray-500"}`,children:w.timestamp})]})},w.id)),e.jsx("div",{ref:u})]}),e.jsx("div",{className:"border-t border-light p-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("textarea",{value:o,onChange:w=>n(w.target.value),onKeyPress:b,placeholder:"Ask about PLCs, automation, tags...",className:"flex-1 border border-light rounded px-3 py-2 text-sm resize-none focus:outline-none focus:ring-2 focus:ring-accent",rows:1}),e.jsx("button",{onClick:f,disabled:!o.trim(),className:"bg-primary text-white p-2 rounded hover:bg-secondary transition-colors disabled:opacity-50",children:e.jsx(ys,{className:"w-4 h-4"})})]})})]})]})]})}const Ga=l.createContext(void 0),dr=()=>{const t=l.useContext(Ga);if(!t)throw new Error("useModuleState must be used within a ModuleStateProvider");return t},ec=({children:t})=>{const[s,r]=l.useState({}),a=l.useCallback(m=>s[m]||{},[s]),o=l.useCallback((m,u)=>{r(h=>{const f=h[m]||{},b={...f,...u};return JSON.stringify(f)===JSON.stringify(b)?h:{...h,[m]:b}})},[]),n=l.useCallback(m=>{r(u=>{if(!u[m])return u;const h={...u};return delete h[m],h})},[]),i=l.useCallback((m,u)=>{const h=setTimeout(()=>{try{const f=JSON.parse(localStorage.getItem("pandaura_module_states")||"{}");f[m]=u,localStorage.setItem("pandaura_module_states",JSON.stringify(f))}catch(f){console.warn("Failed to save module state to localStorage:",f)}},100);return o(m,u),()=>clearTimeout(h)},[o]);we.useEffect(()=>{try{const m=JSON.parse(localStorage.getItem("pandaura_module_states")||"{}");r(m)}catch(m){console.warn("Failed to load module states from localStorage:",m)}},[]);const c=l.useMemo(()=>({getModuleState:a,setModuleState:o,clearModuleState:n,saveModuleState:i}),[a,o,n,i]);return e.jsx(Ga.Provider,{value:c,children:t})};function tc({hasUnsavedChanges:t,onSave:s,message:r="You have unsaved changes. Do you want to save before leaving?"}){const a=he();return Rt(),l.useEffect(()=>{const n=i=>{if(t){if(s&&"sendBeacon"in navigator)try{const c=JSON.stringify({emergency_save:!0,timestamp:Date.now()});navigator.sendBeacon("/api/v1/emergency-save",c),console.log("Attempting beacon save before unload")}catch(c){console.warn("Beacon save failed:",c)}return i.preventDefault(),i.returnValue="",r}};return window.addEventListener("beforeunload",n),()=>window.removeEventListener("beforeunload",n)},[t,r,s]),{handleNavigation:l.useCallback(async n=>{if(!t){a(n);return}const i=window.confirm(r);if(i&&s)try{await s()?a(n):console.error("Save failed, navigation cancelled")}catch(c){console.error("Save error during navigation:",c)}else i||a(n)},[t,r,s,a]),hasUnsavedChanges:t}}function Wa(t,s){return tc({hasUnsavedChanges:t,onSave:s,message:"You have unsaved project changes. Save before leaving?"})}const ts=[{name:"Logic Studio",path:"/logic-studio",icon:la},{name:"Tag Database Manager",path:"/tag-database",icon:at},{name:"AutoDocs",path:"/autodocs",icon:Me},{name:"Pandaura AS",path:"/pandaura-as",icon:ar}],sc={"Pandaura AS":["Your AI co-engineer for automation, electrical, robotics, and everything in between."],"Logic Studio":["Turn natural language into fully structured PLC code  instantly and vendor-ready."],AutoDocs:["Auto-generate PLC docs for end-user deliveryspecs, IO lists, logic summaries, and more"],"Tag Database Manager":["Organize, edit, and maintain all your PLC tags in one centralized system."],Projects:["Manage and organize your automation projects, files, and collaborative workspaces."]};function Re({children:t}){const[s,r]=l.useState(!0),[a,o]=l.useState(!1),n=he(),i=Rt(),{projectId:c}=Mt(),{saveModuleState:m}=dr(),u=i.pathname.startsWith("/workspace/"),[h,f]=l.useState(!1),b=l.useCallback(async()=>{try{return console.log("Performing fallback save before navigation"),!0}catch(y){return console.error("Failed to save before navigation:",y),!1}},[]),{handleNavigation:w}=Wa(h&&u,b);l.useEffect(()=>{const y=d=>{f(d.detail.hasChanges)};return window.addEventListener("pandaura:unsaved-changes",y),()=>{window.removeEventListener("pandaura:unsaved-changes",y)}},[]);const p=l.useMemo(()=>{if(u&&c){const y=ts.map(d=>({...d,path:`/workspace/${c}${d.path}`}));return console.log(" SharedLayout: Using project-specific tool paths:",{projectId:c,originalPaths:ts.map(d=>d.path),projectPaths:y.map(d=>d.path)}),y}return console.log(" SharedLayout: Using standard tool paths"),ts},[u,c]),S=()=>{const y=i.pathname,d=p.find(A=>A.path===y);return d?d.name:ts.find(A=>y.includes(A.path.substring(1)))?.name||"Pandaura AS"},N=l.useCallback(y=>{console.log(" SharedLayout: Navigating to tool:",{toolPath:y,currentPath:i.pathname,projectId:c,isProjectWorkspace:u}),u&&h?w(y):n(y)},[n,i.pathname,c,u,h,w]),C=l.useCallback(()=>{u&&h?w("/home"):o(!0)},[u,h,w]),k=l.useCallback(async()=>{const y=S();console.log(`Auto-saving ${y} progress...`),await b()&&(o(!1),n("/home"))},[n,b]),j=l.useCallback(()=>{o(!1),n("/home")},[n]),v=()=>{const y=Kl();return e.jsxs("header",{className:"flex items-center justify-between bg-surface px-6 py-4 border-b border-light shadow",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:C,className:"hover:opacity-80 transition-opacity",title:"Go to Home",children:e.jsx("img",{src:je,alt:"Pandaura Logo",className:"h-16 w-auto filter-none",style:{filter:"none",imageRendering:"crisp-edges"}})}),e.jsxs("div",{className:"flex flex-col text-xs",children:[e.jsx("span",{className:"text-primary font-medium",children:it.appTitle}),e.jsxs("span",{className:"text-muted",children:["Running on ",y.displayUrl," (Offline Mode)"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"bg-yellow-100 border border-yellow-200 text-yellow-800 px-2 py-1 rounded text-xs",children:"Offline Mode"}),e.jsx(ut,{})]})]})},x=l.useMemo(()=>e.jsxs("div",{className:`h-full overflow-y-auto scrollbar-hide bg-gray-light border-r border-light shadow-card p-2 space-y-4 transition-all duration-200 will-change-transform ${s?"w-72":"w-16"}`,style:{scrollBehavior:"smooth"},children:[e.jsx("button",{className:"text-secondary mb-2 focus:outline-none hover:text-primary transition-colors",onClick:()=>r(!s),"aria-label":"Toggle sidebar",title:"Toggle sidebar",children:e.jsx(Fo,{className:"w-8 h-8"})}),p.map(y=>{const d=y.icon,g=S()===y.name;return e.jsxs("div",{children:[e.jsxs("div",{onClick:()=>N(y.path),className:`flex items-center ${s?"":"justify-center"} cursor-pointer py-3 rounded-md transition-colors duration-150 ${g?" text-primary shadow-sm":"hover:bg-gray hover:text-primary hover:shadow-sm"}`,children:[e.jsx(d,{className:"w-6 h-6 min-w-[1.5rem] min-h-[1.5rem]"}),s&&e.jsx("span",{className:"text-sm font-medium ml-2",children:y.name})]}),s&&e.jsx("div",{className:"ml-7 mt-1 space-y-1 text-xs text-muted",children:sc[y.name]?.map((A,O)=>e.jsxs("div",{className:"flex items-start gap-1",children:[e.jsx("span",{className:"text-disabled",children:""}),e.jsx("span",{children:A})]},O))})]},y.name)})]}),[s,i.pathname,N]),T=()=>a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-96 p-6 shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-primary",children:"Save Current Progress?"}),e.jsx("button",{onClick:()=>o(!1),className:"text-secondary hover:text-primary",children:e.jsx(Ie,{className:"w-5 h-5"})})]}),e.jsx("p",{className:"text-sm text-secondary mb-6",children:"Do you want to save your current progress before returning to the Home screen?"}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{onClick:j,className:"px-4 py-2 border border-light rounded-md text-sm hover:bg-gray-100 transition-colors",children:"Don't Save"}),e.jsx("button",{onClick:k,className:"px-4 py-2 bg-primary text-white rounded-md text-sm hover:bg-secondary transition-colors",children:"Save & Go Home"})]})]})});return e.jsxs("div",{className:"flex flex-col h-screen bg-background text-primary",children:[v(),e.jsxs("div",{className:"flex flex-1 overflow-hidden min-w-0",children:[x,e.jsx("div",{className:"flex-1 overflow-y-auto will-change-scroll",style:{scrollBehavior:"smooth"},children:t})]}),e.jsx(Ha,{}),T()]})}function rc(){return e.jsxs("div",{className:"max-w-2xl mx-auto py-18 px-6",children:[e.jsx("div",{className:"z-10 mb-2 flex flex-col items-center",children:e.jsx("img",{src:je,alt:"Pandaura AS Logo",className:"h-24 w-auto filter-none",style:{filter:"none",imageRendering:"crisp-edges"}})}),e.jsx("h1",{className:"text-3xl font-bold mb-6 text-primary",children:"End User License Agreement (EULA)"}),e.jsxs("div",{className:"space-y-6 text-base text-gray-800",children:[e.jsx("p",{children:'This End User License Agreement ("Agreement") is a legal agreement between you ("User") and Pandaura AS ("Company") for the use of the Pandaura AS software and services ("Software").'}),e.jsx("h2",{className:"text-xl font-semibold mt-8 mb-2",children:"1. License Grant"}),e.jsx("p",{children:"The Company grants you a non-exclusive, non-transferable, limited license to use the Software in accordance with the terms of this Agreement."}),e.jsx("h2",{className:"text-xl font-semibold mt-8 mb-2",children:"2. Restrictions"}),e.jsxs("ul",{className:"list-disc ml-6",children:[e.jsx("li",{children:"You may not copy, modify, distribute, sell, or lease any part of the Software."}),e.jsx("li",{children:"You may not reverse engineer or attempt to extract the source code of the Software."})]}),e.jsx("h2",{className:"text-xl font-semibold mt-8 mb-2",children:"3. Termination"}),e.jsx("p",{children:"The Company may terminate your license if you fail to comply with any term of this Agreement. Upon termination, you must cease all use of the Software."}),e.jsx("h2",{className:"text-xl font-semibold mt-8 mb-2",children:"4. Limitation of Liability"}),e.jsx("p",{children:'The Software is provided "as is" without warranty of any kind. The Company shall not be liable for any damages arising from the use or inability to use the Software.'}),e.jsx("h2",{className:"text-xl font-semibold mt-8 mb-2",children:"5. Governing Law"}),e.jsx("p",{children:"This Agreement shall be governed by the laws of Norway, without regard to its conflict of law principles."}),e.jsx("h2",{className:"text-xl font-semibold mt-8 mb-2",children:"6. Contact"}),e.jsx("p",{children:"For any questions regarding this Agreement, please contact Pandaura AS at support@pandaura.com."})]})]})}function kt({children:t}){const s=he();return e.jsxs("div",{className:"flex flex-col h-screen bg-background text-primary",children:[e.jsxs("header",{className:"flex items-center justify-between bg-surface px-6 py-4 border-b border-light shadow",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>s(-1),className:"p-2 hover:bg-background rounded-md transition-colors",title:"Back to Home",children:e.jsx(Oe,{className:"w-5 h-5 text-secondary"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:je,alt:"Pandaura Logo",className:"h-12 w-auto filter-none",style:{filter:"none",imageRendering:"crisp-edges"}}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full",children:"Quick Session"}),e.jsx("span",{className:"text-xs text-muted",children:"One-time use"})]})})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-yellow-50 border border-yellow-200 rounded-md",children:[e.jsx(It,{className:"w-4 h-4 text-yellow-600"}),e.jsx("span",{className:"text-xs text-yellow-800",children:"Session data will not be saved"})]}),e.jsxs("button",{onClick:()=>s("/home"),className:"flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-md hover:bg-secondary transition-colors text-sm",children:[e.jsx(jo,{className:"w-4 h-4"}),"Home"]})]})]}),e.jsx("div",{className:"bg-accent/5 border-b border-accent/20 px-6 py-3",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs("p",{className:"text-sm text-accent-dark",children:[e.jsx("strong",{children:"Quick Session Mode:"})," You can upload files, use all features, and export results  but your session will not be saved. For persistent projects,",e.jsx("button",{onClick:()=>s("/app"),className:"underline hover:text-primary transition-colors ml-1",children:"start a full project workflow"}),"."]})})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:t})]})}function ge({children:t,redirectTo:s="/signin"}){const{isAuthenticated:r,isLoading:a,user:o,token:n}=Le(),i=he(),[c,m]=we.useState(!1);return l.useEffect(()=>{console.log(" ProtectedRoute: Auth check started",{isLoading:a,isAuthenticated:r,hasToken:!!n,hasUser:!!o,userEmail:o?.email,redirectTo:s,currentPath:window.location.pathname,cookies_token:!!H.getToken(),cookies_user:!!H.getUser(),hasInitialized:c,timestamp:new Date().toISOString()});const u=H.getToken(),h=H.getUser();if(console.log(" ProtectedRoute: Direct cookie check:",{cookieToken:u?`${u.substring(0,10)}...`:null,cookieUser:h?h.email:null,cookieHasAuthData:H.hasAuthData()}),!a&&!c&&(console.log(" ProtectedRoute: Setting initialization complete"),m(!0)),!a&&c&&!r){console.log(" ProtectedRoute: Not authenticated after initialization, starting redirect timer");const f=setTimeout(()=>{const b=H.hasAuthData(),w={token:H.getToken(),user:H.getUser(),hasAuthData:b};console.log(" ProtectedRoute: Final check before redirect:",{isAuthenticated:r,hasStoredAuth:b,finalCookieCheck:w,contextState:{hasToken:!!n,hasUser:!!o}}),!r&&!b?(console.log(" ProtectedRoute: Redirecting to signin - final auth check failed",{reason:n?o?"Unknown":"No user":"No token",hasCookieToken:!!H.getToken(),hasCookieUser:!!H.getUser(),redirectingTo:s}),i(s,{replace:!0})):!r&&b&&(console.log(" ProtectedRoute: Cookies have auth data but context does not - potential race condition"),setTimeout(()=>{r||(console.log(" ProtectedRoute: Context still not updated, forcing redirect"),i(s,{replace:!0}))},500))},300);return()=>clearTimeout(f)}},[a,r,i,s,n,o,c]),a||!c?e.jsx("div",{className:"flex-1 flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-primary border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-muted",children:a?"Loading authentication...":"Initializing..."})]})}):r?e.jsx(e.Fragment,{children:t}):null}const ac={primary:"bg-primary hover:bg-secondary text-white",secondary:"bg-secondary hover:bg-primary text-white",outline:"border border-light bg-white hover:bg-accent-light text-primary hover:border-accent",ghost:"hover:bg-accent-light text-primary",danger:"bg-red-600 hover:bg-red-700 text-white",success:"bg-green-600 hover:bg-green-700 text-white"},nc={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"};function F({children:t,onClick:s,type:r="button",variant:a="primary",size:o="md",disabled:n=!1,loading:i=!1,icon:c,iconPosition:m="left",className:u="",title:h}){const b=`inline-flex items-center justify-center rounded-md font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-accent focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed ${ac[a]} ${nc[o]} ${u}`;return e.jsxs("button",{type:r,onClick:s,disabled:n||i,className:b,title:h,children:[i&&e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),c&&m==="left"&&!i&&e.jsx(c,{className:`w-4 h-4 ${t?"mr-2":""}`}),t,c&&m==="right"&&!i&&e.jsx(c,{className:`w-4 h-4 ${t?"ml-2":""}`})]})}function ve({id:t,name:s,type:r="text",value:a,onChange:o,placeholder:n,label:i,required:c=!1,disabled:m=!1,autoFocus:u=!1,autoComplete:h,maxLength:f,pattern:b,icon:w,onBlur:p,iconPosition:S="right",onIconClick:N,error:C,helpText:k,className:j=""}){const v=t||s,A=`w-full px-4 py-3 bg-surface text-primary border rounded-md shadow-sm outline-none transition-all focus:ring-2 focus:ring-accent focus:border-accent ${!!C?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-light"} ${m?"opacity-50 cursor-not-allowed":""} ${w?S==="left"?"pl-12":"pr-12":""} ${j}`;return e.jsxs("div",{className:"w-full",children:[i&&e.jsxs("label",{htmlFor:v,className:"block text-sm font-medium text-secondary mb-2",children:[i,c&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsxs("div",{className:"relative",children:[w&&S==="left"&&e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:e.jsx(w,{className:"w-5 h-5 text-muted"})}),e.jsx("input",{id:v,name:s,type:r,value:a,onChange:o,onBlur:p,placeholder:n,required:c,disabled:m,autoFocus:u,autoComplete:h,maxLength:f,pattern:b,className:A}),w&&S==="right"&&e.jsx("button",{type:"button",onClick:N,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted hover:text-primary transition-colors",disabled:m,children:e.jsx(w,{className:"w-5 h-5"})})]}),C&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:C}),k&&!C&&e.jsx("p",{className:"mt-1 text-sm text-muted",children:k})]})}function Et({id:t,name:s,value:r,onChange:a,placeholder:o,label:n,required:i=!1,disabled:c=!1,autoFocus:m=!1,rows:u=4,maxLength:h,error:f,helpText:b,className:w="",showCharCount:p=!1}){const S=t||s,x=`w-full px-4 py-3 bg-background border rounded-md text-primary placeholder-muted resize-none outline-none transition-all focus:ring-2 focus:ring-accent focus:border-accent ${!!f?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-light"} ${c?"opacity-50 cursor-not-allowed":""} ${w}`;return e.jsxs("div",{className:"w-full",children:[n&&e.jsxs("label",{htmlFor:S,className:"block text-sm font-medium text-secondary mb-2",children:[n,i&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx("textarea",{id:S,name:s,value:r,onChange:a,placeholder:o,required:i,disabled:c,autoFocus:m,rows:u,maxLength:h,className:x}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("div",{children:[f&&e.jsx("p",{className:"text-sm text-red-600",children:f}),b&&!f&&e.jsx("p",{className:"text-sm text-muted",children:b})]}),(p||h)&&e.jsxs("span",{className:"text-xs text-muted",children:[r.length,h&&`/${h}`]})]})]})}const oc={sm:"p-4",md:"p-6",lg:"p-8"},ic={default:"bg-surface border border-light",elevated:"bg-surface border border-light shadow-card",bordered:"bg-background border-2 border-light"};function Ee({children:t,title:s,subtitle:r,icon:a,className:o="",padding:n="md",variant:i="default"}){const m=`rounded-lg ${ic[i]} ${oc[n]} ${o}`;return e.jsxs("div",{className:m,children:[(s||r||a)&&e.jsxs("div",{className:"mb-6",children:[a&&e.jsx("div",{className:"w-12 h-12 bg-accent/10 rounded-full flex items-center justify-center mb-4",children:e.jsx(a,{className:"w-6 h-6 text-accent"})}),s&&e.jsx("h3",{className:"text-lg font-semibold text-primary mb-2",children:s}),r&&e.jsx("p",{className:"text-sm text-muted",children:r})]}),t]})}function Ue({options:t,value:s,onChange:r,placeholder:a="Select an option",label:o,disabled:n=!1,error:i,className:c="",required:m=!1}){const[u,h]=l.useState(!1),f=l.useRef(null),b=t.find(N=>N.value===s);l.useEffect(()=>{const N=C=>{f.current&&!f.current.contains(C.target)&&h(!1)};return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[]);const w=N=>{r(N),h(!1)},S=`w-full flex items-center justify-between px-4 py-3 bg-surface text-primary border rounded-md shadow-sm outline-none transition-all ${!!i?"border-red-500":"border-light"} ${n?"opacity-50 cursor-not-allowed":"hover:border-accent focus:ring-2 focus:ring-accent focus:border-accent cursor-pointer"} ${c}`;return e.jsxs("div",{className:"w-full",children:[o&&e.jsxs("label",{className:"block text-sm font-medium text-secondary mb-2",children:[o," ",m&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",ref:f,children:[e.jsxs("button",{type:"button",onClick:()=>!n&&h(!u),className:S,disabled:n,children:[e.jsxs("div",{className:"flex items-center",children:[b?.icon&&e.jsx(b.icon,{className:"w-4 h-4 mr-2 text-muted"}),e.jsx("span",{className:b?"text-primary":"text-muted",children:b?b.label:a})]}),e.jsx(et,{className:`w-4 h-4 text-muted transition-transform ${u?"rotate-180":""}`})]}),u&&e.jsx("div",{className:"absolute z-50 w-full mt-1 bg-surface border border-light rounded-md shadow-lg max-h-60 overflow-auto",children:t.map(N=>e.jsxs("button",{type:"button",onClick:()=>!N.disabled&&w(N.value),className:`w-full flex items-center px-4 py-3 text-left transition-colors ${N.disabled?"opacity-50 cursor-not-allowed":"hover:bg-accent-light cursor-pointer"} ${N.value===s?"bg-accent-light text-primary":"text-primary"}`,disabled:N.disabled,children:[N.icon&&e.jsx(N.icon,{className:"w-4 h-4 mr-2 text-muted"}),N.label]},N.value))})]}),i&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i})]})}function lc({title:t,subtitle:s,showBackButton:r=!1,backTo:a,actions:o,icon:n,className:i=""}){const c=he(),m=()=>{c(a||-1)};return e.jsx("header",{className:`bg-surface border-b border-light px-6 py-4 ${i}`,children:e.jsxs("div",{className:"max-w-6xl mx-auto flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[r&&e.jsx(F,{variant:"ghost",size:"sm",onClick:m,icon:Oe,title:"Go back"}),e.jsxs("div",{className:"flex items-center gap-3",children:[n&&e.jsx("div",{className:"w-10 h-10 bg-accent/10 rounded-lg flex items-center justify-center",children:e.jsx(n,{className:"w-5 h-5 text-accent"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-primary",children:t}),s&&e.jsx("p",{className:"text-sm text-secondary",children:s})]})]})]}),o&&e.jsx("div",{className:"flex items-center gap-3",children:o})]})})}const cc={sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"};function De({isOpen:t,onClose:s,title:r,children:a,size:o="md",showCloseButton:n=!0,closeOnOverlayClick:i=!0,actions:c}){return l.useEffect(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[t]),l.useEffect(()=>{const m=u=>{u.key==="Escape"&&s()};return t&&document.addEventListener("keydown",m),()=>{document.removeEventListener("keydown",m)}},[t,s]),t?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:i?s:void 0}),e.jsxs("div",{className:`relative bg-surface rounded-lg shadow-xl w-full ${cc[o]} z-10`,children:[(r||n)&&e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-light",children:[r&&e.jsx("h2",{className:"text-lg font-semibold text-primary",children:r}),n&&e.jsx(F,{variant:"ghost",size:"sm",onClick:s,icon:Ie,title:"Close"})]}),e.jsx("div",{className:"p-6",children:a}),c&&e.jsx("div",{className:"flex justify-end gap-3 p-6 border-t border-light",children:c})]})]})}):null}const dc={success:{icon:Pe,bgColor:"bg-green-50",borderColor:"border-green-200",iconColor:"text-green-600",titleColor:"text-green-800",textColor:"text-green-700"},error:{icon:be,bgColor:"bg-red-50",borderColor:"border-red-200",iconColor:"text-red-600",titleColor:"text-red-800",textColor:"text-red-700"},warning:{icon:It,bgColor:"bg-yellow-50",borderColor:"border-yellow-200",iconColor:"text-yellow-600",titleColor:"text-yellow-800",textColor:"text-yellow-700"},info:{icon:da,bgColor:"bg-blue-50",borderColor:"border-blue-200",iconColor:"text-blue-600",titleColor:"text-blue-800",textColor:"text-blue-700"}};function ht({variant:t,title:s,children:r,onClose:a,className:o=""}){const n=dc[t],i=n.icon;return e.jsx("div",{className:`p-4 rounded-md border ${n.bgColor} ${n.borderColor} ${o}`,children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(i,{className:`w-5 h-5 ${n.iconColor}`})}),e.jsxs("div",{className:"ml-3 flex-1",children:[s&&e.jsx("h3",{className:`text-sm font-medium ${n.titleColor} mb-1`,children:s}),e.jsx("div",{className:`text-sm ${n.textColor}`,children:r})]}),a&&e.jsx("div",{className:"ml-auto pl-3",children:e.jsx("button",{type:"button",onClick:a,className:`inline-flex rounded-md p-1.5 ${n.textColor} hover:${n.bgColor} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-green-50 focus:ring-green-600`,children:e.jsx(Ie,{className:"w-4 h-4"})})})]})})}const Ya=we.createContext(void 0),uc=({children:t})=>{const[s,r]=l.useState([]),a=n=>{const i=Math.random().toString(36).substr(2,9),c={...n,id:i};r(u=>[...u,c]);const m=n.duration||5e3;setTimeout(()=>{o(i)},m)},o=n=>{r(i=>i.filter(c=>c.id!==n))};return e.jsxs(Ya.Provider,{value:{toasts:s,showToast:a,removeToast:o},children:[t,e.jsx(mc,{toasts:s,removeToast:o})]})},mc=({toasts:t,removeToast:s})=>t.length===0?null:e.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:t.map(r=>e.jsx(ht,{variant:r.variant,title:r.title,onClose:()=>s(r.id),className:"min-w-80 shadow-lg animate-slide-in",children:r.message},r.id))}),Ge=()=>{const t=we.useContext(Ya);if(!t)throw new Error("useToast must be used within ToastProvider");return t};class Xe extends l.Component{state={hasError:!1,error:null,errorInfo:null};static getDerivedStateFromError(s){return{hasError:!0,error:s,errorInfo:null}}componentDidCatch(s,r){console.error("ErrorBoundary caught an error:",s,r),this.setState({error:s,errorInfo:r})}handleRetry=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){if(this.state.hasError){if(this.props.fallback)return this.props.fallback;const s=this.state.error?.message?.includes("useContext")||this.state.error?.message?.includes("must be used within");return e.jsx("div",{className:"min-h-[400px] flex items-center justify-center",children:e.jsxs("div",{className:"text-center p-8 max-w-lg",children:[e.jsx(be,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:s?"Context Error":"Something went wrong"}),e.jsxs("div",{className:"text-sm text-gray-600 mb-6",children:[s?e.jsxs("div",{children:[e.jsx("p",{className:"mb-2",children:"A component is trying to access data that isn't available."}),e.jsx("p",{className:"mb-2",children:"This usually happens when a component is not properly wrapped with its required provider."})]}):e.jsx("p",{className:"mb-2",children:"An error occurred while rendering this component."}),this.state.error&&e.jsxs("details",{className:"mt-4",children:[e.jsx("summary",{className:"cursor-pointer text-blue-600 hover:text-blue-800",children:"Show error details"}),e.jsx("pre",{className:"text-left bg-gray-50 p-4 rounded-md overflow-auto text-xs mt-2",children:this.state.error.toString()})]})]}),e.jsxs("div",{className:"space-x-4",children:[e.jsx(F,{onClick:this.handleRetry,children:"Try Again"}),e.jsx(F,{variant:"ghost",onClick:()=>window.location.reload(),children:"Reload Page"})]})]})})}return this.props.children}}const ps=t=>({id:t.id,name:t.projectName||t.project_name||"",client:t.clientName||t.client_name||"N/A",vendor:t.targetPLCVendor||t.target_plc_vendor||"N/A",type:t.projectType||t.project_type||"",lastModified:t.updatedAt||t.updated_at||"",description:t.description||"",status:"active",versions:[],recentActivity:[]}),me=K.create({baseURL:`${it.apiBaseUrl}/api/v1`,timeout:1e4}),hc=()=>{const t=H.getToken();return t?(console.log("ProjectsAPI: Found auth token:",t?`${t.substring(0,20)}...`:"null"),t):(console.warn("ProjectsAPI: No authentication token found. User may not be logged in."),null)};me.interceptors.request.use(t=>{const s=hc();return s?(t.headers.Authorization=`Bearer ${s}`,console.log("ProjectsAPI interceptor - Added Authorization header")):console.warn("ProjectsAPI interceptor - No token available for request to:",t.url),t},t=>(console.error("ProjectsAPI request interceptor error:",t),Promise.reject(t)));me.interceptors.response.use(t=>(console.log("ProjectsAPI Response:",{url:t.config.url,status:t.status,data:t.data}),t),t=>{throw console.error("Projects API Error:",{url:t.config?.url,status:t.response?.status,statusText:t.response?.statusText,data:t.response?.data,message:t.message}),t});class ae{static async createProject(s){try{const r=await me.post("/projects",s);if(!r.data.success||!r.data.project)throw new Error(r.data.message||"Failed to create project");return r.data.project}catch(r){throw r.response?.data?.error?new Error(r.response.data.error):r}}static async getProjects(){try{const s=await me.get("/projects");if(!s.data.success)throw new Error(s.data.message||"Failed to fetch projects");return s.data.projects||[]}catch(s){throw console.error("ProjectsAPI.getProjects error:",s.response?.data||s.message),s.response?.status===401?new Error("Your session has expired. Please log in again."):s.response?.status===403?new Error("Access denied. Please check your permissions."):s.response?.data?.error?new Error(s.response.data.error):s}}static async getProject(s){try{const r=await me.get(`/projects/${s}`);if(!r.data.success||!r.data.project)throw new Error(r.data.message||"Project not found");return r.data.project}catch(r){throw r.response?.data?.error?new Error(r.response.data.error):r}}static async updateProject(s,r){try{const a=await me.patch(`/projects/${s}`,r);if(!a.data.success||!a.data.project)throw new Error(a.data.message||"Failed to update project");return a.data.project}catch(a){throw a.response?.data?.error?new Error(a.response.data.error):a}}static async autosaveProject(s,r){try{const a=await me.put(`/projects/${s}/autosave`,{autosaveState:r});if(!a.data.success)throw new Error(a.data.message||"Auto-save failed")}catch(a){console.error("Auto-save failed:",a.response?.data?.error||a.message)}}static async saveProject(s,r){try{const a=await me.put(`/projects/${s}/save`,{state:r});if(!a.data.success)throw new Error(a.data.message||"Save failed")}catch(a){throw a.response?.data?.error?new Error(a.response.data.error):a}}static async deleteProject(s){try{const r=await me.delete(`/projects/${s}`);if(!r.data.success)throw new Error(r.data.message||"Failed to delete project")}catch(r){throw r.response?.data?.error?new Error(r.response.data.error):r}}static async checkProjectOwnership(s){try{const r=await me.get(`/projects/${s}/ownership`);return r.data.success&&r.data.isOwner||!1}catch(r){return console.error("Ownership check failed:",r.response?.data?.error||r.message),!1}}static async getVersionHistory(s){try{return(await me.get(`/projects/${s}/versions`)).data.versions||[]}catch(r){throw r.response?.data?.error?new Error(r.response.data.error):r}}static async createVersion(s,r){try{console.log("ProjectsAPI: Creating version for project",s,"with data:",r);const a=await me.post(`/projects/${s}/create-version`,r);if(console.log("ProjectsAPI: Create version response:",a.data),!a.data.success)throw new Error("Failed to create version");return a.data.versionId}catch(a){throw console.error("ProjectsAPI: Error creating version:",a),console.error("ProjectsAPI: Error response:",a.response?.data),a.response?.data?.error?new Error(a.response.data.error):a}}static async getVersion(s,r){try{console.log("ProjectsAPI: Getting full version data for project",s,"version",r);const a=await me.get(`/projects/${s}/version/${r}`);if(!a.data.success)throw new Error("Failed to get version data");const o=a.data.data;return console.log("ProjectsAPI: Retrieved version data:",o),o}catch(a){throw console.error("ProjectsAPI: Error getting version data:",a),a.response?.data?.error?new Error(a.response.data.error):a}}static async rollbackToVersion(s,r){try{console.log("ProjectsAPI: Rolling back project",s,"to version",r);const a=await me.post(`/projects/${s}/version/${r}/rollback`);if(console.log("ProjectsAPI: Rollback response:",a.data),!a.data.success)throw new Error("Failed to rollback to version");return{rolledBackTo:a.data.rolledBackTo,newVersion:a.data.newVersion}}catch(a){throw console.error("ProjectsAPI: Error rolling back:",a),console.error("ProjectsAPI: Error response:",a.response?.data),a.response?.data?.error?new Error(a.response.data.error):a}}static async createVersionSnapshot(s,r,a=!1){try{const o=await me.post(`/projects/${s}/version`,{message:r,isAuto:a});if(!o.data.success)throw new Error("Failed to create version snapshot");return o.data.version}catch(o){throw o.response?.data?.error?new Error(o.response.data.error):o}}static async getVersionSnapshot(s,r){try{const a=await me.get(`/projects/${s}/version/${r}`);if(!a.data.success)throw new Error("Failed to get version snapshot");return a.data.data}catch(a){throw a.response?.data?.error?new Error(a.response.data.error):a}}static async createAutoSaveVersion(s,r){try{if(!(await me.post(`/projects/${s}/auto-save`,{state:r})).data.success)throw new Error("Auto-save version creation failed")}catch(a){console.error("Auto-save version creation failed:",a.response?.data?.error||a.message)}}static async getLatestAutoSave(s){try{return(await me.get(`/projects/${s}/auto-save`)).data}catch(r){return console.error("Failed to get latest auto-save:",r.response?.data?.error||r.message),null}}static async deleteVersion(s,r){try{if(!(await me.delete(`/projects/${s}/version/${r}`)).data.success)throw new Error("Failed to delete version")}catch(a){throw a.response?.data?.error?new Error(a.response.data.error):a}}}function Bt({projectId:t,autoCreateVersions:s=!0,versionInterval:r=300*1e3}){const[a,o]=l.useState([]),[n,i]=l.useState(!1),[c,m]=l.useState(null),[u,h]=l.useState(null),{showToast:f}=Ge(),b=l.useCallback(async()=>{if(!t){console.log("useVersionControl: No project ID provided");return}console.log("useVersionControl: Loading version history for project",t),i(!0),m(null);try{const j=await ae.getVersionHistory(t);if(console.log("useVersionControl: Loaded version history:",j),o(j),j.length>0){const v=j[0];h(new Date(v.snapshot_info.timestamp*1e3)),console.log("useVersionControl: Latest version time set:",v.snapshot_info.timestamp)}}catch(j){const v=j.message||"Failed to load version history";m(v),console.error("useVersionControl: Failed to load version history:",j)}finally{i(!1)}},[t]),w=l.useCallback(async(j,v)=>{if(!t)throw new Error("No project ID provided");try{m(null),console.log("useVersionControl: Creating version with state:",v),console.log("useVersionControl: Creating version with message:",j);const x={state:v||{},message:j||`Manual save - ${new Date().toLocaleString()}`};console.log("useVersionControl: Sending version data:",x);const T=await ae.createVersion(t,x);return console.log("useVersionControl: Version created successfully:",T),f({variant:"success",title:"Version Saved",message:`Version ${T} saved successfully`,duration:3e3}),await b(),T}catch(x){throw console.error("useVersionControl: Error creating version:",x),m(x.message||"Failed to create version"),f({variant:"error",title:"Save Failed",message:x.message||"Failed to create version",duration:5e3}),x}},[t,b,f]),p=l.useCallback(async j=>{if(!t)throw new Error("No project ID provided");try{m(null);const v=await ae.rollbackToVersion(t,j);console.log(`Enhanced rollback completed: rolled back to version ${v.rolledBackTo}, created new version ${v.newVersion}`),f({variant:"success",title:"Rollback Successful",message:`Rolled back to version ${v.rolledBackTo}. New version ${v.newVersion} created.`,duration:4e3}),await b(),window.dispatchEvent(new CustomEvent("pandaura:project-rollback",{detail:{projectId:t,targetVersion:j,rolledBackTo:v.rolledBackTo,newVersion:v.newVersion,timestamp:Date.now()}})),window.dispatchEvent(new CustomEvent("pandaura:project-state-changed",{detail:{projectId:t,action:"rollback",targetVersion:v.rolledBackTo,newVersion:v.newVersion}}))}catch(v){throw m(v.message||"Failed to rollback to version"),f({variant:"error",title:"Rollback Failed",message:v.message||"Failed to rollback to version",duration:5e3}),v}},[t,b,f]),S=l.useCallback(async j=>{if(!t)throw new Error("No project ID provided");try{return await ae.getVersion(t,j)}catch(v){throw m(v.message||"Failed to get version data"),v}},[t]),N=l.useCallback(async(j,v)=>{if(!(!t||!s)){if(u&&Date.now()-u.getTime()<r){console.log("Skipping auto-version: too soon since last version");return}try{await ae.createAutoSaveVersion(t,j),console.log("Auto-version created:",v||"Automatic save"),h(new Date)}catch(x){console.error("Failed to create auto-version:",x)}}},[t,s,r,u]),C=l.useCallback(()=>u?Date.now()-u.getTime()>=r:!0,[u,r]);l.useEffect(()=>{console.log("useVersionControl: useEffect triggered with projectId:",t),t&&t>0?(console.log("useVersionControl: Calling refreshVersions for project:",t),b()):(console.log("useVersionControl: No valid projectId, skipping version load"),o([]))},[t,b]);const k=l.useCallback(async j=>{if(!t)throw new Error("No project ID provided");try{m(null),await ae.deleteVersion(t,j),await b(),window.dispatchEvent(new CustomEvent("pandaura:version-deleted",{detail:{projectId:t,versionNumber:j,timestamp:Date.now()}}))}catch(v){throw m(v.message||"Failed to delete version"),v}},[t,b]);return{versions:a,isLoading:n,error:c,createVersion:w,rollbackToVersion:p,deleteVersion:k,getVersionData:S,refreshVersions:b,triggerAutoVersion:N,lastVersionTime:u,canCreateVersion:C()}}function xc(t,s=3e4){const[r,a]=l.useState(null),[o,n]=l.useState(!0),[i,c]=l.useState(null),[m,u]=l.useState(!1),[h,f]=l.useState(null),b=async()=>{try{console.log(`useProject: Loading project ${t}...`),c(null);const C=await ae.getProject(t);console.log(`useProject: Project ${t} loaded successfully:`,C);const k=ps(C);a(k)}catch(C){console.error("Failed to load project:",C);let k="Failed to load project";C.code==="ERR_NETWORK"?k="Cannot connect to server. Please check if the backend is running on port 5000.":C.code==="ERR_INSUFFICIENT_RESOURCES"?k="Server resource error. Please try refreshing the page or restart the backend.":C.response?.status===404?k=`Project with ID ${t} not found.`:C.response?.status===401?k="Your session has expired. Please log in again.":C.message&&(k=C.message),c(k)}finally{n(!1)}},w=async C=>{if(!r)return;const k=await ae.updateProject(r.id,C),j=ps(k);a(j),u(!1),f(new Date)},p=async C=>{if(r)try{await ae.autosaveProject(r.id,C),f(new Date)}catch(k){console.error("Auto-save failed:",k)}},S=async C=>{r&&(await ae.saveProject(r.id,C),u(!1),f(new Date))},N=()=>u(!0);return l.useEffect(()=>{t&&t>0&&b()},[t]),{project:r,isLoading:o,error:i,isDirty:m,lastSaved:h,updateProject:w,autosave:p,save:S,markDirty:N,reload:b}}function Xa(t,s={}){const[r,a]=l.useState(s),[o,n]=l.useState(!1),[i,c]=l.useState(null),[m,u]=l.useState(null),[h,f]=l.useState(!1),b=l.useRef(null),w=l.useRef(null),p=l.useRef(0),S=3,N=l.useRef(0),{triggerAutoVersion:C,createVersion:k}=Bt({projectId:t??-1,autoCreateVersions:!0,versionInterval:600*1e3}),j=l.useCallback((A,O)=>JSON.stringify(A)!==JSON.stringify(O),[]),v=l.useCallback(async(A,O=!1)=>{if(!t||!j(A,b.current))return!0;n(!0),u(null);try{if(O?await ae.saveProject(t,{autosaveState:A}):await ae.autosaveProject(t,A),b.current=structuredClone(A),c(new Date),f(!1),p.current=0,O)try{await k(`Manual save - ${new Date().toLocaleString()}`,A),console.log("Manual version created successfully")}catch(D){console.error("Failed to create manual version:",D)}else if(N.current++,N.current>=10)try{await C(A,`Auto-version after ${N.current} changes`),N.current=0}catch(D){console.error("Failed to create auto-version:",D)}return!0}catch(D){const L=D.response?.data?.error||D.message||"Auto-save failed";if(console.error("Auto-save failed:",L),p.current<S&&!O){p.current++,console.log(`Retrying auto-save (attempt ${p.current}/${S})`);const U=Math.pow(2,p.current)*1e3;setTimeout(()=>v(A,!1),U)}else{u(L);try{const U=`pandaura_project_${t}_fallback`;localStorage.setItem(U,JSON.stringify({state:A,timestamp:Date.now(),projectId:t})),console.log("State cached to localStorage as fallback")}catch(U){console.error("Failed to cache state to localStorage:",U)}}return!1}finally{n(!1)}},[t,j]),x=l.useCallback(A=>{w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{v(A,!1)},2e3)},[v]),T=l.useCallback(A=>{a(O=>{const D=typeof A=="function"?A(O):{...O,...A};return j(D,b.current)&&(f(!0),x(D)),D})},[j,x]),y=l.useCallback(async()=>await v(r,!0),[v,r]),d=l.useCallback(async A=>{if(!t)return!1;try{const O=await v(r,!1);return O&&(await k(A,r),console.log("Manual version created with message:",A)),O}catch(O){return console.error("Failed to save with message:",O),!1}},[t,v,r,k]),g=l.useCallback(()=>{try{const A=`pandaura_project_${t}_fallback`,O=localStorage.getItem(A);if(O){const{state:D,timestamp:L}=JSON.parse(O);Date.now()-L<3600*1e3&&(console.log("Loaded fallback state from localStorage"),a(D),f(!0),v(D,!1)),localStorage.removeItem(A)}}catch(A){console.error("Failed to load fallback state:",A)}},[t,v]);return l.useEffect(()=>{t&&g()},[t,g]),l.useEffect(()=>()=>{w.current&&clearTimeout(w.current)},[]),{projectState:r,updateProjectState:T,isSaving:o,lastSaved:i,saveError:m,hasUnsavedChanges:h,saveNow:y,saveWithMessage:d,loadFallbackState:g}}function Ja({isSaving:t,lastSaved:s,saveError:r,hasUnsavedChanges:a,onManualSave:o,className:n=""}){const i=h=>{if(!h)return"Never saved";const b=new Date().getTime()-h.getTime(),w=Math.floor(b/1e3),p=Math.floor(w/60),S=Math.floor(p/60);return w<60?"Saved just now":p<60?`Saved ${p}m ago`:S<24?`Saved ${S}h ago`:`Saved on ${h.toLocaleDateString()}`},c=()=>t?e.jsx(ua,{className:"w-4 h-4 animate-spin text-blue-500"}):r?e.jsx(be,{className:"w-4 h-4 text-red-500"}):a?e.jsx(ft,{className:"w-4 h-4 text-yellow-500"}):e.jsx(Pe,{className:"w-4 h-4 text-green-500"}),m=()=>t?"Saving...":r?"Save failed":a?"Unsaved changes":i(s),u=()=>t?"text-blue-600":r?"text-red-600":a?"text-yellow-600":"text-green-600";return e.jsxs("div",{className:`flex items-center gap-2 ${n}`,children:[c(),e.jsx("span",{className:`text-sm ${u()}`,children:m()}),r&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("span",{className:"text-xs text-red-500",title:r,children:["(",r,")"]}),o&&e.jsx("button",{onClick:o,className:"text-xs text-blue-600 hover:text-blue-800 underline",title:"Retry save",children:"Retry"})]}),a&&o&&!t&&e.jsxs("button",{onClick:o,className:"flex items-center gap-1 px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors",title:"Save now",children:[e.jsx(He,{className:"w-3 h-3"}),"Save"]})]})}function Ms({sessionMode:t=!1}){const{getModuleState:s,saveModuleState:r}=dr(),a=he(),{projectId:o}=Mt(),n=s("AskPandaura"),[i,c]=l.useState(n.chatMessage||""),[m,u]=l.useState(!1),[h,f]=l.useState(!1),b=o?parseInt(o):null,{updateProjectState:w,isSaving:p,lastSaved:S,saveError:N,hasUnsavedChanges:C,saveNow:k}=Xa(b||0,{module:"AskPandaura",chatMessage:i,lastActivity:new Date().toISOString()});l.useEffect(()=>{!t&&b&&w({module:"AskPandaura",chatMessage:i,lastActivity:new Date().toISOString()})},[t,b,w,i]),l.useEffect(()=>{const v=()=>{const y=document.querySelector('[class*="w-72"], [class*="w-16"]');if(y){const d=y.classList.contains("w-16");f(d)}};setTimeout(v,100);const x=new MutationObserver(v),T=document.body;return x.observe(T,{attributes:!0,attributeFilter:["class"],subtree:!0}),()=>x.disconnect()},[]),l.useEffect(()=>{if(!t){const v=setTimeout(()=>{r("AskPandaura",{chatMessage:i})},1e3);return()=>clearTimeout(v)}},[i,t,r]);const j=()=>m&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-96 max-h-[80vh] overflow-hidden shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-light",children:[e.jsx("h3",{className:"text-lg font-semibold text-primary",children:"Conversations"}),e.jsx("button",{onClick:()=>u(!1),className:"text-secondary hover:text-primary",children:e.jsx(Ie,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-4 border-b border-light",children:e.jsxs("button",{onClick:()=>{c(""),u(!1)},className:"w-full flex items-center justify-center gap-2 bg-primary text-white px-4 py-2 rounded-md hover:bg-secondary transition-colors",children:[e.jsx(pt,{className:"w-4 h-4"}),"New Chat"]})}),e.jsx("div",{className:"flex-1 overflow-y-auto max-h-[400px]",children:e.jsx("div",{className:"p-4 space-y-2",children:[{id:1,title:"TIA Portal Safety IO Configuration",time:"2 hours ago"},{id:2,title:"Motor Control Logic Help",time:"Yesterday"},{id:3,title:"SCADA System Design",time:"3 days ago"},{id:4,title:"PLC Programming Best Practices",time:"1 week ago"}].map(v=>e.jsxs("div",{onClick:()=>{c(""),u(!1),console.log("Loading conversation:",v.title)},className:"p-3 rounded-md hover:bg-gray-100 cursor-pointer transition-colors border border-light",children:[e.jsx("div",{className:"font-medium text-sm text-primary truncate",children:v.title}),e.jsx("div",{className:"text-xs text-muted mt-1",children:v.time})]},v.id))})})]})});return e.jsxs("div",{className:"flex flex-col bg-white h-full relative",children:[e.jsxs("div",{className:"p-6 max-w-4xl mx-auto flex-1 pb-24",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-primary",children:"Pandaura AS"}),e.jsx("p",{className:"text-sm text-secondary",children:"Your AI co-engineer for automation, electrical, robotics, and everything in between."})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[!t&&b&&e.jsx(Ja,{isSaving:p,lastSaved:S,saveError:N,hasUnsavedChanges:C,onManualSave:k,className:"text-xs"}),e.jsx("button",{onClick:()=>u(!0),className:"p-2 rounded-md hover:bg-gray-100 transition-colors",title:"View Conversations",children:e.jsx(ds,{className:"w-6 h-6 text-primary"})})]})]}),e.jsxs("div",{className:"text-muted mt-4 px-6 flex flex-col items-center text-center",children:[e.jsx("img",{src:je,alt:"Pandaura Logo",className:"h-24 w-auto mb-4 filter-none",style:{filter:"none",imageRendering:"crisp-edges"}}),e.jsx("h2",{className:"text-lg font-semibold text-primary",children:"Ask Pandaura Anything"}),e.jsx("p",{className:"text-sm",children:"Start a conversation with Pandaura or upload a document to begin."})]}),e.jsxs("div",{className:"space-y-6 mt-8 scrollable-container optimized-text",children:[e.jsx("div",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex items-start gap-3 mb-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center text-xs font-medium text-gray-700",children:"You"}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-gray-800",children:"I need to create a motor starter logic with safety interlocks for a conveyor system. Can you help me generate the structured text code for Rockwell PLC?"})})]})}),e.jsx("div",{className:"px-4 py-3 text-sm bg-gray-50",children:e.jsxs("div",{className:"flex items-start gap-3 mb-2",children:[e.jsx("div",{className:"w-8 h-8 bg-primary rounded-full flex items-center justify-center text-xs font-medium text-white",children:"P"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-gray-800 mb-3",children:"I'll help you create a comprehensive motor starter logic with safety interlocks. Here's a structured approach:"}),e.jsxs("div",{className:"text-gray-800 mb-3",children:[e.jsx("strong",{children:"Key Components:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"Emergency stop circuit with latching"}),e.jsx("li",{children:"Guard door safety switches"}),e.jsx("li",{children:"Motor overload protection"}),e.jsx("li",{children:"Start/stop pushbutton logic"}),e.jsx("li",{children:"Status indicators and fault diagnostics"})]})]}),e.jsx("p",{className:"text-gray-800",children:"Would you like me to generate the complete ST code with these safety features included?"})]})]})}),e.jsx("div",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex items-start gap-3 mb-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center text-xs font-medium text-gray-700",children:"You"}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-gray-800",children:"Yes, please generate the code and also create the tag database for all the I/O points."})})]})}),e.jsx("div",{className:"px-4 py-3 text-sm bg-gray-50",children:e.jsxs("div",{className:"flex items-start gap-3 mb-2",children:[e.jsx("div",{className:"w-8 h-8 bg-primary rounded-full flex items-center justify-center text-xs font-medium text-white",children:"P"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-gray-800 mb-3",children:"Perfect! I'll generate both the ST logic and create a comprehensive tag database. Let me switch you to Logic Studio to generate the code, and then we can use the Tag Database Manager to organize all I/O points with proper naming conventions and documentation."}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx("button",{onClick:()=>a("/logic-studio"),className:"bg-primary text-white px-3 py-1 rounded text-xs hover:bg-secondary transition-colors",children:" Open in Logic Studio"}),e.jsx("button",{onClick:()=>a("/tag-database"),className:"bg-white border border-light px-3 py-1 rounded text-xs hover:bg-accent-light transition-colors",children:" Generate Tag Database"})]})]})]})})]})]}),e.jsx("div",{className:`fixed bottom-0 right-0 bg-white border-t px-6 py-4 shadow-md z-30 transition-all duration-200 ${h?"left-16":"left-72"}`,children:e.jsxs("div",{className:"flex items-end gap-3 max-w-4xl mx-auto",children:[e.jsx("textarea",{value:i,onChange:v=>c(v.target.value),placeholder:"Ask about PLCs, SCADA, HMI, robotics, motor control, or upload documents...",className:"flex-1 border border-light rounded-md px-4 py-3 bg-surface shadow-sm text-sm text-primary placeholder-muted resize-none focus:outline-none focus:ring-2 focus:ring-accent focus:border-accent transition-all min-h-[44px] max-h-[120px]",rows:1,style:{height:"auto"},onInput:v=>{const x=v.target;x.style.height="auto",x.style.height=Math.min(x.scrollHeight,120)+"px"}}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{console.log("Opening file upload dialog")},className:"bg-white border border-light p-3 rounded-md hover:bg-accent-light transition-colors shadow-sm",title:"Upload documents",children:e.jsx(ia,{className:"w-4 h-4 text-primary"})}),e.jsx("button",{onClick:()=>{i.trim()&&(console.log("Sending message:",i),c(""))},className:"bg-primary text-white px-6 py-3 rounded-md hover:bg-secondary transition-colors text-sm font-medium shadow-sm",disabled:!i.trim(),children:e.jsx(ys,{className:"w-4 h-4"})})]})]})}),j()]})}function pc(t,s,r){return s in t?Object.defineProperty(t,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[s]=r,t}function Ir(t,s){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,a)}return r}function _r(t){for(var s=1;s<arguments.length;s++){var r=arguments[s]!=null?arguments[s]:{};s%2?Ir(Object(r),!0).forEach(function(a){pc(t,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ir(Object(r)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(r,a))})}return t}function gc(t,s){if(t==null)return{};var r={},a=Object.keys(t),o,n;for(n=0;n<a.length;n++)o=a[n],!(s.indexOf(o)>=0)&&(r[o]=t[o]);return r}function fc(t,s){if(t==null)return{};var r=gc(t,s),a,o;if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);for(o=0;o<n.length;o++)a=n[o],!(s.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(t,a)&&(r[a]=t[a])}return r}function yc(t,s){return bc(t)||jc(t,s)||vc(t,s)||wc()}function bc(t){if(Array.isArray(t))return t}function jc(t,s){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var r=[],a=!0,o=!1,n=void 0;try{for(var i=t[Symbol.iterator](),c;!(a=(c=i.next()).done)&&(r.push(c.value),!(s&&r.length===s));a=!0);}catch(m){o=!0,n=m}finally{try{!a&&i.return!=null&&i.return()}finally{if(o)throw n}}return r}}function vc(t,s){if(t){if(typeof t=="string")return $r(t,s);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $r(t,s)}}function $r(t,s){(s==null||s>t.length)&&(s=t.length);for(var r=0,a=new Array(s);r<s;r++)a[r]=t[r];return a}function wc(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nc(t,s,r){return s in t?Object.defineProperty(t,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[s]=r,t}function Vr(t,s){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,a)}return r}function Ur(t){for(var s=1;s<arguments.length;s++){var r=arguments[s]!=null?arguments[s]:{};s%2?Vr(Object(r),!0).forEach(function(a){Nc(t,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Vr(Object(r)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(r,a))})}return t}function Sc(){for(var t=arguments.length,s=new Array(t),r=0;r<t;r++)s[r]=arguments[r];return function(a){return s.reduceRight(function(o,n){return n(o)},a)}}function Tt(t){return function s(){for(var r=this,a=arguments.length,o=new Array(a),n=0;n<a;n++)o[n]=arguments[n];return o.length>=t.length?t.apply(this,o):function(){for(var i=arguments.length,c=new Array(i),m=0;m<i;m++)c[m]=arguments[m];return s.apply(r,[].concat(o,c))}}}function gs(t){return{}.toString.call(t).includes("Object")}function kc(t){return!Object.keys(t).length}function Lt(t){return typeof t=="function"}function Cc(t,s){return Object.prototype.hasOwnProperty.call(t,s)}function Ac(t,s){return gs(s)||Ke("changeType"),Object.keys(s).some(function(r){return!Cc(t,r)})&&Ke("changeField"),s}function Tc(t){Lt(t)||Ke("selectorType")}function Pc(t){Lt(t)||gs(t)||Ke("handlerType"),gs(t)&&Object.values(t).some(function(s){return!Lt(s)})&&Ke("handlersType")}function Ec(t){t||Ke("initialIsRequired"),gs(t)||Ke("initialType"),kc(t)&&Ke("initialContent")}function Dc(t,s){throw new Error(t[s]||t.default)}var Oc={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},Ke=Tt(Dc)(Oc),ss={changes:Ac,selector:Tc,handler:Pc,initial:Ec};function Lc(t){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ss.initial(t),ss.handler(s);var r={current:t},a=Tt(Fc)(r,s),o=Tt(Mc)(r),n=Tt(ss.changes)(t),i=Tt(Rc)(r);function c(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(h){return h};return ss.selector(u),u(r.current)}function m(u){Sc(a,o,n,i)(u)}return[c,m]}function Rc(t,s){return Lt(s)?s(t.current):s}function Mc(t,s){return t.current=Ur(Ur({},t.current),s),s}function Fc(t,s,r){return Lt(s)?s(t.current):Object.keys(r).forEach(function(a){var o;return(o=s[a])===null||o===void 0?void 0:o.call(s,t.current[a])}),r}var Ic={create:Lc},_c={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}};function $c(t){return function s(){for(var r=this,a=arguments.length,o=new Array(a),n=0;n<a;n++)o[n]=arguments[n];return o.length>=t.length?t.apply(this,o):function(){for(var i=arguments.length,c=new Array(i),m=0;m<i;m++)c[m]=arguments[m];return s.apply(r,[].concat(o,c))}}}function Vc(t){return{}.toString.call(t).includes("Object")}function Uc(t){return t||zr("configIsRequired"),Vc(t)||zr("configType"),t.urls?(zc(),{paths:{vs:t.urls.monacoBase}}):t}function zc(){console.warn(Ka.deprecation)}function Bc(t,s){throw new Error(t[s]||t.default)}var Ka={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},zr=$c(Bc)(Ka),qc={config:Uc},Hc=function(){for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return function(o){return r.reduceRight(function(n,i){return i(n)},o)}};function Qa(t,s){return Object.keys(s).forEach(function(r){s[r]instanceof Object&&t[r]&&Object.assign(s[r],Qa(t[r],s[r]))}),_r(_r({},t),s)}var Gc={type:"cancelation",msg:"operation is manually canceled"};function Fs(t){var s=!1,r=new Promise(function(a,o){t.then(function(n){return s?o(Gc):a(n)}),t.catch(o)});return r.cancel=function(){return s=!0},r}var Wc=Ic.create({config:_c,isInitialized:!1,resolve:null,reject:null,monaco:null}),Za=yc(Wc,2),qt=Za[0],As=Za[1];function Yc(t){var s=qc.config(t),r=s.monaco,a=fc(s,["monaco"]);As(function(o){return{config:Qa(o.config,a),monaco:r}})}function Xc(){var t=qt(function(s){var r=s.monaco,a=s.isInitialized,o=s.resolve;return{monaco:r,isInitialized:a,resolve:o}});if(!t.isInitialized){if(As({isInitialized:!0}),t.monaco)return t.resolve(t.monaco),Fs(Is);if(window.monaco&&window.monaco.editor)return en(window.monaco),t.resolve(window.monaco),Fs(Is);Hc(Jc,Qc)(Zc)}return Fs(Is)}function Jc(t){return document.body.appendChild(t)}function Kc(t){var s=document.createElement("script");return t&&(s.src=t),s}function Qc(t){var s=qt(function(a){var o=a.config,n=a.reject;return{config:o,reject:n}}),r=Kc("".concat(s.config.paths.vs,"/loader.js"));return r.onload=function(){return t()},r.onerror=s.reject,r}function Zc(){var t=qt(function(r){var a=r.config,o=r.resolve,n=r.reject;return{config:a,resolve:o,reject:n}}),s=window.require;s.config(t.config),s(["vs/editor/editor.main"],function(r){en(r),t.resolve(r)},function(r){t.reject(r)})}function en(t){qt().monaco||As({monaco:t})}function ed(){return qt(function(t){var s=t.monaco;return s})}var Is=new Promise(function(t,s){return As({resolve:t,reject:s})}),tn={config:Yc,init:Xc,__getMonacoInstance:ed},td={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},_s=td,sd={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},rd=sd;function ad({children:t}){return we.createElement("div",{style:rd.container},t)}var nd=ad,od=nd;function id({width:t,height:s,isEditorReady:r,loading:a,_ref:o,className:n,wrapperProps:i}){return we.createElement("section",{style:{..._s.wrapper,width:t,height:s},...i},!r&&we.createElement(od,null,a),we.createElement("div",{ref:o,style:{..._s.fullWidth,...!r&&_s.hide},className:n}))}var ld=id,sn=l.memo(ld);function cd(t){l.useEffect(t,[])}var rn=cd;function dd(t,s,r=!0){let a=l.useRef(!0);l.useEffect(a.current||!r?()=>{a.current=!1}:t,s)}var Te=dd;function Dt(){}function mt(t,s,r,a){return ud(t,a)||md(t,s,r,a)}function ud(t,s){return t.editor.getModel(an(t,s))}function md(t,s,r,a){return t.editor.createModel(s,r,a?an(t,a):void 0)}function an(t,s){return t.Uri.parse(s)}function hd({original:t,modified:s,language:r,originalLanguage:a,modifiedLanguage:o,originalModelPath:n,modifiedModelPath:i,keepCurrentOriginalModel:c=!1,keepCurrentModifiedModel:m=!1,theme:u="light",loading:h="Loading...",options:f={},height:b="100%",width:w="100%",className:p,wrapperProps:S={},beforeMount:N=Dt,onMount:C=Dt}){let[k,j]=l.useState(!1),[v,x]=l.useState(!0),T=l.useRef(null),y=l.useRef(null),d=l.useRef(null),g=l.useRef(C),A=l.useRef(N),O=l.useRef(!1);rn(()=>{let M=tn.init();return M.then(R=>(y.current=R)&&x(!1)).catch(R=>R?.type!=="cancelation"&&console.error("Monaco initialization: error:",R)),()=>T.current?U():M.cancel()}),Te(()=>{if(T.current&&y.current){let M=T.current.getOriginalEditor(),R=mt(y.current,t||"",a||r||"text",n||"");R!==M.getModel()&&M.setModel(R)}},[n],k),Te(()=>{if(T.current&&y.current){let M=T.current.getModifiedEditor(),R=mt(y.current,s||"",o||r||"text",i||"");R!==M.getModel()&&M.setModel(R)}},[i],k),Te(()=>{let M=T.current.getModifiedEditor();M.getOption(y.current.editor.EditorOption.readOnly)?M.setValue(s||""):s!==M.getValue()&&(M.executeEdits("",[{range:M.getModel().getFullModelRange(),text:s||"",forceMoveMarkers:!0}]),M.pushUndoStop())},[s],k),Te(()=>{T.current?.getModel()?.original.setValue(t||"")},[t],k),Te(()=>{let{original:M,modified:R}=T.current.getModel();y.current.editor.setModelLanguage(M,a||r||"text"),y.current.editor.setModelLanguage(R,o||r||"text")},[r,a,o],k),Te(()=>{y.current?.editor.setTheme(u)},[u],k),Te(()=>{T.current?.updateOptions(f)},[f],k);let D=l.useCallback(()=>{if(!y.current)return;A.current(y.current);let M=mt(y.current,t||"",a||r||"text",n||""),R=mt(y.current,s||"",o||r||"text",i||"");T.current?.setModel({original:M,modified:R})},[r,s,o,t,a,n,i]),L=l.useCallback(()=>{!O.current&&d.current&&(T.current=y.current.editor.createDiffEditor(d.current,{automaticLayout:!0,...f}),D(),y.current?.editor.setTheme(u),j(!0),O.current=!0)},[f,u,D]);l.useEffect(()=>{k&&g.current(T.current,y.current)},[k]),l.useEffect(()=>{!v&&!k&&L()},[v,k,L]);function U(){let M=T.current?.getModel();c||M?.original?.dispose(),m||M?.modified?.dispose(),T.current?.dispose()}return we.createElement(sn,{width:w,height:b,isEditorReady:k,loading:h,_ref:d,className:p,wrapperProps:S})}var xd=hd;l.memo(xd);function pd(t){let s=l.useRef();return l.useEffect(()=>{s.current=t},[t]),s.current}var gd=pd,rs=new Map;function fd({defaultValue:t,defaultLanguage:s,defaultPath:r,value:a,language:o,path:n,theme:i="light",line:c,loading:m="Loading...",options:u={},overrideServices:h={},saveViewState:f=!0,keepCurrentModel:b=!1,width:w="100%",height:p="100%",className:S,wrapperProps:N={},beforeMount:C=Dt,onMount:k=Dt,onChange:j,onValidate:v=Dt}){let[x,T]=l.useState(!1),[y,d]=l.useState(!0),g=l.useRef(null),A=l.useRef(null),O=l.useRef(null),D=l.useRef(k),L=l.useRef(C),U=l.useRef(),M=l.useRef(a),R=gd(n),z=l.useRef(!1),J=l.useRef(!1);rn(()=>{let I=tn.init();return I.then(Y=>(g.current=Y)&&d(!1)).catch(Y=>Y?.type!=="cancelation"&&console.error("Monaco initialization: error:",Y)),()=>A.current?ue():I.cancel()}),Te(()=>{let I=mt(g.current,t||a||"",s||o||"",n||r||"");I!==A.current?.getModel()&&(f&&rs.set(R,A.current?.saveViewState()),A.current?.setModel(I),f&&A.current?.restoreViewState(rs.get(n)))},[n],x),Te(()=>{A.current?.updateOptions(u)},[u],x),Te(()=>{!A.current||a===void 0||(A.current.getOption(g.current.editor.EditorOption.readOnly)?A.current.setValue(a):a!==A.current.getValue()&&(J.current=!0,A.current.executeEdits("",[{range:A.current.getModel().getFullModelRange(),text:a,forceMoveMarkers:!0}]),A.current.pushUndoStop(),J.current=!1))},[a],x),Te(()=>{let I=A.current?.getModel();I&&o&&g.current?.editor.setModelLanguage(I,o)},[o],x),Te(()=>{c!==void 0&&A.current?.revealLine(c)},[c],x),Te(()=>{g.current?.editor.setTheme(i)},[i],x);let te=l.useCallback(()=>{if(!(!O.current||!g.current)&&!z.current){L.current(g.current);let I=n||r,Y=mt(g.current,a||t||"",s||o||"",I||"");A.current=g.current?.editor.create(O.current,{model:Y,automaticLayout:!0,...u},h),f&&A.current.restoreViewState(rs.get(I)),g.current.editor.setTheme(i),c!==void 0&&A.current.revealLine(c),T(!0),z.current=!0}},[t,s,r,a,o,n,u,h,f,i,c]);l.useEffect(()=>{x&&D.current(A.current,g.current)},[x]),l.useEffect(()=>{!y&&!x&&te()},[y,x,te]),M.current=a,l.useEffect(()=>{x&&j&&(U.current?.dispose(),U.current=A.current?.onDidChangeModelContent(I=>{J.current||j(A.current.getValue(),I)}))},[x,j]),l.useEffect(()=>{if(x){let I=g.current.editor.onDidChangeMarkers(Y=>{let W=A.current.getModel()?.uri;if(W&&Y.find(oe=>oe.path===W.path)){let oe=g.current.editor.getModelMarkers({resource:W});v?.(oe)}});return()=>{I?.dispose()}}return()=>{}},[x,v]);function ue(){U.current?.dispose(),b?f&&rs.set(n,A.current.saveViewState()):A.current.getModel()?.dispose(),A.current.dispose()}return we.createElement(sn,{width:w,height:p,isEditorReady:x,loading:m,_ref:O,className:S,wrapperProps:N})}var yd=fd,bd=l.memo(yd),jd=bd;function vd({message:t,onApply:s}){return e.jsxs("div",{className:"absolute z-50 bg-white border border-light rounded-md shadow-md p-3 w-64 text-sm",children:[e.jsx("div",{className:"text-primary mb-2",children:t}),e.jsx("button",{onClick:s,className:"bg-primary text-white px-3 py-1 rounded-md hover:bg-secondary transition-colors text-xs",children:" Apply Fix"})]})}function wd({suggestion:t,onApply:s,onDismiss:r}){const[a,o]=l.useState(!1);return t?e.jsxs("div",{className:"bg-accent-light border border-accent rounded-md p-3 mb-2 relative",children:[e.jsx("button",{onClick:r,className:"absolute top-2 right-2 text-muted hover:text-primary",children:e.jsx(Ie,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex items-start gap-3 pr-6",children:[e.jsx(Gs,{className:"w-5 h-5 text-accent mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-primary text-sm",children:t.message}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsxs("button",{onClick:()=>o(!a),className:"text-xs bg-white border border-light px-3 py-1 rounded hover:bg-gray-50 transition-colors flex items-center gap-1",children:[e.jsx(Je,{className:"w-3 h-3"}),a?"Hide Preview":"Show Preview"]}),e.jsx("button",{onClick:()=>s(t.refactoredCode),className:"text-xs bg-primary text-white px-3 py-1 rounded hover:bg-secondary transition-colors",children:"Apply Refactor"}),e.jsx("button",{onClick:r,className:"text-xs text-muted hover:text-primary px-2 py-1",children:"Dismiss"})]}),a&&e.jsx("div",{className:"mt-3 text-xs",children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-muted mb-1",children:"Before:"}),e.jsx("pre",{className:"bg-gray-100 p-2 rounded border text-xs overflow-x-auto",children:t.originalCode})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-muted mb-1",children:"After:"}),e.jsx("pre",{className:"bg-green-50 p-2 rounded border text-xs overflow-x-auto",children:t.refactoredCode})]})]})})]})]})]}):null}function Nd({isVisible:t,selectedText:s,selectedLine:r,position:a,onExplain:o,onRefactor:n,onSimplify:i,onTagEdit:c}){const[m,u]=l.useState(!1),[h,f]=l.useState(""),b=[{id:"explain",icon:e.jsx(Gs,{className:"w-4 h-4"}),label:"Explain",onClick:()=>{const S=w(s);f(S),u(!0),o(s)},variant:"accent"},{id:"refactor",icon:e.jsx(Ne,{className:"w-4 h-4"}),label:"Refactor",onClick:()=>n(s),variant:"primary"},{id:"simplify",icon:e.jsx(xa,{className:"w-4 h-4"}),label:"Simplify",onClick:()=>i(s),variant:"secondary"},{id:"tags",icon:e.jsx(ii,{className:"w-4 h-4"}),label:"Tag Edit",onClick:()=>c(r),variant:"secondary"}],w=S=>S.includes("IF")&&S.includes("THEN")?"This is a conditional logic block that checks if certain conditions are met before executing actions. The IF statement evaluates boolean conditions and executes the THEN clause when true.":S.includes("CASE")?"This CASE statement provides multi-way branching logic, evaluating an expression and executing different code blocks based on matching values. It's more efficient than multiple IF-ELSE statements.":S.includes(":=")?"This is an assignment operation that sets a variable to a specific value. The ':=' operator is used in structured text to assign values to variables.":S.includes("AND")||S.includes("OR")?"This contains boolean logic operators that combine multiple conditions. AND requires all conditions to be true, while OR requires at least one condition to be true.":"This code block contains PLC logic that controls industrial automation processes. The structured text follows IEC 61131-3 standards for programmable controller programming.",p=(S="secondary")=>{const N="p-2 rounded shadow-sm text-xs font-medium transition-all duration-150 flex items-center gap-1 whitespace-nowrap";switch(S){case"primary":return`${N} bg-primary text-white hover:bg-secondary`;case"accent":return`${N} bg-accent text-white hover:bg-purple-600`;default:return`${N} bg-white border border-light text-primary hover:bg-accent-light`}};return t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed z-50 bg-white border border-light rounded-lg shadow-lg p-1 flex gap-1",style:{left:a.x,top:a.y-50,transform:"translateX(-50%)"},children:b.map(S=>e.jsxs("button",{onClick:S.onClick,className:p(S.variant),title:S.label,children:[S.icon,e.jsx("span",{className:"hidden sm:inline",children:S.label})]},S.id))}),m&&e.jsx("div",{className:"fixed z-40 bg-blue-50 border border-blue-200 rounded-lg shadow-lg p-3 max-w-md",style:{left:a.x,top:a.y+20,transform:"translateX(-50%)"},children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Gs,{className:"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-blue-800 text-xs mb-1",children:"Code Explanation:"}),e.jsx("div",{className:"text-blue-700 text-xs leading-relaxed",children:h})]})]}),e.jsx("button",{onClick:()=>u(!1),className:"text-blue-400 hover:text-blue-600 flex-shrink-0",children:e.jsx(cs,{className:"w-3 h-3"})})]})})]}):null}function Sd({initialCode:t,vendorType:s,onChange:r}){const[a,o]=l.useState(t),[n,i]=l.useState(!1),[c,m]=l.useState({top:0,left:0}),[u,h]=l.useState(!1),[f,b]=l.useState(!1),[w,p]=l.useState(""),[S,N]=l.useState(0),[C,k]=l.useState({x:0,y:0});l.useEffect(()=>{t!==a&&o(t)},[t]);const j=d=>{const g=d||"";o(g),r(g),g.includes("undefined_tag")?(i(!0),m({top:50,left:200})):i(!1)},v=()=>{const d=a.replace("undefined_tag","defined_tag");o(d),r(d),i(!1)};l.useEffect(()=>{a.includes("IF")&&a.includes("ELSE")&&a.includes("IF")?h(!0):h(!1)},[a]);const x={type:"nested-conditionals",message:"This nested IF structure can be simplified with a CASE block. Want to refactor?",originalCode:`IF condition1 THEN
  IF condition2 THEN
    result := 1;
  ELSE
    result := 2;
  END_IF;
ELSE
  result := 0;
END_IF;`,refactoredCode:`CASE TRUE OF
  condition1 AND condition2: result := 1;
  condition1 AND NOT condition2: result := 2;
  ELSE result := 0;
END_CASE;`,line:10},T=d=>{o(d),r(d),h(!1)},y=d=>{if(d&&d.startLineNumber&&d.endLineNumber){const g=d.startLineNumber,D=a.split(`
`).slice(d.startLineNumber-1,d.endLineNumber).join(`
`);D.trim()?(p(D),N(g),k({x:300,y:g*20+100}),b(!0)):b(!1)}};return e.jsxs("div",{className:"relative w-full h-[90vh]",children:[u&&e.jsx(wd,{suggestion:x,onApply:T,onDismiss:()=>h(!1)}),e.jsx("div",{className:"border border-light rounded shadow-sm h-full",children:e.jsx(jd,{height:"100%",language:"pascal",theme:"vs-light",value:a,onChange:j,onMount:d=>{d.onDidChangeCursorSelection(g=>{y(g.selection)})},options:{fontSize:14,minimap:{enabled:!1},scrollBeyondLastLine:!1,selectOnLineNumbers:!0,glyphMargin:!0,folding:!0,lineNumbers:"on",scrollbar:{vertical:"visible",horizontal:"visible",verticalScrollbarSize:14,horizontalScrollbarSize:14},wordWrap:"on",automaticLayout:!0}})}),n&&e.jsx("div",{className:"absolute z-50",style:{top:c.top,left:c.left},children:e.jsx(vd,{message:"Looks like this tag is undefined. Do you want to auto-fix it?",onApply:v})}),e.jsx(Nd,{isVisible:f,selectedText:w,selectedLine:S,position:C,onExplain:d=>console.log("Explaining:",d),onRefactor:d=>console.log("Refactoring:",d),onSimplify:d=>console.log("Simplifying:",d),onTagEdit:d=>console.log("Editing tags for line:",d)})]})}function kd(){return e.jsxs("div",{className:"fixed bottom-6 right-6 z-50 flex flex-col gap-2",children:[e.jsx("button",{onClick:()=>{console.log("AI Refactoring logic..."),alert("AI is analyzing your code structure and will suggest improvements for better readability and performance.")},className:"bg-white border border-light p-3 rounded-full shadow-md hover:bg-accent-light transition-colors",title:"Refactor Logic",children:e.jsx(xa,{className:"w-5 h-5 text-primary"})}),e.jsx("button",{onClick:()=>{console.log("AI Explaining code..."),alert(`AI Code Explanation:

This logic implements a motor control sequence with safety interlocks. The code structure follows industry standards with proper error handling and safety protocols.`)},className:"bg-white border border-light p-3 rounded-full shadow-md hover:bg-accent-light transition-colors",title:"Explain Code",children:e.jsx($n,{className:"w-5 h-5 text-primary"})}),e.jsx("button",{onClick:()=>{console.log("AI Highlighting variables..."),alert(`Variable Analysis:

 Input Variables: 12 found
 Output Variables: 8 found
 Internal Variables: 15 found
 Safety Variables: 6 found

All variables are properly documented and follow naming conventions.`)},className:"bg-white border border-light p-3 rounded-full shadow-md hover:bg-accent-light transition-colors",title:"Highlight Variables",children:e.jsx(Pt,{className:"w-5 h-5 text-primary"})})]})}function Cd({suggestions:t=[],onClose:s}){return t.length?e.jsxs("div",{className:"bg-white border border-light rounded-md shadow-sm p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-primary font-medium",children:[e.jsx(ri,{className:"w-4 h-4 text-accent"}),"AI Suggestions"]}),s&&e.jsx("button",{onClick:s,className:"text-muted hover:text-primary transition-colors p-1",title:"Close AI Suggestions",children:e.jsx(Ie,{className:"w-4 h-4"})})]}),e.jsx("ul",{className:"space-y-1",children:t.map((r,a)=>e.jsx("li",{className:"px-3 py-1 rounded hover:bg-accent-light cursor-pointer text-sm",onClick:()=>{navigator.clipboard.writeText(r)},title:"Click to copy to clipboard",children:r},a))})]}):null}function Ad({isEnabled:t,onToggle:s,diffs:r,originalCode:a,modifiedCode:o,aiSummary:n,onReintegrate:i,onRevert:c}){const[m,u]=l.useState(!1);return e.jsxs("div",{className:"border border-light rounded-md bg-white shadow-sm",children:[e.jsx("div",{className:"p-3 border-b border-light",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:h=>s(h.target.checked),className:"accent-primary"}),e.jsx(po,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm font-medium text-primary",children:"Compare with Original"})]}),t&&r.length>0&&e.jsxs("span",{className:"text-xs text-accent bg-accent-light px-2 py-1 rounded",children:[r.length," change",r.length!==1?"s":""]})]})}),t&&e.jsx("div",{className:"p-3",children:r.length===0?e.jsxs("div",{className:"text-center text-muted text-sm py-4",children:[e.jsx(rr,{className:"w-5 h-5 mx-auto mb-2 text-green-500"}),"No changes detected"]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-3 p-2 bg-blue-50 rounded border border-blue-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(be,{className:"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-blue-800 text-xs",children:"AI Analysis:"}),e.jsx("div",{className:"text-blue-700 text-xs",children:n})]})]})}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsxs("button",{onClick:()=>u(!m),className:"text-xs bg-white border border-light px-3 py-1 rounded hover:bg-gray-50 transition-colors",children:[m?"Hide":"Show"," Diff View"]}),e.jsx("button",{onClick:i,className:"text-xs bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700 transition-colors",children:"Reintegrate into AI"}),e.jsxs("button",{onClick:c,className:"text-xs bg-gray-600 text-white px-3 py-1 rounded hover:bg-gray-700 transition-colors flex items-center gap-1",children:[e.jsx(us,{className:"w-3 h-3"}),"Undo Changes"]})]}),m&&e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-muted mb-2",children:"Original Code:"}),e.jsx("pre",{className:"bg-gray-100 p-3 rounded border h-40 overflow-auto font-mono",children:a})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-muted mb-2",children:"Modified Code:"}),e.jsx("pre",{className:"bg-green-50 p-3 rounded border h-40 overflow-auto font-mono",children:o})]})]}),e.jsx("div",{className:"space-y-1",children:r.map((h,f)=>e.jsxs("div",{className:`p-2 rounded text-xs ${h.type==="added"?"bg-green-50 border border-green-200":h.type==="removed"?"bg-red-50 border border-red-200":"bg-yellow-50 border border-yellow-200"}`,children:[e.jsxs("div",{className:"font-medium mb-1",children:["Line ",h.line,": ",h.type==="added"?"Added":h.type==="removed"?"Removed":"Changed"]}),h.type!=="added"&&e.jsxs("div",{className:"text-red-700",children:["- ",h.original]}),h.type!=="removed"&&e.jsxs("div",{className:"text-green-700",children:["+ ",h.modified]})]},f))})]})})]})}function Td({onSearch:t,onSelectResult:s,placeholder:r="Search routines, logic, variables..."}){const[a,o]=l.useState(""),[n,i]=l.useState([]),[c,m]=l.useState(!1),[u,h]=l.useState(-1),f=l.useRef(null),b=l.useRef(null),w=C=>{if(!C.trim()){i([]),m(!1);return}const k=[{id:"1",type:"routine",title:"Conveyor_2_Start",description:"Motor starter routine for conveyor 2",line:45,routine:"Main",preview:"IF Start_Button AND NOT E_Stop THEN Conveyor_2_Run := TRUE;",confidence:95},{id:"2",type:"block",title:"Overload Protection Logic",description:"Motor overload detection and response",line:78,routine:"Safety_Check",preview:"IF Motor_Current > Max_Current THEN Overload_Fault := TRUE;",confidence:87},{id:"3",type:"variable",title:"Conveyor_2_Status",description:"Boolean status indicator for conveyor 2",line:12,routine:"Main",preview:"VAR Conveyor_2_Status : BOOL := FALSE;",confidence:92}].filter(j=>j.title.toLowerCase().includes(C.toLowerCase())||j.description.toLowerCase().includes(C.toLowerCase())||j.preview.toLowerCase().includes(C.toLowerCase()));i(k),m(k.length>0),h(-1)},p=C=>{if(!(!c||n.length===0))switch(C.key){case"ArrowDown":C.preventDefault(),h(k=>Math.min(k+1,n.length-1));break;case"ArrowUp":C.preventDefault(),h(k=>Math.max(k-1,-1));break;case"Enter":C.preventDefault(),u>=0&&S(n[u]);break;case"Escape":m(!1),h(-1),f.current?.blur();break}},S=C=>{s(C),o(C.title),m(!1),h(-1)},N=C=>{switch(C){case"routine":return e.jsx(Me,{className:"w-4 h-4 text-blue-500"});case"block":return e.jsx(Je,{className:"w-4 h-4 text-green-500"});case"variable":return e.jsx(js,{className:"w-4 h-4 text-purple-500"});case"comment":return e.jsx(Nr,{className:"w-4 h-4 text-gray-500"});default:return e.jsx(Pt,{className:"w-4 h-4 text-gray-500"})}};return l.useEffect(()=>{const C=k=>{b.current&&!b.current.contains(k.target)&&m(!1)};return document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)},[]),e.jsxs("div",{ref:b,className:"relative w-full max-w-md",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Pt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted"}),e.jsx("input",{ref:f,type:"text",value:a,onChange:C=>{o(C.target.value),w(C.target.value)},onKeyDown:p,onFocus:()=>a.trim()&&m(n.length>0),placeholder:r,className:"w-full pl-10 pr-4 py-2 border border-light rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-accent focus:border-accent transition-all"})]}),c&&n.length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-light rounded-md shadow-lg z-50 max-h-64 overflow-y-auto",children:n.map((C,k)=>e.jsx("div",{onClick:()=>S(C),className:`p-3 cursor-pointer transition-colors ${k===u?"bg-accent-light":"hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[N(C.type),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium text-sm text-primary truncate",children:C.title}),e.jsxs("span",{className:"text-xs bg-gray-100 text-gray-600 px-1 rounded",children:[C.confidence,"%"]})]}),e.jsx("div",{className:"text-xs text-muted mb-1",children:C.description}),e.jsxs("div",{className:"text-xs text-muted",children:[e.jsx("span",{className:"font-mono",children:C.routine}),"  Line ",C.line]}),e.jsx("div",{className:"text-xs font-mono bg-gray-50 p-1 rounded mt-1 truncate",children:C.preview})]}),e.jsx("div",{className:"flex items-center",children:e.jsx(Nr,{className:"w-3 h-3 text-muted"})})]})},C.id))}),c&&a.trim()&&n.length===0&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-light rounded-md shadow-lg z-50 p-3",children:e.jsxs("div",{className:"text-center text-muted text-sm",children:[e.jsx(Pt,{className:"w-5 h-5 mx-auto mb-1 opacity-50"}),'No results found for "',a,'"']})})]})}const Pd="modulepreload",Ed=function(t){return"/"+t},Br={},Dd=function(s,r,a){let o=Promise.resolve();if(r&&r.length>0){let m=function(u){return Promise.all(u.map(h=>Promise.resolve(h).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),c=i?.nonce||i?.getAttribute("nonce");o=m(r.map(u=>{if(u=Ed(u),u in Br)return;Br[u]=!0;const h=u.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const b=document.createElement("link");if(b.rel=h?"stylesheet":Pd,h||(b.as="script"),b.crossOrigin="",b.href=u,c&&b.setAttribute("nonce",c),document.head.appendChild(b),h)return new Promise((w,p)=>{b.addEventListener("load",w),b.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${u}`)))})}))}function n(i){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=i,window.dispatchEvent(c),!c.defaultPrevented)throw i}return o.then(i=>{for(const c of i||[])c.status==="rejected"&&n(c.reason);return s().catch(n)})};function Od(t={}){const{autoConnect:s=!0,reconnectInterval:r=3e3,maxReconnectAttempts:a=5,debounceMs:o=500,onTagsUpdated:n,onError:i,onConnectionChange:c}=t,[m,u]=l.useState(!1),[h,f]=l.useState(!1),[b,w]=l.useState(null),[p,S]=l.useState(0),[N,C]=l.useState(null),[k,j]=l.useState(0),[v,x]=l.useState(!1),T=l.useRef(null),y=l.useRef(null),d=l.useRef(null),g=l.useCallback(()=>H.getToken(),[]),A=l.useCallback(()=>{const I=g();if(!I)throw new Error("No authentication token found");return`wss://pandaura-backend-production.up.railway.app/ws/tags?token=${encodeURIComponent(I)}`},[g]),O=l.useCallback(()=>window.location.origin,[]),D=l.useCallback(I=>T.current?.readyState===WebSocket.OPEN?(T.current.send(JSON.stringify(I)),!0):!1,[]),L=l.useCallback(I=>{try{console.log(" Received WebSocket message:",I.data);const Y=JSON.parse(I.data);switch(console.log(" Parsed message:",Y),Y.type){case"tags_updated":C(Date.now()),j(W=>Math.max(0,W-1)),n?.(Y);break;case"sync_queued":j(W=>W+1);break;case"error":w(Y.error||"Unknown error"),j(W=>Math.max(0,W-1)),i?.(Y.error||"Unknown error");break;case"pong":break}}catch(Y){console.error("Failed to parse WebSocket message:",Y),w("Failed to parse server response")}},[n,i]),U=l.useCallback(()=>{if(T.current?.readyState===WebSocket.OPEN||h||v){console.log(` Connection blocked: open=${T.current?.readyState===WebSocket.OPEN}, connecting=${h}, disabled=${v}`);return}if(p>=a){console.log(` Circuit breaker activated: ${p}/${a} attempts exhausted`),x(!0),w(`Connection failed after ${a} attempts. Please refresh the page.`);return}try{f(!0),w(null);const I=A(),Y=O();console.log(` Connecting to WebSocket: ${I}`),console.log(` Browser origin: ${Y}`),console.log(" Environment VITE_WS_BASE_URL: wss://pandaura-backend-production.up.railway.app");const W=new WebSocket(I);T.current=W,W.onopen=()=>{if(console.log(" TagSync WebSocket connected successfully!"),console.log(" WebSocket readyState:",W.readyState),console.log(" WebSocket URL:",W.url),u(!0),f(!1),S(0),w(null),c?.(!0),d.current&&T.current?.readyState===WebSocket.OPEN){console.log(` Re-subscribing to project: ${d.current}`);try{T.current.send(JSON.stringify({type:"subscribe",projectId:d.current})),console.log(" Subscription message sent successfully")}catch(oe){console.error(" Failed to send subscription message:",oe)}}},W.onmessage=L,W.onclose=oe=>{console.log(" TagSync WebSocket disconnected:",oe.code,oe.reason),u(!1),f(!1),c?.(!1),oe.code!==1e3&&p<a&&!h&&T.current===W?(console.log(` Scheduling reconnection attempt ${p+1}/${a} in ${r}ms`),S(xe=>xe+1),y.current=setTimeout(()=>{T.current===W&&!h&&(console.log(` Attempting reconnection ${p}/${a}`),U())},r*Math.pow(2,p))):console.log(` Not reconnecting: code=${oe.code}, attempts=${p}/${a}, connecting=${h}`)},W.onerror=oe=>{console.error(" TagSync WebSocket error:",oe),w("WebSocket connection error"),f(!1)}}catch(I){console.error("Failed to create WebSocket connection:",I),w(I instanceof Error?I.message:"Connection failed"),f(!1)}},[h,A,O,L,p,a,r,c]),M=l.useCallback(()=>{console.log(" Manually disconnecting WebSocket"),y.current&&(clearTimeout(y.current),y.current=null),T.current&&(T.current.close(1e3,"Client disconnect"),T.current=null),u(!1),f(!1),S(0),x(!1),d.current=null},[]),R=l.useCallback(()=>{console.log(" Resetting connection state"),M(),w(null),setTimeout(()=>{U()},1e3)},[M,U]),z=l.useCallback((I,Y,W)=>{D({type:"sync_tags",projectId:I,vendor:Y,stCode:W,debounceMs:o})||w("Not connected to sync service")},[D,o]),J=l.useCallback(I=>{d.current=I,D({type:"subscribe",projectId:I})||w("Not connected to sync service")},[D]),te=l.useCallback(()=>{d.current=null,D({type:"unsubscribe"})||w("Not connected to sync service")},[D]),ue=l.useCallback(()=>{D({type:"ping"})},[D]);return l.useEffect(()=>(s&&!v&&(console.log(" Auto-connecting to WebSocket..."),U()),()=>{M()}),[s,v]),l.useEffect(()=>{if(!m)return;const I=setInterval(()=>{ue()},3e4);return()=>clearInterval(I)},[m,ue]),{isConnected:m,isConnecting:h,lastError:b,connectionAttempts:p,syncTags:z,subscribe:J,unsubscribe:te,ping:ue,connect:U,disconnect:M,resetConnection:R,lastSyncTime:N,queuedSyncs:k,isDisabled:v}}const nn=l.createContext(void 0);function Ct({children:t}){const{projectId:s}=Mt(),[r,a]=l.useState(null),[o,n]=l.useState([]),[i,c]=l.useState(new Set),[m,u]=l.useState(new Set);l.useEffect(()=>{let j=null;if(s)j=s,localStorage.setItem("currentProjectId",j);else{const v=localStorage.getItem("currentProjectId");v&&(j=v)}a(j)},[s]);const w=Od({autoConnect:!1,debounceMs:500,onTagsUpdated:j=>{j.tags&&n(j.tags),i.forEach(v=>{try{v(j)}catch(x){console.error("Error in tag update callback:",x)}})},onError:j=>{console.error("TagSync error:",j)},onConnectionChange:j=>{console.log(`TagSync connection ${j?"established":"lost"}`)}});l.useEffect(()=>{r?(console.log(` ProjectSyncContext: Connecting to tag sync for project ID: ${r}`),console.log(` TagSync state: connected=${w.isConnected}, connecting=${w.isConnecting}`),setTimeout(()=>{w.connect(),setTimeout(()=>{w.subscribe(r)},100)},100)):(console.log(" ProjectSyncContext: Disconnecting from tag sync (no project ID)"),w.unsubscribe(),w.disconnect(),n([]))},[r]);const p=(j,v)=>{if(!r){console.warn("Cannot sync tags: no project ID available");return}w.syncTags(r,j,v)},S=l.useCallback(async()=>{if(!r)return console.warn("Cannot load tags: no project ID available"),[];if(m.has(r))return console.log(` Tags already loaded for project ${r}, returning cached tags`),o;try{console.log(` ProjectSyncContext: Loading existing tags for project ${r}`),console.log(" ProjectSyncContext: Current URL:",window.location.href);const j=`${it.apiBaseUrl}/api/v1/tags?projectId=${r}&pageSize=1000`;console.log(" ProjectSyncContext: Making API call to:",j);let v=null;try{const{authStorage:g}=await Dd(async()=>{const{authStorage:A}=await Promise.resolve().then(()=>Xl);return{authStorage:A}},void 0);v=g.getToken()}catch(g){console.error(" ProjectSyncContext: Failed to get token from cookies",g)}const x={"Content-Type":"application/json"};v&&(x.Authorization=`Bearer ${v}`);const T=await fetch(j,{headers:x,credentials:"include"});if(console.log(" ProjectSyncContext: API response status:",T.status),console.log(" ProjectSyncContext: API response ok:",T.ok),!T.ok){const g=await T.text();throw console.error(" ProjectSyncContext: API error response:",g),new Error(`Failed to load tags: ${T.statusText} - ${g}`)}const y=await T.json();console.log(" ProjectSyncContext: Raw API response data:",y);const d=y.tags||y||[];return console.log(" ProjectSyncContext: Extracted tags array:",d),console.log(` ProjectSyncContext: Loaded ${d.length} existing tags for project ${r}`),d.forEach((g,A)=>{console.log(` ProjectSyncContext: Tag ${A+1}:`,{id:g.id,name:g.name,scope:g.scope,data_type:g.data_type,address:g.address,project_id:g.project_id})}),n(d),u(g=>new Set(g).add(r)),d}catch(j){return console.error(" ProjectSyncContext: Error loading existing tags:",j),[]}},[r,m,o]),N=j=>{c(v=>new Set(v).add(j))},C=j=>{c(v=>{const x=new Set(v);return x.delete(j),x})},k={currentProjectId:r,isConnected:w.isConnected,isConnecting:w.isConnecting,lastError:w.lastError,lastSyncTime:w.lastSyncTime,queuedSyncs:w.queuedSyncs,syncTags:p,loadExistingTags:S,latestTags:o,onTagsUpdated:N,offTagsUpdated:C,connect:w.connect,disconnect:w.disconnect,connectionAttempts:w.connectionAttempts};return e.jsx(nn.Provider,{value:k,children:t})}function on(){return l.useContext(nn)||null}function ln(){const t=on();if(!t)return{isConnected:!1,isConnecting:!1,lastError:null,lastSyncTime:null,queuedSyncs:0,syncTags:()=>console.warn("useTagSyncOnly: Not connected to ProjectSyncProvider"),latestTags:[],onTagsUpdated:()=>{},offTagsUpdated:()=>{},connect:()=>console.warn("useTagSyncOnly: Not connected to ProjectSyncProvider"),disconnect:()=>console.warn("useTagSyncOnly: Not connected to ProjectSyncProvider"),connectionAttempts:0};const{isConnected:s,isConnecting:r,lastError:a,lastSyncTime:o,queuedSyncs:n,syncTags:i,latestTags:c,onTagsUpdated:m,offTagsUpdated:u,connect:h,disconnect:f,connectionAttempts:b}=t;return{isConnected:s,isConnecting:r,lastError:a,lastSyncTime:o,queuedSyncs:n,syncTags:i,latestTags:c,onTagsUpdated:m,offTagsUpdated:u,connect:h,disconnect:f,connectionAttempts:b}}function Ld({isOpen:t,onClose:s,onSave:r,isSaving:a}){const[o,n]=l.useState(""),i=()=>{o.trim()&&(r(o.trim()),n(""))},c=m=>{m.key==="Enter"&&m.ctrlKey&&i()};return e.jsx(De,{isOpen:t,onClose:s,title:"Save Version",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"version-message",className:"block text-sm font-medium text-gray-700 mb-2",children:"Version Message"}),e.jsx("textarea",{id:"version-message",value:o,onChange:m=>n(m.target.value),onKeyPress:c,placeholder:"Describe the changes in this version...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,disabled:a}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Press Ctrl+Enter to save quickly"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(F,{variant:"outline",onClick:s,disabled:a,children:"Cancel"}),e.jsx(F,{onClick:i,disabled:!o.trim()||a,icon:He,children:a?"Saving...":"Save Version"})]})]})})}function Rd({projectId:t,currentState:s,onVersionCreated:r,onRollback:a,className:o=""}){const[n,i]=l.useState(!1),[c,m]=l.useState(!1),[u,h]=l.useState(!1),{showToast:f}=Ge(),{versions:b,isLoading:w,createVersion:p,rollbackToVersion:S,canCreateVersion:N,lastVersionTime:C}=Bt({projectId:t,autoCreateVersions:!0}),k=async x=>{if(t){h(!0);try{const T=await p(x,s);console.log("Version created:",T),i(!1),r?.(T),f({variant:"success",title:"Version Saved Successfully!",message:`Version ${T} has been saved with message: "${x}"`,duration:4e3})}catch(T){console.error("Failed to create version:",T),f({variant:"error",title:"Save Failed",message:"Failed to save version. Please try again.",duration:4e3})}finally{h(!1)}}},j=async x=>{try{await S(x),a?.(x)}catch(T){console.error("Failed to rollback:",T),f({variant:"error",title:"Rollback Failed",message:"Failed to rollback to version. Please try again.",duration:5e3})}},v=()=>{if(!C)return"No versions yet";const T=new Date().getTime()-C.getTime(),y=Math.floor(T/(1e3*60)),d=Math.floor(y/60),g=Math.floor(d/24);return y<1?"Just now":y<60?`${y}m ago`:d<24?`${d}h ago`:`${g}d ago`};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`flex items-center gap-2 ${o}`,children:[e.jsx(F,{size:"sm",variant:"outline",icon:He,onClick:()=>i(!0),disabled:!N,title:N?"Save current state as a new version":"Please wait before creating another version",children:"Save Version"}),e.jsxs(F,{size:"sm",variant:"ghost",icon:ca,onClick:()=>m(!0),title:"View version history",children:["History (",b.length,")"]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[e.jsx(ft,{className:"w-3 h-3"}),e.jsxs("span",{children:["Last: ",v()]})]})]}),e.jsx(Ld,{isOpen:n,onClose:()=>i(!1),onSave:k,isSaving:u}),c&&e.jsx(De,{isOpen:c,onClose:()=>m(!1),title:"Version History",size:"lg",children:e.jsx("div",{className:"space-y-4",children:w?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Loading versions..."})]}):b.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ho,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No versions saved yet"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Create your first version to track changes"})]}):e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:b.map((x,T)=>e.jsx("div",{className:`p-3 border rounded-lg ${T===0?"border-blue-200 bg-blue-50":"border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:"font-medium",children:["Version ",x.version_number]}),T===0&&e.jsx("span",{className:"bg-blue-100 text-blue-700 text-xs px-2 py-0.5 rounded-full",children:"Current"}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${x.is_auto?"bg-gray-100 text-gray-600":"bg-green-100 text-green-600"}`,children:x.is_auto?"Auto":"Manual"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:new Date(x.snapshot_info.timestamp*1e3).toLocaleString()}),x.message&&e.jsx("p",{className:"text-sm text-gray-800",children:x.message})]}),T>0&&e.jsx(F,{size:"sm",variant:"outline",onClick:()=>{window.confirm(`Rollback to version ${x.version_number}?`)&&(j(x.version_number),m(!1))},children:"Rollback"})]})},x.id))})})})]})}function Md({projectId:t}){const[s,r]=l.useState(!1),[a,o]=l.useState(null),[n,i]=l.useState(null),c=async()=>{r(!0),i(null),o(null);try{console.log("Testing version history API for project:",t);const h=await ae.getVersionHistory(t);console.log("Version history result:",h),o(h)}catch(h){console.error("Version history error:",h),i(h.message||"Unknown error")}finally{r(!1)}},m=async()=>{r(!0),i(null),o(null);try{console.log("Testing create version API for project:",t);const h=await ae.createVersion(t,{state:{test:"debug version",timestamp:Date.now()},message:"Debug test version"});console.log("Create version result:",h),o({versionNumber:h})}catch(h){console.error("Create version error:",h),i(h.message||"Unknown error")}finally{r(!1)}},u=async()=>{r(!0),i(null),o(null);try{console.log("Testing auto-save API for project:",t),await ae.createAutoSaveVersion(t,{test:"debug auto-save",timestamp:Date.now()}),console.log("Auto-save completed successfully"),o({success:!0,message:"Auto-save completed"})}catch(h){console.error("Auto-save error:",h),i(h.message||"Unknown error")}finally{r(!1)}};return e.jsxs("div",{className:"p-4 border border-gray-300 rounded-lg bg-gray-50",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Version Control API Debug"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Project ID: ",t]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("button",{onClick:c,disabled:s,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 mr-2",children:"Test Get Version History"}),e.jsx("button",{onClick:m,disabled:s,className:"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 disabled:opacity-50 mr-2",children:"Test Create Version"}),e.jsx("button",{onClick:u,disabled:s,className:"px-4 py-2 bg-purple-500 text-white rounded hover:bg-purple-600 disabled:opacity-50",children:"Test Auto-Save"})]}),s&&e.jsx("div",{className:"text-blue-600",children:"Loading..."}),n&&e.jsxs("div",{className:"text-red-600 bg-red-50 p-3 rounded border",children:[e.jsx("strong",{children:"Error:"})," ",n]}),a&&e.jsxs("div",{className:"text-green-600 bg-green-50 p-3 rounded border",children:[e.jsx("strong",{children:"Result:"}),e.jsx("pre",{className:"mt-2 text-sm overflow-auto",children:JSON.stringify(a,null,2)})]})]})}function Fd(t){const s=t.data_type||t.type||"BOOL",r=t.description?` // ${t.description}`:"",a=t.default_value?` := ${t.default_value}`:"";return`  ${t.name} : ${s}${a};${r}`}function $s(t){if(t.length===0)return`PROGRAM Main
    VAR
        // Add your variables here
    END_VAR

    // Add your logic here

END_PROGRAM`;const s=t.reduce((o,n)=>{const i=n.scope||"Local";return o[i]||(o[i]=[]),o[i].push(n),o},{});return`PROGRAM Main
${Object.entries(s).map(([o,n])=>{const i=o==="Local"?"VAR":`VAR_${o.toUpperCase()}`,c=n.sort((m,u)=>m.name.localeCompare(u.name)).map(m=>Fd(m)).join(`
`);return`    ${i}
${c}
    END_VAR`}).join(`

`)}

    // Add your logic here

END_PROGRAM`}const qr=["Rockwell","Siemens","Beckhoff"];function Vs({sessionMode:t=!1}){l.useEffect(()=>{try{Object.keys(localStorage).filter(ce=>ce.includes("LogicStudio")||ce.includes("moduleState")).forEach(ce=>{const pe=localStorage.getItem(ce);pe&&(pe.includes("from_model")||pe.includes("second_one")||pe.includes("test_debug"))&&(console.log(" Clearing localStorage key with unwanted content:",ce),localStorage.removeItem(ce))})}catch(_){console.warn("Error during localStorage cleanup:",_)}},[]);const{getModuleState:s,saveModuleState:r}=dr(),{isConnected:a,isConnecting:o,lastError:n,lastSyncTime:i,queuedSyncs:c,syncTags:m,connectionAttempts:u}=ln(),h=on(),f=h?.currentProjectId||null,b=h?.loadExistingTags||(()=>Promise.resolve([])),w=h?.latestTags||[];l.useEffect(()=>{console.log(` LogicStudio: Connection state changed - connected: ${a}, connecting: ${o}, error: ${n}`),console.log(` LogicStudio: Project ID: ${f}`)},[a,o,n,f]);const p=l.useRef(null);l.useEffect(()=>{f&&a&&p.current!==f&&(console.log(` Loading existing tags for project ${f}`),console.log(" Current URL:",window.location.href),p.current=f,b().then(_=>{if(console.log(" Raw tags loaded from API:",_),console.log(" Number of tags loaded:",_.length),_.length>0){console.log(` Found ${_.length} existing tags:`,_),console.log(" Tag details:"),_.forEach((ce,pe)=>{console.log(`   Tag ${pe+1}: name="${ce.name}", scope="${ce.scope}", data_type="${ce.data_type}", address="${ce.address}"`)});const ee=$s(_);console.log(" Generated ST code from existing tags:",ee),console.log(" Current editor code:",x.substring(0,100)+"..."),console.log(" Editor code length:",x.length),T(ee),Ae.current=ee,console.log(` Populated editor with ${_.length} existing tags`)}else{console.log(` No existing tags found for project ${f}`),console.log(" Setting editor to empty");const ee="";T(ee),Ae.current=ee,console.log(" Set editor to empty content")}}).catch(_=>{console.error("Failed to load existing tags:",_),p.current=null}))},[f,a,b]);const S=s("LogicStudio"),N=["from_model","second_one","test_debug"];S.editorCode&&N.some(_=>S.editorCode.includes(_))&&(console.log(" Clearing saved editor state with unwanted template variables"),S.editorCode="");const[k,j]=l.useState(S.prompt||""),v="",[x,T]=l.useState(S.editorCode||v),[y,d]=l.useState(S.vendor),[g,A]=l.useState(!1),[O,D]=l.useState(S.showPendingChanges||!1),[L,U]=l.useState(S.showAISuggestions!==void 0?S.showAISuggestions:!0),[M,R]=l.useState(S.vendorContextEnabled||!1),[z,J]=l.useState(S.isCollapsed||!1),[te,ue]=l.useState(!1),[I,Y]=l.useState(S.collapseLevel||0),W=l.useRef(null);l.useRef(null);const oe=l.useRef(null),xe=[{line:15,original:"MotorStart := TRUE;",modified:"MotorStart := Start_Button AND NOT E_Stop;",type:"changed"},{line:23,original:"",modified:"// Added safety interlock for conveyor",type:"added"}],G=l.useCallback(async _=>{try{console.log(" DEBUG: Full code being parsed:",_);const ee=["from_model","second_one","test_debug"];if(ee.some(B=>_.includes(B))){console.log(" BLOCKED: Code contains unwanted template variables, skipping sync"),console.log(" Unwanted variables detected:",ee.filter(B=>_.includes(B)));return}const pe=/^\s*(\w+)\s*:\s*(\w+)(?:\s*:=\s*[^;]+)?;/gm,Se=[..._.matchAll(pe)],Ye=Se.map(B=>B[1]);console.log(" DEBUG: Regex matches found:",Se.map(B=>({fullMatch:B[0],variableName:B[1],dataType:B[2]}))),console.log(" DEBUG: Extracted variable names:",Ye);const se=w.map(B=>B.name),ie=Ye.filter(B=>!se.includes(B));if(console.log(" DEBUG: Existing tag names:",se),console.log(" DEBUG: New variables detected:",ie),ie.length===0){console.log(" Skipping sync - no new variables found in code");return}ie.length>0&&(console.log(` Found ${ie.length} new variables: ${ie.join(", ")}`),console.log(" Syncing with project vendor (no manual selection needed)")),console.log(` Syncing tags with project vendor for project ${f}`),m(y.toLowerCase(),_)}catch(ee){console.error("Error in tag sync:",ee),m(y.toLowerCase(),_)}},[y,m,w,f]),X=f?parseInt(f):null,{updateProjectState:ze,isSaving:Ht,lastSaved:Ts,saveError:Gt,hasUnsavedChanges:Wt,saveNow:jt}=Xa(X||0,{module:"LogicStudio",prompt:k,editorCode:x,vendor:y,showPendingChanges:O,showAISuggestions:L,vendorContextEnabled:M,isCollapsed:z,collapseLevel:I,lastActivity:new Date().toISOString()});Wa(Wt&&!t,jt),l.useEffect(()=>{!t&&X&&ze({module:"LogicStudio",prompt:k,editorCode:x,vendor:y,showPendingChanges:O,showAISuggestions:L,vendorContextEnabled:M,isCollapsed:z,collapseLevel:I,lastActivity:new Date().toISOString()})},[t,X,ze,k,x,y,O,L,M,z,I]);const{getVersionData:We}=Bt({projectId:X||0,autoCreateVersions:!1});l.useEffect(()=>{const _=async ce=>{const pe=ce,{projectId:Se,targetVersion:Ye,rolledBackTo:se}=pe.detail;if(Se===X&&X){console.log("Logic Studio: Handling enhanced rollback to version",se);try{const ie=await ae.getVersionSnapshot(X,se);if(ie&&ie.autosaveState){const B=ie.autosaveState;B.module==="LogicStudio"&&(j(B.prompt||""),T(B.editorCode||""),d(B.vendor||"siemens"),D(B.showPendingChanges||!1),U(B.showAISuggestions||!1),R(B.vendorContextEnabled||!1),J(B.isCollapsed||!1),Y(B.collapseLevel||0),console.log("Logic Studio state restored from enhanced version snapshot",se))}if(ie&&ie.moduleStates&&ie.moduleStates.LogicStudio){const B=ie.moduleStates.LogicStudio;j(B.prompt||""),T(B.editorCode||""),d(B.vendor||"siemens"),D(B.showPendingChanges||!1),U(B.showAISuggestions||!1),R(B.vendorContextEnabled||!1),J(B.isCollapsed||!1),Y(B.collapseLevel||0),console.log("Logic Studio state restored from module-specific state in version",se)}}catch(ie){console.error("Failed to restore Logic Studio state from enhanced version:",ie);try{const B=await We(se);B&&B.module==="LogicStudio"&&(j(B.prompt||""),T(B.editorCode||""),d(B.vendor||"siemens"),D(B.showPendingChanges||!1),U(B.showAISuggestions||!1),R(B.vendorContextEnabled||!1),J(B.isCollapsed||!1),Y(B.collapseLevel||0),console.log("Logic Studio state restored using legacy method"))}catch(B){console.error("Legacy restore method also failed:",B)}}}},ee=ce=>{const pe=ce,{projectId:Se,action:Ye}=pe.detail;Se===X&&Ye==="rollback"&&(console.log("Logic Studio: Project state changed due to rollback, refreshing..."),window.location.reload())};return window.addEventListener("pandaura:project-rollback",_),window.addEventListener("pandaura:project-state-changed",ee),()=>{window.removeEventListener("pandaura:project-rollback",_),window.removeEventListener("pandaura:project-state-changed",ee)}},[X,We]),l.useEffect(()=>{const _=async ee=>{const ce=ee,{projectId:pe,action:Se,tags:Ye}=ce.detail;if(pe===f){console.log(` Logic Studio: Received tag update for project ${pe}, action: ${Se}`);try{const se=await b();if(se&&se.length>0){console.log(` Logic Studio: Regenerating editor with ${se.length} tags after manual update`);const ie=$s(se);ie!==x&&(T(ie),Ae.current=ie)}else(Se==="delete_all"||Se==="delete"&&!se.length)&&(console.log(" Logic Studio: All tags deleted, resetting to empty"),T(""),Ae.current="")}catch(se){console.error("Failed to update Logic Studio after tag changes:",se)}}};return window.addEventListener("pandaura:tags-updated",_),()=>{window.removeEventListener("pandaura:tags-updated",_)}},[f,b,x,v]);const Yt=l.useCallback((()=>{let _;return()=>{t&&(clearTimeout(_),_=setTimeout(()=>{r("LogicStudio",{prompt:k,editorCode:x,vendor:y,showPendingChanges:O,showAISuggestions:L,vendorContextEnabled:M,isCollapsed:z,collapseLevel:I})},1e3))}})(),[t,r,k,x,y,O,L,M,z,I]),Ae=l.useRef(""),Xt=l.useCallback((()=>{let _;return()=>{!t&&a&&x.trim()&&(x!==Ae.current?(clearTimeout(_),_=setTimeout(()=>{if(console.log(" Syncing tags from Logic Studio - code changed"),console.log(" Previous code length:",Ae.current.length),console.log(" New code length:",x.length),!x.replace(/\/\/.*$/gm,"").replace(/\/\*[\s\S]*?\*\//g,"").trim()){console.log(" Skipping sync - editor is empty or contains only comments"),Ae.current=x;return}console.log(" Code contains actual content, proceeding with sync"),Ae.current=x,G(x)},1500)):console.log(" Skipping tag sync - code unchanged"))}})(),[t,a,x,y,m]);l.useEffect(()=>{Yt()},[Yt]),l.useEffect(()=>{console.log(" Editor code changed, triggering debounced sync..."),console.log(` Current code length: ${x.length}`),console.log(` Session mode: ${t}, Connected: ${a}`),Xt()},[x,Xt]),l.useEffect(()=>{const _=ee=>{W.current&&!W.current.contains(ee.target)&&A(!1),oe.current&&!oe.current.contains(ee.target)&&ue(!1)};return document.addEventListener("mousedown",_),()=>document.removeEventListener("mousedown",_)},[]);const Ps=l.useCallback(()=>{console.log("Generate Logic functionality disabled"),alert("Generate Logic functionality has been disabled to prevent unwanted tag creation.")},[]),Jt=l.useCallback(_=>{_.key==="Enter"&&!_.shiftKey&&(_.preventDefault(),Ps())},[Ps]);return e.jsxs("div",{className:"flex flex-col h-full bg-background text-primary",children:[e.jsxs("header",{className:"flex items-center justify-between bg-surface px-6 py-4 border-b border-light shadow",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h1",{className:"text-xl font-bold text-primary",children:"Logic Studio"}),!t&&e.jsx("div",{className:"flex items-center gap-2",children:o?e.jsxs("div",{className:"flex items-center gap-1 text-yellow-600",children:[e.jsx(ft,{className:"w-4 h-4 animate-pulse"}),e.jsx("span",{className:"text-xs",children:"Connecting..."})]}):a?e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(ga,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Live Sync"}),c>0&&e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs px-1 rounded",children:c})]}):e.jsxs("div",{className:"flex items-center gap-1 text-red-600",children:[e.jsx(pa,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Offline"}),u>0&&e.jsxs("span",{className:"text-xs",children:["(",u,")"]})]})}),!t&&X&&e.jsx(Ja,{isSaving:Ht,lastSaved:Ts,saveError:Gt,hasUnsavedChanges:Wt,onManualSave:jt,className:"text-xs"}),!t&&X&&e.jsx(Rd,{projectId:X,currentState:{module:"LogicStudio",prompt:k,editorCode:x,vendor:y,showPendingChanges:O,showAISuggestions:L,vendorContextEnabled:M,isCollapsed:z,collapseLevel:I,lastActivity:new Date().toISOString()},onVersionCreated:_=>{console.log("Version created in Logic Studio:",_)},onRollback:_=>{console.log("Rollback completed in Logic Studio:",_)},className:"border-l border-gray-200 pl-3"}),!t&&e.jsx("button",{onClick:()=>{console.log(" Refreshing tags from database..."),b().then(_=>{if(_.length>0){const ee=$s(_);T(ee),Ae.current=ee,console.log(` Refreshed editor with ${_.length} tags`)}else T(""),Ae.current="",console.log(" No tags found, set empty content")}).catch(_=>{console.error("Failed to refresh tags:",_)})},className:"bg-white border border-light px-2 py-2 rounded-md text-sm hover:bg-accent-light transition-colors cursor-pointer",title:"Refresh tags from database",children:e.jsx(Ne,{className:"w-4 h-4"})}),e.jsxs("div",{className:"relative",ref:oe,children:[e.jsxs("button",{onClick:()=>ue(!te),className:"flex items-center gap-2 px-3 py-1.5 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors text-sm text-gray-600",title:"Collapse Interface",children:[e.jsx(nr,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Layout"}),z?e.jsx(gt,{className:"w-3 h-3"}):e.jsx(fs,{className:"w-3 h-3"})]}),te&&e.jsxs("div",{className:"absolute top-full left-0 mt-2 bg-white border border-light rounded-lg shadow-lg p-4 z-20 w-64",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h4",{className:"text-sm font-medium text-primary mb-2",children:"Interface Layout"}),e.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"Adjust the interface to your workflow needs"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx("input",{type:"radio",name:"layout",checked:I===0,onChange:()=>{Y(0),J(!1)},className:"mr-2"}),"Full Interface"]}),e.jsx("p",{className:"text-xs text-gray-500 ml-6",children:"All panels and features visible"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx("input",{type:"radio",name:"layout",checked:I===1,onChange:()=>{Y(1),J(!0)},className:"mr-2"}),"Compact"]}),e.jsx("p",{className:"text-xs text-gray-500 ml-6",children:"Hide side panels, keep core features"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx("input",{type:"radio",name:"layout",checked:I===2,onChange:()=>{Y(2),J(!0)},className:"mr-2"}),"Minimal"]}),e.jsx("p",{className:"text-xs text-gray-500 ml-6",children:"Editor-focused, minimal UI"})]})]}),e.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200",children:e.jsx("button",{onClick:()=>ue(!1),className:"text-xs bg-primary text-white px-3 py-1 rounded hover:bg-secondary transition-colors",children:"Apply Layout"})})]})]})]}),e.jsx("div",{className:"text-sm text-secondary",children:"Project: Motor_Auto.ap14"})]}),e.jsxs("main",{className:`flex-1 flex flex-col ${I===2?"gap-3 p-3":"gap-6 p-6"} will-change-scroll`,style:{scrollBehavior:"smooth"},children:[I<2&&e.jsx("div",{className:"flex justify-end",children:e.jsx(Td,{onSearch:_=>(console.log("Searching for:",_),[]),onSelectResult:_=>{console.log("Selected result:",_)}})}),e.jsx("div",{className:"flex-1 min-h-[400px]",children:e.jsx("div",{className:"h-full border border-light rounded-md overflow-hidden shadow-sm",children:e.jsx(Sd,{initialCode:x,vendorType:y,onChange:_=>T(_)})})}),I===0&&e.jsx(Ad,{isEnabled:O,onToggle:D,diffs:xe,originalCode:"PROGRAM Main\\n  VAR\\n    MotorStart : BOOL;\\n  END_VAR\\n  MotorStart := TRUE;\\nEND_PROGRAM",modifiedCode:"PROGRAM Main\\n  VAR\\n    MotorStart : BOOL;\\n  END_VAR\\n  // Added safety interlock for conveyor\\n  MotorStart := Start_Button AND NOT E_Stop;\\nEND_PROGRAM",aiSummary:"User added safety interlock logic and documentation. Changes improve safety compliance by checking emergency stop conditions.",onReintegrate:()=>console.log("Reintegrating changes with AI..."),onRevert:()=>{console.log("Reverting changes..."),D(!1)}}),e.jsxs("div",{className:`bg-white border border-light rounded-lg shadow-sm ${I===2?"p-2":"p-4"}`,children:[e.jsxs("div",{className:`flex ${I===2?"gap-2":"gap-3"} items-end`,children:[e.jsx("textarea",{className:`flex-1 border border-light rounded-md px-4 py-3 bg-surface shadow-sm text-sm text-primary placeholder-muted resize-none focus:outline-none focus:ring-2 focus:ring-accent focus:border-accent transition-all ${I===2?"min-h-[40px] max-h-[80px]":"min-h-[60px] max-h-[120px]"}`,placeholder:I===2?"Describe logic...":"Describe your logic requirements in natural language...",value:k,onChange:_=>j(_.target.value),onKeyPress:Jt}),I<2?e.jsxs("div",{className:"relative",ref:W,children:[e.jsxs("button",{onClick:()=>A(!g),className:"flex items-center gap-2 border border-light bg-white px-4 py-3 rounded-md shadow-sm text-sm text-primary hover:bg-accent-light transition-all min-h-[60px] whitespace-nowrap",children:["Vendor: ",y,e.jsx(et,{className:"w-4 h-4"})]}),g&&e.jsx("div",{className:"absolute bottom-full mb-1 w-48 bg-surface border border-light rounded-md shadow-lg z-10",children:qr.map(_=>e.jsx("div",{onClick:()=>{d(_),A(!1)},className:"px-4 py-2 text-sm hover:bg-accent-light cursor-pointer",children:_},_))})]}):e.jsx("select",{value:y,onChange:_=>d(_.target.value),className:"border border-light bg-white px-3 py-2 rounded-md shadow-sm text-sm text-primary min-h-[40px]",children:qr.map(_=>e.jsx("option",{value:_,children:_},_))}),I<2&&e.jsx("button",{onClick:()=>{console.log(`Exporting logic to ${y} format`),alert(` Exporting logic to ${y} format...

Your structured text will be downloaded shortly in ${y}-compatible format.`)},className:"bg-primary text-white px-4 py-3 rounded-md shadow-sm text-sm hover:bg-secondary transition-all min-h-[60px] whitespace-nowrap",title:"Export current logic to vendor-specific format",children:" Export Logic"}),e.jsx("button",{onClick:()=>{console.log("Opening document uploader...")},className:`border border-light bg-white rounded-md shadow-sm hover:bg-accent-light transition-all text-sm ${I===2?"p-2 min-h-[40px]":"p-3 min-h-[60px]"}`,title:"Upload any project documents to improve logic accuracy.",children:e.jsx(ia,{className:`text-primary ${I===2?"w-4 h-4":"w-5 h-5"}`})}),e.jsx("button",{onClick:()=>alert("Generate Logic functionality is disabled to prevent unwanted tag creation."),className:`bg-gray-400 text-white rounded-md shadow-sm text-sm cursor-not-allowed ${I===2?"px-4 py-2 min-h-[40px]":"px-6 py-3 min-h-[60px]"}`,disabled:!0,children:I===2?"Generate (Disabled)":"Generate Logic (Disabled)"})]}),I<2&&e.jsx("div",{className:"text-xs text-muted text-center mt-3",children:" Define Prompt   Upload Docs   Choose Vendor   Review/Edit Logic"})]}),L&&I===0&&e.jsx(Cd,{suggestions:["IF Safety_OK AND Start_Button THEN","Conveyor_Speed := Target_Speed;","Motor_Fault := Overload OR Overcurrent;"],onClose:()=>U(!1)}),I<2&&e.jsxs("div",{className:"bg-white border border-light rounded-md p-3",children:[e.jsx("h3",{className:"text-sm font-medium text-primary mb-3",children:"Quick Actions"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[I===0&&e.jsxs("button",{onClick:()=>D(!O),className:"text-xs bg-gray-50 hover:bg-gray-100 px-3 py-2 rounded transition-colors",children:[O?" Hide":" Show"," Pending Changes"]}),!L&&I===0&&e.jsx("button",{onClick:()=>U(!0),className:"text-xs bg-gray-50 hover:bg-gray-100 px-3 py-2 rounded transition-colors",children:" Show AI Suggestions"}),I===1&&e.jsx("button",{onClick:()=>{Y(0),J(!1)},className:"text-xs bg-blue-50 hover:bg-blue-100 text-blue-700 px-3 py-2 rounded transition-colors",children:" Show All Features"})]})]})]}),I<2&&e.jsx(kd,{}),!t&&X&&e.jsx("div",{className:"mt-4",children:e.jsx(Md,{projectId:X})})]})}function Us({sessionMode:t=!1}){const[s,r]=l.useState("logic-studio"),[a,o]=l.useState(!1),[n,i]=l.useState([]),[c,m]=l.useState(null),[u,h]=l.useState(!1),[f,b]=l.useState({companyName:"",projectName:"",projectId:"",contactName:"",contactEmail:"",siteAddress:"",deliveryDate:"",integratorCompany:"Pandaura Automation Systems"}),[w,p]=l.useState([{id:"functional-desc",title:"Functional Description",description:"Comprehensive system operation description",status:"ready",source:"Logic Studio ST Code",formats:["DOCX","PDF","TXT"],selected:!1},{id:"sequence-ops",title:"Sequence of Operations",description:"Step-by-step operational procedures",status:"ready",source:"Logic Studio ST Code",formats:["DOCX","PDF"],selected:!1},{id:"tag-database",title:"Tag Database",description:"Complete I/O and variable listing",status:"ready",source:"Tag Database Manager",formats:["XLSX","CSV"],selected:!1},{id:"io-map",title:"I/O Map",description:"Physical input/output assignments",status:"ready",source:"Logic Studio Analysis",formats:["XLSX","PDF"],selected:!1},{id:"logic-summary",title:"Logic Summary Report",description:"High-level logic overview and statistics",status:"ready",source:"Logic Studio ST Code",formats:["DOCX","PDF"],selected:!1},{id:"hmi-tags",title:"HMI Tag List",description:"Human Machine Interface tag definitions",status:"pending",source:"Auto-detected from Logic",formats:["XLSX","CSV"],selected:!1},{id:"alarm-list",title:"Alarm List",description:"System alarm definitions and responses",status:"ready",source:"Logic Studio Analysis",formats:["XLSX","DOCX"],selected:!1},{id:"revision-history",title:"Revision History / Change Log",description:"Project version control and modifications",status:"ready",source:"Auto-generated",formats:["DOCX","PDF"],selected:!1}]),S=y=>{r(y),o(y==="import")},N=y=>{if(!y)return;const d=Array.from(y).map(g=>({name:g.name,tag:C(g.name),status:"pending",type:k(g.name)}));i(g=>[...g,...d]),setTimeout(()=>{i(g=>g.map(A=>d.some(O=>O.name===A.name)?{...A,status:"analyzed"}:A))},2e3)},C=y=>{const d=y.toLowerCase();return d.includes(".st")||d.includes(".acd")||d.includes(".s7p")?"[Logic]":d.includes(".xlsx")||d.includes(".csv")?"[I/O List]":d.includes(".docx")||d.includes(".pdf")?"[Functional Spec]":"[Document]"},k=y=>{const d=y.toLowerCase();return d.includes(".st")||d.includes(".acd")||d.includes(".s7p")?"logic":d.includes(".xlsx")||d.includes(".csv")?"io":d.includes(".docx")||d.includes(".pdf")?"spec":"doc"},j=y=>{p(d=>d.map(g=>g.id===y?{...g,selected:!g.selected}:g))},v=()=>{const y=w.every(d=>d.selected);p(d=>d.map(g=>({...g,selected:!y})))},x=()=>{const y=w.filter(d=>d.selected);if(y.length===0){alert("Please select documents to export");return}console.log("Exporting documents:",y.map(d=>d.title)),alert(`Generating ${y.length} document(s)...
Download will begin shortly.`)},T=c?w.find(y=>y.id===c):null;return e.jsxs("div",{className:"flex flex-col h-full bg-background",children:[e.jsx("header",{className:"bg-white border-b border-light px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-primary",children:"AutoDocs"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"relative",children:e.jsxs("select",{value:s,onChange:y=>S(y.target.value),className:"border border-light rounded px-4 py-2 text-sm bg-white focus:outline-none focus:ring-2 focus:ring-accent",children:[e.jsx("option",{value:"logic-studio",children:"Use Logic from Logic Studio"}),e.jsx("option",{value:"import",children:"Import Logic / Docs"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:v,className:"text-sm text-muted hover:text-primary px-3 py-2",children:w.every(y=>y.selected)?"Deselect All":"Select All"}),e.jsxs("button",{onClick:x,className:"bg-primary text-white px-4 py-2 rounded text-sm hover:bg-secondary transition-colors flex items-center gap-2",children:[e.jsx(Ze,{className:"w-4 h-4"}),"Export Selected"]})]})]})]})}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"flex-1 p-6 overflow-y-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>h(!u),className:"flex items-center gap-2 w-full p-3 bg-white border border-light rounded-md hover:bg-gray-50 transition-colors",children:[u?e.jsx(zo,{className:"w-4 h-4"}):e.jsx(pt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Add Client Information (Optional)"})]}),u&&e.jsx("div",{className:"mt-3 p-4 bg-white border border-light rounded-md",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-muted mb-1",children:["Client Company Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:f.companyName,onChange:y=>b(d=>({...d,companyName:y.target.value})),className:"w-full border border-light rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-accent",placeholder:"e.g., Acme Manufacturing"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-muted mb-1",children:["Project Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:f.projectName,onChange:y=>b(d=>({...d,projectName:y.target.value})),className:"w-full border border-light rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-accent",placeholder:"e.g., Batch Mixing Control System"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-muted mb-1",children:"Project ID / Reference"}),e.jsx("input",{type:"text",value:f.projectId,onChange:y=>b(d=>({...d,projectId:y.target.value})),className:"w-full border border-light rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-accent",placeholder:"e.g., PRJ-2025-001"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-muted mb-1",children:["Date of Delivery ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",value:f.deliveryDate,onChange:y=>b(d=>({...d,deliveryDate:y.target.value})),className:"w-full border border-light rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-accent"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-muted mb-1",children:"Site Address / Location"}),e.jsx("textarea",{value:f.siteAddress,onChange:y=>b(d=>({...d,siteAddress:y.target.value})),className:"w-full border border-light rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-accent",rows:2,placeholder:"Installation site address..."})]})]})})]}),a&&e.jsxs("div",{className:"mb-6 p-4 bg-white border border-light rounded-md",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Smart Upload Panel"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center mb-4",children:[e.jsx(_t,{className:"w-8 h-8 text-muted mx-auto mb-2"}),e.jsxs("p",{className:"text-sm text-muted mb-2",children:["Drag & drop files here or"," ",e.jsx("button",{className:"text-accent hover:underline",children:"browse files"})]}),e.jsx("p",{className:"text-xs text-muted",children:"Supported: .ACD, .S7P, .XML, .ST, .TXT, .DOCX, .PDF, .XLSX, .CSV"}),e.jsx("input",{type:"file",multiple:!0,onChange:y=>N(y.target.files),className:"hidden",accept:".acd,.s7p,.xml,.st,.txt,.docx,.pdf,.xlsx,.csv"})]}),n.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Uploaded Files:"}),n.map((y,d)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm",children:y.name}),e.jsx("span",{className:"text-xs bg-accent-light text-accent px-2 py-1 rounded",children:y.tag}),e.jsx("span",{className:`text-xs px-2 py-1 rounded ${y.status==="analyzed"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:y.status==="analyzed"?"Analyzed":"Pending"})]}),e.jsx("button",{onClick:()=>i(g=>g.filter((A,O)=>O!==d)),className:"text-muted hover:text-red-500",children:e.jsx(Ie,{className:"w-4 h-4"})})]},d))]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:w.map(y=>e.jsxs("div",{className:`p-4 bg-white border rounded-md cursor-pointer transition-all ${y.selected?"border-accent bg-accent-light":"border-light hover:border-gray-300"}`,onClick:()=>j(y.id),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:y.selected,onChange:()=>{},className:"accent-primary"}),e.jsx("h3",{className:"font-medium text-sm",children:y.title})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("button",{onClick:d=>{d.stopPropagation(),m(c===y.id?null:y.id)},className:"text-muted hover:text-primary",title:"Preview",children:e.jsx(xt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:d=>{d.stopPropagation(),console.log(`Generating ${y.title}...`),alert(`Generating ${y.title}...
This will create the document using current project data.`)},className:"text-accent hover:text-purple-600",title:"Generate",children:e.jsx(js,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:`flex items-center gap-1 text-xs ${y.status==="ready"?"text-green-600":"text-yellow-600"}`,children:[y.status==="ready"?e.jsx(rr,{className:"w-3 h-3"}):e.jsx(nr,{className:"w-3 h-3"}),y.status==="ready"?"Ready to Generate":"Pending Input"]}),e.jsxs("div",{className:"text-xs text-muted",children:["Generated from: ",y.source]}),e.jsxs("div",{className:"text-xs text-muted",children:["Format: ",y.formats.join(", ")]})]}),e.jsxs("button",{onClick:d=>{d.stopPropagation(),console.log(`Exporting ${y.title}`),alert(`Generating ${y.title}...`)},className:"mt-3 w-full bg-gray-100 hover:bg-gray-200 text-primary px-3 py-1 rounded text-xs transition-colors flex items-center justify-center gap-1",children:[e.jsx(Ze,{className:"w-3 h-3"}),"Export"]})]},y.id))})]}),c&&T&&e.jsxs("div",{className:"w-2/5 bg-white border-l border-light p-6 overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:T.title}),e.jsxs("p",{className:"text-sm text-muted",children:["Source: ",T.source]})]}),e.jsx("button",{onClick:()=>m(null),className:"text-muted hover:text-primary",children:e.jsx(Ie,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"mb-4 p-4 bg-gray-50 rounded border text-sm",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Document Preview:"}),e.jsxs("div",{className:"space-y-2 text-xs font-mono",children:[e.jsx("div",{children:"1. SYSTEM OVERVIEW"}),e.jsxs("div",{className:"ml-4",children:["1.1 Project: ",f.projectName||"Motor Control System"]}),e.jsxs("div",{className:"ml-4",children:["1.2 Client: ",f.companyName||"Industrial Client"]}),e.jsxs("div",{className:"ml-4",children:["1.3 Delivery Date: ",f.deliveryDate||"TBD"]}),e.jsx("div",{children:"2. FUNCTIONAL DESCRIPTION"}),e.jsx("div",{className:"ml-4",children:"2.1 The system controls motor operation with safety interlocks..."}),e.jsx("div",{className:"ml-4",children:"2.2 Emergency stop functionality provides immediate shutdown..."}),e.jsx("div",{children:"3. SEQUENCE OF OPERATIONS"}),e.jsx("div",{className:"ml-4",children:"3.1 System startup sequence..."}),e.jsxs("div",{className:"text-muted",children:["... (continues for ",Math.floor(Math.random()*20)+10," pages)"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{className:"w-full bg-accent text-white px-4 py-2 rounded text-sm hover:bg-purple-600 transition-colors",children:"Regenerate with AI Edits"}),e.jsx("div",{className:"relative",children:e.jsxs("select",{className:"w-full border border-light rounded px-4 py-2 text-sm bg-white focus:outline-none focus:ring-2 focus:ring-accent",children:[e.jsx("option",{children:"Export as..."}),T.formats.map(y=>e.jsx("option",{value:y,children:y},y))]})}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",className:"accent-primary"}),"Include in ZIP Export"]})]})]})]})]})}function Be(t){const s=t.headers.get("Content-Disposition");if(s){const r=s.match(/filename="([^"]+)"/);if(r)return r[1];const a=s.match(/filename=([^;]+)/);if(a)return a[1].trim()}return"export.csv"}function Id(t,s){const r=window.URL.createObjectURL(t),a=document.createElement("a");a.href=r,a.download=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(r)}cr();const Z=`${it.apiBaseUrl}/api/v1`;console.log(" TagsAPI initialized with base URL:",Z);function de(){const t=H.getToken();return{"Content-Type":"application/json",Authorization:t?`Bearer ${t}`:""}}class ne{static async getTags(s={}){const r=new URLSearchParams;Object.entries(s).forEach(([c,m])=>{m!=null&&m!==""&&r.append(c,m.toString())});const a=r.toString(),o=`${Z}/tags${a?`?${a}`:""}`,n=await fetch(o,{headers:de()});if(!n.ok){const c=await n.json().catch(()=>({error:"Network error"}));throw new Error(c.error||"Failed to fetch tags")}const i=await n.json();return{success:!0,data:{tags:Array.isArray(i)?i:[],pagination:{page:1,pageSize:Array.isArray(i)?i.length:0,total:Array.isArray(i)?i.length:0,totalPages:1}}}}static async createTag(s){const r=await fetch(`${Z}/tags`,{method:"POST",headers:de(),body:JSON.stringify(s)});if(!r.ok){const o=await r.json().catch(()=>({error:"Network error"}));let n=o.error||"Failed to create tag";throw o.details&&Array.isArray(o.details)&&o.details.length>0&&(n+=": "+o.details.join(", ")),new Error(n)}return{success:!0,data:(await r.json()).tag}}static async getTag(s){const r=await fetch(`${Z}/tags/${s}`,{headers:de()});if(!r.ok){const a=await r.json().catch(()=>({error:"Network error"}));throw new Error(a.error||"Failed to fetch tag")}return r.json()}static async updateTag(s,r){const a=await fetch(`${Z}/tags/${s}`,{method:"PUT",headers:de(),body:JSON.stringify(r)});if(!a.ok){const n=await a.json().catch(()=>({error:"Network error"}));let i=n.error||"Failed to update tag";throw n.details&&Array.isArray(n.details)&&n.details.length>0&&(i+=": "+n.details.join(", ")),new Error(i)}return{success:!0,data:(await a.json()).tag}}static async deleteTag(s){const r=await fetch(`${Z}/tags/${s}`,{method:"DELETE",headers:de()});if(!r.ok){const a=await r.json().catch(()=>({error:"Network error"}));throw new Error(a.error||"Failed to delete tag")}return r.json()}static async autoGenerateTags(s){const r=await fetch(`${Z}/tags/autogenerate`,{method:"POST",headers:de(),body:JSON.stringify(s)});if(!r.ok){const a=await r.json().catch(()=>({error:"Network error"}));throw new Error(a.error||"Failed to generate tags")}return r.json()}static async exportTags(s){const r=await fetch(`${Z}/tags/export`,{method:"POST",headers:de(),body:JSON.stringify(s)});if(!r.ok){const a=await r.json().catch(()=>({error:"Network error"}));throw new Error(a.error||"Failed to export tags")}return r.json()}static async exportVendorTags(s,r,a="json"){let o;r==="beckhoff"?a==="csv"||a==="xlsx"?o=`${Z}/tags/projects/${s}/export/beckhoff/csv`:a==="xml"?o=`${Z}/tags/projects/${s}/export/beckhoff/xml`:o=`${Z}/tags/projects/${s}/export/beckhoff/csv`:o=`${Z}/tags/projects/${s}/export/${r}/formatted`;const n=await fetch(o,{method:"GET",headers:de()});if(!n.ok){const i=await n.json().catch(()=>({error:"Network error"}));throw new Error(i.error||"Failed to export vendor-specific tags")}return n.blob()}static async exportBeckhoffCsv(s){const r=await fetch(`${Z}/tags/projects/${s}/export/beckhoff/csv`,{method:"GET",headers:de()});if(!r.ok){const n=await r.json().catch(()=>({error:"Network error"}));throw new Error(n.error||"Failed to export Beckhoff CSV")}const a=await r.blob(),o=Be(r);return{blob:a,filename:o}}static async exportBeckhoffXml(s){const r=await fetch(`${Z}/tags/projects/${s}/export/beckhoff/xml`,{method:"GET",headers:de()});if(!r.ok){const n=await r.json().catch(()=>({error:"Network error"}));throw new Error(n.error||"Failed to export Beckhoff XML")}const a=await r.blob(),o=Be(r);return{blob:a,filename:o}}static async exportRockwellCsv(s){const r=await fetch(`${Z}/tags/projects/${s}/export/rockwell/csv`,{method:"GET",headers:de()});if(!r.ok){const n=await r.json().catch(()=>({error:"Network error"}));throw new Error(n.error||"Failed to export Rockwell CSV")}const a=await r.blob(),o=Be(r);return{blob:a,filename:o}}static async exportRockwellL5X(s){const r=await fetch(`${Z}/tags/projects/${s}/export/rockwell/l5x`,{method:"GET",headers:de()});if(!r.ok){const n=await r.json().catch(()=>({error:"Network error"}));throw new Error(n.error||"Failed to export Rockwell L5X")}const a=await r.blob(),o=Be(r);return{blob:a,filename:o}}static async exportSiemensCsv(s){const r=await fetch(`${Z}/tags/projects/${s}/export/siemens/csv`,{method:"GET",headers:de()});if(!r.ok){const n=await r.json().catch(()=>({error:"Network error"}));throw new Error(n.error||"Failed to export Siemens CSV")}const a=await r.blob(),o=Be(r);return{blob:a,filename:o}}static async exportSiemensXml(s){const r=await fetch(`${Z}/tags/projects/${s}/export/siemens/xml`,{method:"GET",headers:de()});if(!r.ok){const n=await r.json().catch(()=>({error:"Network error"}));throw new Error(n.error||"Failed to export Siemens XML")}const a=await r.blob(),o=Be(r);return{blob:a,filename:o}}static async exportBeckhoffXlsx(s){const r=await fetch(`${Z}/tags/projects/${s}/export/beckhoff/xlsx`,{method:"GET",headers:de()});if(!r.ok){const n=await r.json().catch(()=>({error:"Network error"}));throw new Error(n.error||"Failed to export Beckhoff XLSX")}const a=await r.blob(),o=Be(r);return{blob:a,filename:o}}static async exportSiemensXlsx(s){const r=await fetch(`${Z}/tags/projects/${s}/export/siemens/xlsx`,{method:"GET",headers:de()});if(!r.ok){const n=await r.json().catch(()=>({error:"Network error"}));throw new Error(n.error||"Failed to export Siemens XLSX")}const a=await r.blob(),o=Be(r);return{blob:a,filename:o}}static async exportRockwellXlsx(s){const r=await fetch(`${Z}/tags/projects/${s}/export/rockwell/xlsx`,{method:"GET",headers:de()});if(!r.ok){const n=await r.json().catch(()=>({error:"Network error"}));throw new Error(n.error||"Failed to export Rockwell XLSX")}const a=await r.blob(),o=Be(r);return{blob:a,filename:o}}static async importBeckhoffCsv(s,r){const a=new FormData;return a.append("file",r),await(await fetch(`${Z}/tags/projects/${s}/import/beckhoff/csv`,{method:"POST",headers:{Authorization:`Bearer ${H.getToken()}`},body:a})).json().catch(()=>({success:!1,error:"Network error"}))}static async importBeckhoffXml(s,r){const a=new FormData;return a.append("file",r),await(await fetch(`${Z}/tags/projects/${s}/import/beckhoff/xml`,{method:"POST",headers:{Authorization:`Bearer ${H.getToken()}`},body:a})).json().catch(()=>({success:!1,error:"Network error"}))}static async importRockwellCsv(s,r){const a=new FormData;return a.append("file",r),await(await fetch(`${Z}/tags/projects/${s}/import/rockwell/csv`,{method:"POST",headers:{Authorization:`Bearer ${H.getToken()}`},body:a})).json().catch(()=>({success:!1,error:"Network error"}))}static async importRockwellL5X(s,r){const a=new FormData;return a.append("file",r),await(await fetch(`${Z}/tags/projects/${s}/import/rockwell/l5x`,{method:"POST",headers:{Authorization:`Bearer ${H.getToken()}`},body:a})).json().catch(()=>({success:!1,error:"Network error"}))}static async importSiemensCsv(s,r){const a=new FormData;return a.append("file",r),await(await fetch(`${Z}/tags/projects/${s}/import/siemens/csv`,{method:"POST",headers:{Authorization:`Bearer ${H.getToken()}`},body:a})).json().catch(()=>({success:!1,error:"Network error"}))}static async importSiemensXml(s,r){const a=new FormData;a.append("file",r);const o=await fetch(`${Z}/tags/projects/${s}/import/siemens/xml`,{method:"POST",headers:{Authorization:`Bearer ${H.getToken()}`},body:a});if(!o.ok){const n=await o.json().catch(()=>({error:"Network error"}));throw new Error(n.error||"Failed to import Siemens XML")}return o.json()}static async formatTagsForVendor(s,r,a){const o=await fetch(`${Z}/tags/format/${r}`,{method:"POST",headers:de(),body:JSON.stringify({projectId:s,tags:a})});if(!o.ok){const n=await o.json().catch(()=>({error:"Network error"}));throw new Error(n.error||"Failed to format tags for vendor")}return o.json()}static async validateAddressesForVendor(s,r){const a=await fetch(`${Z}/tags/validate-addresses/${s}`,{method:"POST",headers:de(),body:JSON.stringify({addresses:r})});if(!a.ok){const o=await a.json().catch(()=>({error:"Network error"}));throw new Error(o.error||"Failed to validate addresses")}return a.json()}static async getTagStats(s){const r=await fetch(`${Z}/tags/stats/${s}`,{headers:de()});if(!r.ok){const a=await r.json().catch(()=>({error:"Network error"}));throw new Error(a.error||"Failed to fetch tag statistics")}return r.json()}}const cn=l.createContext(void 0),_d=({children:t})=>{const[s,r]=l.useState([]),[a,o]=l.useState(!1),[n,i]=l.useState(null),[c,m]=l.useState({}),[u,h]=l.useState({page:1,pageSize:50,total:0,totalPages:0}),f=l.useCallback(j=>{m(v=>({...v,...j}))},[]),b=l.useCallback(async j=>{o(!0),i(null);try{const v=j||c,x=await ne.getTags(v);r(x.data.tags),h(x.data.pagination),j&&m(T=>({...T,...j}))}catch(v){const x=v instanceof Error?v.message:"Failed to fetch tags";i(x),console.error("Error fetching tags:",v)}finally{o(!1)}},[c]),w=l.useCallback(async j=>{i(null);try{const x=(await ne.createTag(j)).data;return r(T=>[x,...T]),h(T=>({...T,total:T.total+1})),x}catch(v){const x=v instanceof Error?v.message:"Failed to create tag";throw i(x),v}},[]),p=l.useCallback(async(j,v)=>{i(null);try{const T=(await ne.updateTag(j,v)).data;return r(y=>y.map(d=>d.id===j?T:d)),T}catch(x){const T=x instanceof Error?x.message:"Failed to update tag";throw i(T),x}},[]),S=l.useCallback(async j=>{i(null);try{await ne.deleteTag(j),r(v=>v.filter(x=>x.id!==j)),h(v=>({...v,total:Math.max(0,v.total-1)}))}catch(v){const x=v instanceof Error?v.message:"Failed to delete tag";throw i(x),v}},[]),N=l.useCallback(async()=>{await b(c)},[b,c]),C=l.useCallback(()=>{i(null)},[]),k={tags:s,loading:a,error:n,filters:c,pagination:u,fetchTags:b,createTag:w,updateTag:p,deleteTag:S,setFilters:f,clearError:C,refreshTags:N};return e.jsx(cn.Provider,{value:k,children:t})},$d=()=>{const t=l.useContext(cn);if(!t)throw new Error("useTags must be used within a TagsProvider");return t},Hr=[{vendor:"rockwell",formats:["csv","xlsx","l5x"],displayName:"Rockwell (Allen-Bradley)"},{vendor:"siemens",formats:["csv","xlsx","xml"],displayName:"Siemens (TIA Portal)"},{vendor:"beckhoff",formats:["csv","xlsx","xml"],displayName:"Beckhoff (TwinCAT)"}];function Vd({isOpen:t,onClose:s,projectId:r,projectName:a,tags:o}){const[n,i]=l.useState({step:"select"}),c=k=>o.filter(j=>j.vendor===k).length,m=o.length;l.useEffect(()=>{t&&i({step:"select"})},[t]);const u=k=>{i(j=>({...j,selectedVendor:k}))},h=k=>{i(j=>({...j,selectedFormat:k}))},f=()=>{i(k=>({...k,step:"confirm"}))},b=async()=>{if(!n.selectedVendor||!n.selectedFormat)return;const k=c(n.selectedVendor);if(k===0){i(j=>({...j,step:"error",errorMessage:`No ${n.selectedVendor} tags found in this project. Please import or create ${n.selectedVendor} tags first.`}));return}i(j=>({...j,step:"progress"}));try{k>1e3&&await new Promise(x=>setTimeout(x,1e3));let j;n.selectedVendor==="beckhoff"?n.selectedFormat==="csv"?j=await ne.exportBeckhoffCsv(r):n.selectedFormat==="xml"?j=await ne.exportBeckhoffXml(r):n.selectedFormat==="xlsx"?j=await ne.exportBeckhoffXlsx(r):j=await ne.exportBeckhoffCsv(r):n.selectedVendor==="siemens"?n.selectedFormat==="csv"?j=await ne.exportSiemensCsv(r):n.selectedFormat==="xml"?j=await ne.exportSiemensXml(r):n.selectedFormat==="xlsx"?j=await ne.exportSiemensXlsx(r):j=await ne.exportSiemensCsv(r):n.selectedVendor==="rockwell"?n.selectedFormat==="csv"?j=await ne.exportRockwellCsv(r):n.selectedFormat==="l5x"?j=await ne.exportRockwellL5X(r):n.selectedFormat==="xlsx"?j=await ne.exportRockwellXlsx(r):j=await ne.exportRockwellCsv(r):j={blob:await ne.exportVendorTags(r,n.selectedVendor,n.selectedFormat),filename:`${a}-${n.selectedVendor}-tags.${n.selectedFormat}`};const v=window.URL.createObjectURL(j.blob);i(x=>({...x,step:"success",downloadUrl:v,filename:j.filename}))}catch(j){let v="Unknown error occurred";j instanceof Error?v=j.message:typeof j=="string"&&(v=j),(v.includes("Failed to fetch")||v.includes("NetworkError"))&&(v="Network error occurred. Please check your connection and try again."),i(x=>({...x,step:"error",errorMessage:v}))}},w=async()=>{if(n.downloadUrl&&n.filename)try{const j=await(await fetch(n.downloadUrl)).blob();Id(j,n.filename),window.URL.revokeObjectURL(n.downloadUrl)}catch(k){console.error("Download failed:",k);const j=document.createElement("a");j.href=n.downloadUrl,j.download=n.filename,document.body.appendChild(j),j.click(),document.body.removeChild(j),window.URL.revokeObjectURL(n.downloadUrl)}},p=()=>{i(k=>({...k,step:"select"}))},S=()=>{i(k=>({...k,step:"select"}))},N=n.selectedVendor&&n.selectedFormat,C=Hr.find(k=>k.vendor===n.selectedVendor);return m===0?e.jsx(De,{isOpen:t,onClose:s,title:"Export Tags",size:"md",children:e.jsxs("div",{className:"flex flex-col items-center py-8 text-center",children:[e.jsx(be,{className:"w-16 h-16 text-amber-500 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Tags to Export"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Please generate or import tags before exporting."}),e.jsx("button",{onClick:s,className:"bg-primary text-white px-6 py-2 rounded-md hover:bg-primary-dark transition-colors",children:"Close"})]})}):e.jsx(De,{isOpen:t,onClose:s,title:n.step==="select"?"Export Your Tags":n.step==="confirm"?"Confirm Export":n.step==="progress"?"Exporting Tags":n.step==="success"?"Export Complete!":"Export Failed",size:"md",children:e.jsxs("div",{className:"space-y-6",children:[n.step==="select"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-sm text-gray-600 mb-4",children:"Choose your export vendor and format:"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Vendor"}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:Hr.map(k=>{const j=c(k.vendor);return e.jsxs("div",{onClick:()=>u(k.vendor),className:`border rounded-lg p-3 cursor-pointer transition-colors ${n.selectedVendor===k.vendor?"border-primary bg-primary/5":j===0?"border-gray-200 bg-gray-50 opacity-60 cursor-not-allowed":"border-gray-200 hover:border-gray-300"}`,style:{pointerEvents:j===0?"none":"auto"},children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:k.displayName}),e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:["Formats: ",k.formats.map(v=>v.toUpperCase()).join(", ")]})]}),e.jsxs("div",{className:`text-sm font-medium ${j===0?"text-gray-400":"text-blue-600"}`,children:[j," tags"]})]}),j===0&&e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"No tags available for this vendor"})]},k.vendor)})})]}),n.selectedVendor&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Format"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:C?.formats.map(k=>e.jsxs("div",{onClick:()=>h(k),className:`border rounded-lg p-3 cursor-pointer transition-colors text-center ${n.selectedFormat===k?"border-primary bg-primary/5":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("div",{className:"font-medium",children:k.toUpperCase()}),k==="l5x"&&e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Rockwell Studio 5000 format"}),k==="xml"&&n.selectedVendor==="siemens"&&e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"TIA Portal XML"}),k==="xml"&&n.selectedVendor==="beckhoff"&&e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"TwinCAT XML"})]},k))})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(be,{className:"w-4 h-4 text-blue-600 mt-0.5 mr-2 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Tip:"})," Select the format compatible with your PLC programming environment."]})]})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:f,disabled:!N,className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Continue"})]})]}),n.step==="confirm"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center py-4",children:[e.jsxs("div",{className:"text-lg font-medium text-gray-900 mb-4",children:["You are about to export ",c(n.selectedVendor)," ",C?.displayName," tags for project '",a,"' in ",n.selectedFormat?.toUpperCase()," format."]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Click Export to start."})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{onClick:S,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Back"}),e.jsxs("button",{onClick:b,className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark transition-colors flex items-center gap-2",children:[e.jsx(Ze,{className:"w-4 h-4"}),"Export"]})]})]}),n.step==="progress"&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ws,{className:"w-12 h-12 text-primary animate-spin mx-auto mb-4"}),e.jsx("div",{className:"text-lg font-medium text-gray-900 mb-2",children:"Preparing your export file..."}),e.jsx("div",{className:"text-sm text-gray-600",children:"Please do not close this window."})]}),n.step==="success"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center py-6",children:[e.jsx(Pe,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Export complete!"}),e.jsxs("div",{className:"text-gray-600 mb-6",children:["Your file ",n.filename," is ready to download."]}),e.jsxs("button",{onClick:w,className:"bg-primary text-white px-6 py-3 rounded-md hover:bg-primary-dark transition-colors flex items-center gap-2 mx-auto",children:[e.jsx(lo,{className:"w-5 h-5"}),"Download Now"]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:s,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Close"})})]}),n.step==="error"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center py-6",children:[e.jsx(be,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Export failed."}),e.jsxs("div",{className:"text-gray-600 mb-2",children:[e.jsx("strong",{children:"Reason:"})," ",n.errorMessage]}),e.jsx("div",{className:"text-sm text-gray-500 mb-6",children:"Please try again or contact support if the problem persists."})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Close"}),e.jsx("button",{onClick:p,className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark transition-colors",children:"Try Again"})]})]})]})})}const At=[{vendor:"rockwell",formats:["csv","l5x"],displayName:"Rockwell (Allen-Bradley Studio 5000)",description:"Import tags from Studio 5000 CSV exports or L5X XML files",supportedHeaders:["Tag Name","Data Type","Scope","Description","External Access","Default Value","Address"]},{vendor:"siemens",formats:["csv","xlsx","xml"],displayName:"Siemens (TIA Portal)",description:"Import tags from TIA Portal CSV/XLSX exports or PLCOpen XML"},{vendor:"beckhoff",formats:["csv","xml"],displayName:"Beckhoff (TwinCAT)",description:"Import tags from TwinCAT CSV exports or ADS XML files",supportedHeaders:["Name","DataType","Address","Comment","InitialValue","Scope","AccessMode"]}];function Ud({isOpen:t,onClose:s,projectId:r,projectName:a,onSuccess:o}){const[n,i]=l.useState({step:"upload"}),c=l.useRef(null);l.useEffect(()=>{t&&i({step:"upload"})},[t]);const m=k=>{i(j=>({...j,selectedVendor:k}))},u=async k=>{!n.selectedFile||!n.selectedVendor||(i(j=>({...j,selectedFormat:k,step:"progress"})),await h(n.selectedVendor,k,n.selectedFile))},h=async(k,j,v)=>{i(x=>({...x,step:"progress"}));try{let x;if(k==="beckhoff")if(j==="csv")x=await ne.importBeckhoffCsv(r,v);else if(j==="xml")x=await ne.importBeckhoffXml(r,v);else throw new Error("Unsupported format for Beckhoff");else if(k==="siemens")if(j==="csv")x=await ne.importSiemensCsv(r,v);else if(j==="xml")x=await ne.importSiemensXml(r,v);else throw j==="xlsx"?new Error("XLSX import for Siemens is not supported."):new Error("Unsupported format for Siemens");else if(k==="rockwell")if(j==="csv")x=await ne.importRockwellCsv(r,v);else if(j==="l5x")x=await ne.importRockwellL5X(r,v);else throw new Error("Unsupported format for Rockwell");else throw new Error("Unsupported vendor");if(!x||x.success===!1){i(T=>({...T,step:"error",importResult:x,errorMessage:x&&x.error||"Import failed on server"}));return}if(x.errors&&x.errors.length>0&&!x.errorReport){const T=["Row,Errors"];x.errors.forEach(y=>{T.push(`${y.row},"${y.errors.join(", ")}"`)}),x.errorReport=btoa(T.join(`
`))}i(T=>({...T,step:"success",importResult:x})),o&&x.inserted&&o(x.inserted),window.dispatchEvent(new CustomEvent("pandaura:tags-imported",{detail:{projectId:r,importedCount:x.inserted}}))}catch(x){let T="Unknown error occurred";x instanceof Error?T=x.message:typeof x=="string"&&(T=x),i(y=>({...y,step:"error",errorMessage:T}))}},f=async k=>{const j=k.target.files?.[0];if(j){i(v=>({...v,selectedFile:j,step:"detect"}));try{const v=[];let x;const T=j.name.split(".").pop()?.toLowerCase();T==="csv"?x="csv":T==="xml"?x="xml":T==="xlsx"?x="xlsx":T==="l5x"&&(x="l5x");const d=(await j.text()).toLowerCase();(d.includes("rockwell")||d.includes("studio 5000")||d.includes("allen-bradley"))&&v.push("rockwell"),(d.includes("siemens")||d.includes("tia portal"))&&v.push("siemens"),(d.includes("beckhoff")||d.includes("twincat"))&&v.push("beckhoff"),v.length===1&&x?i(g=>({...g,selectedVendor:v[0],detectedVendors:v,detectedFormat:x,step:"manual-select"})):i(g=>({...g,detectedVendors:v,detectedFormat:x,step:"manual-select"}))}catch(v){console.error("Error detecting file format:",v),i(x=>({...x,step:"manual-select"}))}}},b=()=>{i({step:"upload"}),c.current&&(c.current.value="")},w=()=>{i(k=>({...k,step:"upload"}))},p=At.find(k=>k.vendor===n.selectedVendor),S=n.detectedVendors&&n.detectedVendors.length>0?n.detectedVendors[0]:void 0,N=S?At.find(k=>k.vendor===S)?.displayName||S:void 0,C=n.detectedFormat?n.detectedFormat.toUpperCase():void 0;return e.jsx(De,{isOpen:t,onClose:s,title:n.step==="upload"?"Import Tags":n.step==="detect"?"Detecting Format...":n.step==="manual-select"?"Select Format":n.step==="progress"?"Importing Tags":n.step==="success"?"Import Complete!":"Import Failed",size:"lg",children:e.jsxs("div",{className:"space-y-6",children:[n.step==="upload"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Upload your tag file"}),e.jsxs("div",{className:"text-gray-600",children:[e.jsx("p",{className:"mb-4",children:"Supported formats:"}),e.jsxs("ul",{className:"text-left mx-auto max-w-md space-y-2",children:[e.jsx("li",{children:" Rockwell: .csv (Studio 5000 Tag Database), .l5x (XML)"}),e.jsx("li",{children:" Siemens: .csv, .xlsx, .xml"}),e.jsx("li",{children:" Beckhoff: .csv, .xml"})]}),e.jsx("p",{className:"mt-4 text-sm italic",children:"Tip: Export your tags from your PLC software in one of these formats."})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-gray-400 transition-colors cursor-pointer",onClick:()=>c.current?.click(),children:[e.jsx("input",{ref:c,type:"file",accept:".csv,.xlsx,.xml,.l5x",onChange:f,className:"hidden"}),e.jsx(_t,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("div",{className:"text-lg font-medium text-gray-900 mb-2",children:"Choose file to upload"}),e.jsx("div",{className:"text-gray-600",children:"Click to browse or drag and drop your tag file"})]})})]}),n.step==="detect"&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ws,{className:"w-12 h-12 text-primary animate-spin mx-auto mb-4"}),e.jsx("div",{className:"text-lg font-medium text-gray-900 mb-2",children:"Analyzing your file..."}),e.jsx("div",{className:"text-sm text-gray-600",children:"Please wait while we detect the file format."})]}),n.step==="manual-select"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"File Format Detection"}),e.jsx("p",{className:"text-gray-600",children:n.detectedVendors?.length===0?"We couldn't identify your file's vendor/format. Please select the vendor and format manually:":S&&C?`Detected vendor: ${N}  format ${C}. Please confirm to proceed.`:"Multiple possible vendors detected. Please confirm the correct vendor and format (other options are disabled until you change the file):"})]}),e.jsx("div",{className:"space-y-4",children:n.detectedVendors&&n.detectedVendors.length===1&&n.detectedFormat?e.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Detected file"}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:At.find(k=>k.vendor===n.detectedVendors[0])?.displayName}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Format: ",e.jsx("span",{className:"font-medium",children:n.detectedFormat.toUpperCase()})]})]}),e.jsx("div",{className:"text-xs text-green-700 bg-green-50 px-2 py-1 rounded",children:"Detected"})]})]}),e.jsx("div",{className:"mt-2 text-sm text-gray-700",children:"The importer detected the vendor and format for your file. Other vendors and formats are disabled to avoid accidental imports."}),e.jsx("div",{className:"mt-4 flex items-center justify-end",children:e.jsxs("button",{onClick:()=>u(n.detectedFormat),className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark transition-colors",children:["Confirm & Import ",n.detectedFormat.toUpperCase()]})}),e.jsx("div",{className:"mt-4 grid grid-cols-1 gap-2 text-xs text-gray-500",children:At.filter(k=>k.vendor!==n.detectedVendors[0]).map(k=>e.jsxs("div",{className:"p-2 border rounded bg-white opacity-50",children:[k.displayName,"  Not detected"]},k.vendor))})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Select Vendor"}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:At.map(k=>e.jsxs("button",{onClick:()=>m(k.vendor),className:`
                            p-4 border-2 rounded-lg text-left transition-all
                            ${n.selectedVendor===k.vendor?"border-primary bg-primary/5":"border-gray-200 hover:border-gray-300"}
                          `,disabled:n.detectedVendors&&n.detectedVendors.length>0&&!n.detectedVendors.includes(k.vendor),children:[e.jsx("div",{className:"font-medium text-gray-900",children:k.displayName}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:k.description}),n.detectedVendors?.includes(k.vendor)&&e.jsx("div",{className:"text-xs text-green-600 mt-1",children:"Detected in file"})]},k.vendor))})]}),n.selectedVendor&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Select Format"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:p?.formats.map(k=>e.jsxs("button",{onClick:()=>u(k),className:`
                              p-3 border-2 rounded-lg text-center font-medium transition-all
                              ${n.selectedFormat===k?"border-primary bg-primary text-white":"border-gray-200 text-gray-700 hover:border-gray-300"}
                            `,disabled:n.detectedFormat&&n.detectedFormat!==k,children:[k.toUpperCase(),n.detectedFormat===k&&e.jsx("div",{className:"text-xs mt-1",children:"Detected"})]},k))})]})]})})]}),n.step==="progress"&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ws,{className:"w-12 h-12 text-primary animate-spin mx-auto mb-4"}),e.jsx("div",{className:"text-lg font-medium text-gray-900 mb-2",children:"Importing your tags..."}),e.jsx("div",{className:"text-sm text-gray-600",children:"Please wait while your tags are being processed."})]}),n.step==="success"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center py-6",children:[e.jsx(Pe,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Import completed successfully!"}),e.jsxs("div",{className:"text-gray-600 mb-4",children:[n.importResult?.inserted||0," tags were imported"]}),n.importResult?.errors&&n.importResult.errors.length>0&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 text-left mb-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(It,{className:"w-5 h-5 text-yellow-600 mr-2 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-yellow-800 mb-2",children:[n.importResult.errors.length," rows had issues:"]}),e.jsxs("div",{className:"text-sm text-yellow-700 space-y-1 max-h-32 overflow-y-auto",children:[n.importResult.errors.slice(0,5).map((k,j)=>e.jsxs("div",{children:["Row ",k.row,": ",k.errors.join(", ")]},j)),n.importResult.errors.length>5&&e.jsxs("div",{className:"text-yellow-600 italic",children:["... and ",n.importResult.errors.length-5," more"]})]}),n.importResult.errorReport&&e.jsx("div",{className:"mt-3",children:e.jsxs("a",{href:`data:text/csv;base64,${n.importResult.errorReport}`,download:"import-errors.csv",className:"inline-flex items-center text-sm text-yellow-700 hover:text-yellow-800",children:[e.jsx(Ze,{className:"w-4 h-4 mr-1"}),"Download Error Report"]})})]})]})})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{onClick:b,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Import More"}),e.jsx("button",{onClick:s,className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark transition-colors",children:"Done"})]})]}),n.step==="error"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center py-6",children:[e.jsx(be,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Import failed"}),e.jsxs("div",{className:"text-gray-600 mb-2",children:[e.jsx("strong",{children:"Error:"})," ",n.errorMessage]})]}),n.importResult?.errors&&n.importResult.errors.length>0&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 text-left mb-4",children:[e.jsxs("div",{className:"font-medium text-yellow-800 mb-2",children:[n.importResult.errors.length," rows had issues:"]}),e.jsx("div",{className:"text-sm text-yellow-700 space-y-1 max-h-48 overflow-y-auto",children:n.importResult.errors.map((k,j)=>e.jsxs("div",{children:["Row ",k.row,": ",k.errors.join(", ")]},j))}),n.importResult.errorReport&&e.jsx("div",{className:"mt-3",children:e.jsxs("a",{href:`data:text/csv;base64,${n.importResult.errorReport}`,download:"import-errors.csv",className:"inline-flex items-center text-sm text-yellow-700 hover:text-yellow-800",children:[e.jsx(Ze,{className:"w-4 h-4 mr-1"}),"Download Error Report"]})})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Close"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:w,className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary-dark transition-colors",children:"Try Again"}),e.jsx("button",{onClick:b,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Upload New File"})]})]})]})]})})}const zd=[{pattern:/^I:\d+\/\d+$/i,description:"Input: I:x/y (e.g., I:1/0)"},{pattern:/^O:\d+\/\d+$/i,description:"Output: O:x/y (e.g., O:2/0)"},{pattern:/^N\d+:\d+$/i,description:"Integer: Nx:y (e.g., N7:0)"},{pattern:/^F\d+:\d+$/i,description:"Float: Fx:y (e.g., F8:0)"},{pattern:/^B\d+:\d+$/i,description:"Binary: Bx:y (e.g., B3:0)"},{pattern:/^T\d+:\d+$/i,description:"Timer: Tx:y (e.g., T4:0)"},{pattern:/^C\d+:\d+$/i,description:"Counter: Cx:y (e.g., C5:0)"},{pattern:/^R\d+:\d+$/i,description:"Control: Rx:y (e.g., R6:0)"},{pattern:/^S\d+:\d+$/i,description:"String: Sx:y (e.g., S2:0)"},{pattern:/^[A-Za-z_][A-Za-z0-9_]*$/i,description:"Symbolic: MyTag_1"}],Bd=[{pattern:/^I\d+\.\d+$/i,description:"Input: Ix.y (e.g., I0.0)"},{pattern:/^Q\d+\.\d+$/i,description:"Output: Qx.y (e.g., Q0.0)"},{pattern:/^M\d+\.\d+$/i,description:"Memory: Mx.y (e.g., M0.0)"},{pattern:/^DB\d+\.DB[BWDX]\d+$/i,description:"Data Block: DBx.DBYz (e.g., DB1.DBD0)"},{pattern:/^L\d+\.\d+$/i,description:"Local: Lx.y (e.g., L0.0)"},{pattern:/^[A-Za-z_][A-Za-z0-9_]*$/i,description:"Symbolic: MyTag_1"}],qd=[{pattern:/^%[IQMT]\d+(\.\d+)?$/i,description:"I/O: %Xx.y (e.g., %I0.0, %Q2)"},{pattern:/^%[IQMT][BWDL]\d+$/i,description:"Typed Memory: %XYz (e.g., %MW100)"},{pattern:/^GVL\.[a-zA-Z_][\w]*$/i,description:"GVL Reference: GVL.Variable"},{pattern:/^[a-zA-Z_][\w]*$/i,description:"Symbolic: MyVariable"}];function Gr(t,s){if(!t||!t.trim())return{isValid:!1,errorMessage:"Address is required"};const r=t.trim();let a=[],o="";switch(s.toLowerCase()){case"rockwell":a=zd,o="Rockwell";break;case"siemens":a=Bd,o="Siemens";break;case"beckhoff":a=qd,o="Beckhoff";break;default:return{isValid:!1,errorMessage:"Unsupported vendor"}}return a.some(({pattern:i})=>i.test(r))?{isValid:!0}:{isValid:!1,errorMessage:`Invalid ${o} address format: ${t}`,suggestedFormats:a.map(i=>i.description)}}function Hd(t){switch(t.toLowerCase()){case"rockwell":return["I:1/0","O:2/0","N7:0","F8:0","MyTag_1"];case"siemens":return["I0.0","Q0.0","M0.0","DB1.DBD0","MyTag_1"];case"beckhoff":return["%I0.0","%Q2.1","%MW100","GVL.MyVar","MyVariable"];default:return[]}}function Gd(t){switch(t.toLowerCase()){case"rockwell":return"Rockwell Allen-Bradley addressing: I:x/y, O:x/y, Nx:y, Fx:y, or symbolic names";case"siemens":return"Siemens TIA Portal addressing: Ix.y, Qx.y, Mx.y, DBx.DBYz, or symbolic names";case"beckhoff":return"Beckhoff TwinCAT addressing: %Xx.y, %XYz, GVL.Variable, or symbolic names";default:return"Please select a vendor to see address format guidelines"}}const Fe={rockwell:{name:"Rockwell (Allen-Bradley)",dataTypes:["BOOL","INT","DINT","REAL","STRING"],scopes:["Local","Global","Input","Output"],description:"Studio 5000 Compatible Data Types",allowCustomTypes:!1},siemens:{name:"Siemens",dataTypes:["BOOL","INT","DINT","REAL","STRING"],scopes:["Input","Output","Memory"],description:"TIA Portal Compatible Data Types",allowCustomTypes:!1},beckhoff:{name:"Beckhoff",dataTypes:["BOOL","INT","DINT","REAL","STRING"],scopes:["Input","Output","Internal","Global","Local"],description:"TwinCAT Compatible Data Types + Custom Types",allowCustomTypes:!0}},Wd=t=>Fe[t]?.dataTypes||[],Yd=t=>Fe[t]?.scopes||[],Wr=(t,s)=>t==="beckhoff"?s.trim().length>0:Wd(t).includes(s),Xd=(t,s)=>Yd(t).includes(s),Jd=[{value:"rockwell",label:Fe.rockwell.name},{value:"siemens",label:Fe.siemens.name},{value:"beckhoff",label:Fe.beckhoff.name}],zs=t=>Fe[t].dataTypes.map(s=>({value:s,label:s})),Kd=t=>Fe[t].scopes.map(s=>({value:s.toLowerCase(),label:s}));function Qd({isOpen:t,onClose:s,onSuccess:r,projectId:a,onCreate:o,customTypes:n=[],onCustomTypeAdded:i}){const{showToast:c}=Ge(),[m,u]=l.useState(""),[h,f]=l.useState(!1),[b,w]=l.useState(n);l.useEffect(()=>{w(n)},[n]);const[p,S]=l.useState({name:"",description:"",type:"BOOL",address:"",default_value:"",vendor:"rockwell",scope:"global",tag_type:"memory",is_ai_generated:!1}),[N,C]=l.useState({}),[k,j]=l.useState(!1),v=()=>{const d={};if(p.name.trim()||(d.name="Tag name is required"),p.description.trim()||(d.description="Description is required"),Wr(p.vendor,p.type)||(d.type=`Data type '${p.type}' is not supported by ${p.vendor.charAt(0).toUpperCase()+p.vendor.slice(1)}`),!p.address.trim())d.address="Address is required";else{const g=Gr(p.address,p.vendor);g.isValid||(d.address=g.errorMessage)}return C(d),Object.keys(d).length===0},x=async()=>{if(v()){j(!0);try{const d={...p,project_id:a,name:p.name.trim(),description:p.description.trim(),address:p.address.trim(),default_value:p.default_value?.trim()||""};await o(d),c({variant:"success",title:"Success!",message:`Tag "${p.name.trim()}" has been created successfully.`,duration:4e3}),r(),T()}catch(d){console.error("Failed to create tag:",d),c({variant:"error",title:"Error",message:d.message||"Failed to create tag. Please try again.",duration:5e3})}finally{j(!1)}}},T=()=>{S({name:"",description:"",type:"BOOL",address:"",default_value:"",vendor:"rockwell",scope:"global",tag_type:"memory",is_ai_generated:!1}),u(""),f(!1),C({}),j(!1),s()},y=(d,g)=>{if(S(A=>{const O={...A,[d]:g};if(d==="vendor"){const D=g;if(!Wr(D,A.type)){const L=Fe[D].dataTypes[0]==="BOOL"?"BOOL":"INT";O.type=L}if(!Xd(D,A.scope)){const L=Fe[D].scopes[0].toLowerCase()==="global"?"global":"local";O.scope=L}(D==="siemens"||D==="rockwell"&&!["input","output","memory"].includes(A.tag_type))&&(O.tag_type="memory")}return O}),N[d]&&C(A=>({...A,[d]:void 0})),d==="vendor"&&p.address){const A=Gr(p.address,g);A.isValid||C(O=>({...O,address:A.errorMessage}))}};return e.jsx(De,{isOpen:t,onClose:T,title:"Create New Tag",size:"lg",actions:e.jsxs(e.Fragment,{children:[e.jsx(F,{variant:"secondary",onClick:T,disabled:k,children:"Cancel"}),e.jsx(F,{onClick:x,disabled:k,loading:k,children:k?"Creating...":"Create Tag"})]}),children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{children:e.jsx(Ue,{label:"Vendor",options:Jd,value:p.vendor,onChange:d=>y("vendor",d),required:!0})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsx(ve,{label:"Tag Name",placeholder:"Enter tag name (e.g., Motor_01_Start)",value:p.name,onChange:d=>y("name",d.target.value),error:N.name,required:!0})}),e.jsxs("div",{children:[e.jsx(ve,{label:"Address",placeholder:`Enter ${p.vendor} address`,value:p.address,onChange:d=>y("address",d.target.value),error:N.address,required:!0}),e.jsxs("div",{className:"mt-1 text-xs text-gray-500",children:[e.jsx("div",{className:"mb-1",children:Gd(p.vendor)}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Examples:"})," ",Hd(p.vendor).join(", ")]})]})]})]}),e.jsx("div",{children:e.jsx(Et,{label:"Description",placeholder:"Enter tag description",value:p.description,onChange:d=>y("description",d.target.value),error:N.description,rows:3,required:!0})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{children:p.vendor==="beckhoff"?e.jsxs("div",{children:[h?e.jsx(ve,{label:"Custom Data Type",placeholder:"Enter custom data type name (e.g., ST_CUSTOM_STRUCT)",value:m,onChange:d=>{const g=d.target.value.toUpperCase();u(g)},onBlur:d=>{const g=m.trim();g?(b.some(A=>A.value===g)||w(A=>[...A,{value:g,label:g}]),y("type",g),f(!1),u(""),n.some(A=>A.value===g)||i?.(g)):(f(!1),u(""),y("type",zs(p.vendor)[0].value))},required:!0}):e.jsx(Ue,{label:"Data Type",options:(()=>{const d=[...zs(p.vendor),...b.map(g=>({value:g.value,label:g.label||g.value}))];return p.type&&!d.some(g=>g.value===p.type)&&p.type!=="custom"&&d.unshift({value:p.type,label:p.type}),d.push({value:"custom",label:"+ Add Custom Type"}),d})(),value:p.type,onChange:d=>{d==="custom"?f(!0):y("type",d)},required:!0}),p.type!=="custom"&&e.jsxs("div",{className:"mt-1 text-xs text-gray-500",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Common Types:"})," ",Fe[p.vendor].dataTypes.join(", ")]}),b.length>0&&e.jsxs("div",{className:"mt-1",children:[e.jsx("span",{className:"font-medium",children:"Custom Types:"})," ",b.map(d=>d.value).join(", ")]}),e.jsxs("div",{className:"mt-1",children:[e.jsx("span",{className:"font-medium",children:"Note:"})," You can add custom data types for Beckhoff PLCs"]})]})]}):e.jsxs("div",{children:[e.jsx(Ue,{label:"Data Type",options:zs(p.vendor),value:p.type,onChange:d=>y("type",d),required:!0}),e.jsx("div",{className:"mt-1 text-xs text-gray-500",children:e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Supported Types:"})," ",Fe[p.vendor].dataTypes.join(", ")]})})]})}),e.jsxs("div",{children:[e.jsx(Ue,{label:"Scope",options:Kd(p.vendor),value:p.scope,onChange:d=>y("scope",d),required:!0}),e.jsx("div",{className:"mt-1 text-xs text-gray-500",children:p.vendor==="siemens"?e.jsx("div",{children:"Scope defined by DB (Data Block), I (Inputs), Q (Outputs), M (Memory)"}):p.vendor==="rockwell"?e.jsx("div",{children:"Scope affects tag category in Studio 5000"}):e.jsx("div",{children:"Scope defines variable accessibility"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsx(Ue,{label:"Tag Type",options:[{value:"input",label:"Input"},{value:"output",label:"Output"},{value:"memory",label:"Memory"},{value:"temp",label:"Temp"},{value:"constant",label:"Constant"}].filter(d=>p.vendor==="siemens"?["memory","input","output","temp"].includes(d.value):p.vendor==="rockwell"?["input","output","memory"].includes(d.value):!0),value:p.tag_type,onChange:d=>y("tag_type",d),required:!0})}),e.jsx("div",{children:e.jsx(ve,{label:"Default Value",placeholder:"Enter default value (optional)",value:p.default_value||"",onChange:d=>y("default_value",d.target.value)})})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Preview"}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Name:"})," ",p.name||"Not specified"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Address:"})," ",p.address||"Not specified"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Type:"})," ",p.type," (",p.vendor,")"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Scope:"})," ",p.scope]})]})]})]})})}const Yr={rockwell:["BOOL","INT","DINT","REAL","STRING"],siemens:["BOOL","INT","DINT","REAL","STRING"],beckhoff:["BOOL","INT","DINT","REAL","STRING"]},Zd=t=>Yr[t]||Yr.rockwell,eu=({sessionMode:t=!1})=>{const{projectId:s}=Mt(),r=he(),{showToast:a}=Ge(),o=window.location.pathname.startsWith("/workspace/"),{isConnected:n,isConnecting:i,lastError:c,lastSyncTime:m,queuedSyncs:u,latestTags:h,onTagsUpdated:f,offTagsUpdated:b}=ln(),{tags:w,loading:p,error:S,filters:N,pagination:C,fetchTags:k,createTag:j,updateTag:v,deleteTag:x,setFilters:T,clearError:y,refreshTags:d}=$d(),[g,A]=l.useState(!1),[O,D]=l.useState(null),[L,U]=l.useState({}),M=l.useRef({}),[R,z]=l.useState(null),[J,te]=l.useState([]),[ue,I]=l.useState(!1),[Y,W]=l.useState(!1),[oe,xe]=l.useState(!1),[G,X]=l.useState(null),[ze,Ht]=l.useState(!1),[Ts,Gt]=l.useState(!1),[Wt,jt]=l.useState(!1),[We,Yt]=l.useState(null),[Ae,Xt]=l.useState(null),[Ps,Jt]=l.useState(!1),_=l.useRef(null),ee=l.useCallback(P=>{if(P.type==="tags_updated"&&P.success&&P.tags){if(console.log(` Received real-time tag update: ${P.tags.length} tags`),Xt(Date.now()),R){const V=setTimeout(()=>{d().catch(le=>{console.error("Failed to refresh tags:",le),a({variant:"error",title:"Sync Error",message:"Failed to refresh tags. Please try again."})})},500);return()=>clearTimeout(V)}a({variant:"success",title:"Tags Updated",message:`${P.parsedCount||P.tags.length} tags synced from Logic Studio`,duration:3e3})}else P.type==="tags_updated"&&!P.success&&(console.error("Tag sync failed:",P.error),a({variant:"error",title:"Sync Failed",message:P.error||"Failed to sync tags from Logic Studio",duration:5e3}))},[R,d,a]);l.useEffect(()=>{let P=!0,V;return(async()=>{if(P)try{f(ee),V=setInterval(()=>{!n&&!i&&P&&(a({variant:"warning",title:"Sync Disconnected",message:"Tag sync connection lost. Attempting to reconnect...",duration:5e3}),Jt(!0))},3e4)}catch(fe){console.error("Failed to initialize tag sync:",fe),P&&a({variant:"error",title:"Sync Error",message:"Failed to initialize tag sync. Please try again.",duration:5e3})}})(),()=>{P=!1,V&&clearInterval(V),b(ee)}},[ee,f,b,n,i,a]);const ce=async P=>{try{const le=(await ae.getProjects()).find(fe=>fe.id===P);le&&Yt(le)}catch(V){console.error("Failed to load current project:",V)}};l.useEffect(()=>{const P=V=>{_.current&&!_.current.contains(V.target)&&A(!1)};return document.addEventListener("mousedown",P),()=>document.removeEventListener("mousedown",P)},[]),l.useEffect(()=>{let P=null;if(s)P=parseInt(s),localStorage.setItem("currentProjectId",P.toString());else{const V=localStorage.getItem("currentProjectId");V&&(P=parseInt(V))}P&&!isNaN(P)?(z(P),T({projectId:P}),!s&&!t&&!o&&r(`/tag-database/${P}`,{replace:!0})):!t&&!o&&(z(null),pe())},[s,T,r,t,o]);const pe=async()=>{try{I(!0);const P=await ae.getProjects();te(P)}catch(P){console.error("Failed to load projects:",P)}finally{I(!1)}};l.useEffect(()=>{R&&(k({projectId:R}),We||ce(R))},[R]),l.useEffect(()=>{const P=V=>{const{projectId:le,importedCount:fe}=V.detail;le===R&&Jt(!0)};return window.addEventListener("pandaura:tags-imported",P),()=>{window.removeEventListener("pandaura:tags-imported",P)}},[R]);const Se=w.filter(P=>!(N.search&&!P.name.toLowerCase().includes(N.search.toLowerCase())&&!P.description.toLowerCase().includes(N.search.toLowerCase())||N.vendor&&N.vendor!=="all"&&P.vendor!==N.vendor||N.type&&N.type!=="all"&&P.type!==N.type||N.dataType&&N.dataType!=="all"&&P.data_type!==N.dataType||N.scope&&N.scope!=="all"&&P.scope!==N.scope||N.tagType&&N.tagType!=="all"&&P.tag_type!==N.tagType||N.isAIGenerated&&!P.is_ai_generated)),Ye=async P=>{const V=L[P];if(!V||Object.keys(V).length===0)return;const le=M.current[P];le&&(clearTimeout(le),delete M.current[P]);try{const fe=await v(P,V);a({variant:"success",title:"Tag Updated",message:"Changes saved",duration:3e3}),window.dispatchEvent(new CustomEvent("pandaura:tags-updated",{detail:{projectId:R,action:"update",tagId:P,tagName:fe?.name||"Unknown"}})),U($e=>{const pr={...$e};return delete pr[P],pr})}catch(fe){console.error("Error flushing tag update:",fe);const $e=fe instanceof Error?fe.message:"Failed to update tag";a({variant:"error",title:"Update Failed",message:$e,duration:5e3})}},se=(P,V,le)=>{try{if(!w.find($e=>$e.id===P))throw new Error("Tag not found");U($e=>({...$e,[P]:{...$e[P]||{},[V]:le}}))}catch(fe){console.error("Error updating tag field:",fe);const $e=fe instanceof Error?fe.message:"Failed to update tag field";a({variant:"error",title:"Update Failed",message:$e,duration:5e3})}},ie=P=>{X(P),xe(!0)},B=async()=>{if(G){Ht(!0);try{await x(G.id),a({variant:"success",title:"Tag Deleted",message:`Tag "${G.name}" has been successfully deleted.`,duration:4e3}),window.dispatchEvent(new CustomEvent("pandaura:tags-updated",{detail:{projectId:R,action:"delete",tagName:G.name}})),xe(!1),X(null)}catch(P){console.error("Error deleting tag:",P),a({variant:"error",title:"Delete Failed",message:P instanceof Error?P.message:"Failed to delete tag. Please try again.",duration:5e3})}finally{Ht(!1)}}},xr=()=>{xe(!1),X(null)},un=async P=>{try{await Ye(parseInt(P)),D(null)}catch(V){console.error("Error saving tag:",V)}},mn=()=>{if(!R){a({variant:"error",title:"No Project Selected",message:"Please select a project first before adding tags.",duration:4e3});return}W(!0)},hn=async P=>{try{await j(P),await d(),window.dispatchEvent(new CustomEvent("pandaura:tags-updated",{detail:{projectId:R,action:"create",tagName:P.name}}))}catch(V){throw console.error("Error creating tag:",V),V}},xn=()=>{if(!R){a({variant:"error",message:"Please select a project first"});return}Gt(!0),A(!1)},pn=()=>{if(!R){a({variant:"error",title:"No Project Selected",message:"Please select a project first before importing tags.",duration:3e3});return}jt(!0)},gn=P=>{a({variant:"success",title:"Import Successful",message:`Successfully imported ${P} tags.`,duration:5e3}),d()},fn=async P=>{if(!R){alert("Please select a project first"),a({variant:"error",message:"Please select a project first"});return}try{const V=await ne.exportTags({project_id:R,format:P});a({variant:"success",message:V.message}),A(!1)}catch(V){console.error("Error exporting tags:",V),a({variant:"error",message:"Failed to export tags: "+(V instanceof Error?V.message:"Unknown error")})}},vt=(P,V)=>{const le=V==="all"||V===""?void 0:V;if(P==="isAIGenerated"){T({isAIGenerated:le==="true"?!0:le==="false"?!1:void 0});return}if(P==="dataType"){T({dataType:le});return}if(P==="tagType"){T({tagType:le});return}T({[P]:le})},yn=()=>{T({projectId:R||void 0,search:void 0,vendor:void 0,type:void 0,dataType:void 0,scope:void 0,tagType:void 0,isAIGenerated:void 0})};return e.jsxs("div",{className:"flex flex-col h-full bg-background text-primary",children:[S&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mx-6 mt-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:S}),e.jsx("button",{onClick:y,className:"text-red-500 hover:text-red-700",children:e.jsx(Ie,{className:"w-4 h-4"})})]})}),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"sticky top-0 z-30 bg-white border-b border-light px-6 py-4 flex justify-between items-center shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-primary",children:"Tag Database Manager"}),R&&e.jsxs("div",{className:"text-sm text-secondary mt-1",children:["Project ID: ",R,J.length>0&&e.jsxs("span",{className:"ml-2",children:["-"," ",J.find(P=>P.id===R)?.project_name||"Unknown Project"]})]})]}),!t&&e.jsx("div",{className:"flex items-center gap-2",children:i?e.jsxs("div",{className:"flex items-center gap-1 text-yellow-600",children:[e.jsx(ft,{className:"w-4 h-4 animate-pulse"}),e.jsx("span",{className:"text-xs",children:"Connecting..."})]}):n?e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(ga,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Live Sync"}),Ae&&e.jsxs("span",{className:"text-xs text-gray-500",children:["(Updated"," ",Math.round((Date.now()-Ae)/1e3),"s ago)"]})]}):e.jsxs("div",{className:"flex items-center gap-1 text-red-600",children:[e.jsx(pa,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Offline"})]})})]}),e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsxs("button",{onClick:pn,disabled:p||!R,className:"bg-primary text-white px-4 py-2 rounded-md flex items-center gap-2 text-sm hover:bg-primary transition-colors cursor-pointer disabled:opacity-50",title:"Import Beckhoff tags from CSV or XML files",children:[e.jsx(_t,{className:"w-4 h-4"}),"Import Tags"]}),e.jsx("div",{className:"relative",ref:_,children:g&&e.jsx("div",{className:"absolute right-0 mt-2 bg-white border border-light rounded-md shadow-md w-56 z-50",children:["Rockwell CSV","TIA XML","Beckhoff XLS"].map(P=>e.jsx("div",{onClick:()=>fn(P.toLowerCase()),className:"px-4 py-2 text-sm hover:bg-gray-100 cursor-pointer transition",children:P},P))})}),e.jsxs("button",{onClick:xn,disabled:p||!R||w.length===0,className:"bg-primary border border-light px-4 py-2 rounded-md flex items-center gap-2 text-sm hover:bg-primary transition-colors cursor-pointer disabled:opacity-50 text-white hover:text-white",title:w.length===0?"No tags to export. Please add tags first.":"Export tags in vendor-specific formats",children:[e.jsx(Ze,{className:"w-4 h-4"}),"Export your tags"]}),e.jsx("button",{onClick:d,disabled:p,className:"bg-white border border-light px-2 py-2 rounded-md text-sm hover:bg-accent-light transition-colors cursor-pointer disabled:opacity-50",children:e.jsx(Ne,{className:`w-4 h-4 ${p?"animate-spin":""}`})})]})]}),e.jsxs("div",{className:"sticky top-[64px] z-20 bg-white border-b border-light px-6 py-3 flex flex-wrap items-center gap-4",children:[e.jsx("input",{type:"text",placeholder:"Search tags...",value:N.search||"",onChange:P=>vt("search",P.target.value),className:"border border-light rounded px-4 py-2 text-sm w-64 focus:outline-none focus:ring-2 focus:ring-accent"}),e.jsxs("select",{value:N.vendor||"all",onChange:P=>vt("vendor",P.target.value),className:"border border-light rounded px-3 py-2 text-sm cursor-pointer focus:outline-none focus:ring-2 focus:ring-accent",children:[e.jsx("option",{value:"all",children:"All Vendors"}),e.jsx("option",{value:"rockwell",children:"Rockwell"}),e.jsx("option",{value:"siemens",children:"Siemens"}),e.jsx("option",{value:"beckhoff",children:"Beckhoff"})]}),e.jsxs("select",{value:N.tagType||"all",onChange:P=>vt("tagType",P.target.value),className:"border border-light rounded px-3 py-2 text-sm cursor-pointer focus:outline-none focus:ring-2 focus:ring-accent",children:[e.jsx("option",{value:"all",children:"All Tag Types"}),e.jsx("option",{value:"input",children:"Input"}),e.jsx("option",{value:"output",children:"Output"}),e.jsx("option",{value:"memory",children:"Memory"})]}),e.jsxs("select",{value:N.type||"all",onChange:P=>vt("type",P.target.value),className:"border border-light rounded px-3 py-2 text-sm cursor-pointer focus:outline-none focus:ring-2 focus:ring-accent",children:[e.jsx("option",{value:"all",children:"All Data Types"}),e.jsx("option",{value:"BOOL",children:"BOOL"}),e.jsx("option",{value:"INT",children:"INT"}),e.jsx("option",{value:"REAL",children:"REAL"}),e.jsx("option",{value:"DINT",children:"DINT"}),e.jsx("option",{value:"STRING",children:"STRING"})]}),e.jsxs("select",{value:N.scope||"all",onChange:P=>vt("scope",P.target.value),className:"border border-light rounded px-3 py-2 text-sm cursor-pointer focus:outline-none focus:ring-2 focus:ring-accent",children:[e.jsx("option",{value:"all",children:"All Scopes"}),e.jsx("option",{value:"global",children:"Global"}),e.jsx("option",{value:"local",children:"Local"}),e.jsx("option",{value:"input",children:"Input"}),e.jsx("option",{value:"output",children:"Output"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:N.isAIGenerated||!1,onChange:P=>T({isAIGenerated:P.target.checked?!0:void 0}),className:"accent-primary cursor-pointer"}),"Show AI-generated only"]}),e.jsxs("button",{onClick:mn,disabled:p,className:"bg-primary text-white px-4 py-2 rounded text-sm hover:bg-secondary transition-colors flex items-center gap-2 disabled:opacity-50",children:[e.jsx(pt,{className:"w-4 h-4"}),"Add Tag"]})]}),p&&e.jsxs("div",{className:"flex justify-center items-center py-8",children:[e.jsx(Ne,{className:"w-6 h-6 animate-spin text-primary"}),e.jsx("span",{className:"ml-2 text-primary",children:"Loading tags..."})]}),e.jsxs("div",{className:"flex-1 px-6 py-4 pb-32 overflow-auto",children:[e.jsxs("div",{className:"bg-white border border-light rounded-md shadow-sm overflow-hidden",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-light",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3 text-sm font-medium text-primary",children:"Tag Name"}),e.jsx("th",{className:"text-left p-3 text-sm font-medium text-primary",children:"Description"}),e.jsx("th",{className:"text-left p-3 text-sm font-medium text-primary",children:"Type"}),e.jsx("th",{className:"text-left p-3 text-sm font-medium text-primary",children:"Data Type"}),e.jsx("th",{className:"text-left p-3 text-sm font-medium text-primary",children:"Address"}),e.jsx("th",{className:"text-left p-3 text-sm font-medium text-primary",children:"Default"}),e.jsx("th",{className:"text-left p-3 text-sm font-medium text-primary",children:"Vendor"}),e.jsx("th",{className:"text-left p-3 text-sm font-medium text-primary",children:"Scope"}),e.jsx("th",{className:"text-left p-3 text-sm font-medium text-primary",children:"Actions"})]})}),e.jsx("tbody",{children:Se.map(P=>e.jsxs("tr",{className:"border-b border-light hover:bg-gray-50",children:[e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[O===P.id?e.jsx("input",{type:"text",value:L[P.id]?.name??P.name,onChange:V=>se(P.id,"name",V.target.value),className:"border border-light rounded px-2 py-1 text-sm w-full font-mono",autoFocus:!0}):e.jsx("span",{className:"font-mono text-sm",children:P.name}),P.is_ai_generated&&e.jsx("span",{className:"text-xs bg-purple-100 text-purple-700 px-1 rounded",children:"AI"})]})}),e.jsx("td",{className:"p-3",children:O===P.id?e.jsx("input",{type:"text",value:L[P.id]?.description??P.description,onChange:V=>se(P.id,"description",V.target.value),className:"border border-light rounded px-2 py-1 text-sm w-full"}):e.jsx("span",{className:"text-sm text-muted",children:P.description})}),e.jsx("td",{className:"p-3",children:O===P.id?e.jsxs("select",{value:L[P.id]?.tag_type??P.tag_type,onChange:V=>se(P.id,"tag_type",V.target.value),className:"border border-light rounded px-2 py-1 text-sm",children:[e.jsx("option",{value:"input",children:"Input"}),e.jsx("option",{value:"output",children:"Output"}),e.jsx("option",{value:"memory",children:"Memory"})]}):e.jsx("span",{className:`text-xs px-2 py-1 rounded ${P.tag_type==="input"?"bg-blue-100 text-blue-700":P.tag_type==="output"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:P.tag_type.charAt(0).toUpperCase()+P.tag_type.slice(1)})}),e.jsx("td",{className:"p-3",children:O===P.id?e.jsx("select",{value:L[P.id]?.type??P.type,onChange:V=>se(P.id,"type",V.target.value),className:"border border-light rounded px-2 py-1 text-sm",children:Zd(P.vendor).map(V=>e.jsx("option",{value:V,children:V},V))}):e.jsx("span",{className:"text-sm font-mono",children:P.type})}),e.jsx("td",{className:"p-3",children:O===P.id?e.jsx("input",{type:"text",value:L[P.id]?.address??P.address,onChange:V=>se(P.id,"address",V.target.value),className:"border border-light rounded px-2 py-1 text-sm font-mono w-20"}):e.jsx("span",{className:"text-sm font-mono text-muted",children:P.address})}),e.jsx("td",{className:"p-3",children:O===P.id?e.jsx("input",{type:"text",value:L[P.id]?.default_value??P.default_value,onChange:V=>se(P.id,"default_value",V.target.value),className:"border border-light rounded px-2 py-1 text-sm font-mono w-16"}):e.jsx("span",{className:"text-sm font-mono text-muted",children:P.default_value})}),e.jsx("td",{className:"p-3",children:O===P.id?e.jsxs("select",{value:L[P.id]?.vendor??P.vendor,onChange:V=>se(P.id,"vendor",V.target.value),className:"border border-light rounded px-2 py-1 text-sm",children:[e.jsx("option",{value:"rockwell",children:"Rockwell"}),e.jsx("option",{value:"siemens",children:"Siemens"}),e.jsx("option",{value:"beckhoff",children:"Beckhoff"})]}):e.jsx("span",{className:`text-xs px-2 py-1 rounded ${P.vendor==="rockwell"?"bg-red-100 text-red-700":P.vendor==="siemens"?"bg-teal-100 text-teal-700":"bg-orange-100 text-orange-700"}`,children:P.vendor.charAt(0).toUpperCase()+P.vendor.slice(1)})}),e.jsx("td",{className:"p-3",children:O===P.id?e.jsxs("select",{value:L[P.id]?.scope??P.scope,onChange:V=>se(P.id,"scope",V.target.value),className:"border border-light rounded px-2 py-1 text-sm",children:[e.jsx("option",{value:"global",children:"Global"}),e.jsx("option",{value:"local",children:"Local"}),e.jsx("option",{value:"input",children:"Input"}),e.jsx("option",{value:"output",children:"Output"})]}):e.jsx("span",{className:"text-sm",children:P.scope})}),e.jsx("td",{className:"p-3",children:e.jsx("div",{className:"flex gap-1",children:O===P.id?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>un(P.id.toString()),className:"p-1 text-green-600 hover:bg-green-100 rounded",title:"Save",children:e.jsx(rr,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{U(V=>{const le={...V};return delete le[P.id],le}),D(null)},className:"p-1 text-gray-600 hover:bg-gray-100 rounded",title:"Cancel",children:e.jsx(Ie,{className:"w-4 h-4"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>D(P.id),className:"p-1 text-blue-600 hover:bg-blue-100 rounded",title:"Edit",children:e.jsx(ni,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ie(P),className:"p-1 text-red-600 hover:bg-red-100 rounded",title:"Delete",children:e.jsx(Ft,{className:"w-4 h-4"})})]})})})]},P.id))})]}),Se.length===0&&!p&&e.jsxs("div",{className:"text-center py-8 text-muted",children:[e.jsx("div",{className:"mb-2",children:"No tags match your current filters"}),e.jsx("button",{onClick:yn,className:"text-accent hover:underline text-sm",children:"Clear all filters"})]})]}),C.total>0&&e.jsxs("div",{className:"mt-4 text-center text-sm text-muted",children:["Showing ",Se.length," of ",C.total," tags (Page"," ",C.page," of ",C.totalPages,")"]})]}),e.jsx(De,{isOpen:oe,onClose:xr,title:"Confirm Delete",size:"md",actions:e.jsxs(e.Fragment,{children:[e.jsx(F,{variant:"outline",onClick:xr,disabled:ze,children:"Cancel"}),e.jsx(F,{variant:"primary",onClick:B,loading:ze,className:"bg-red-600 hover:bg-red-700 text-white",children:ze?"Deleting...":"Delete Tag"})]}),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(It,{className:"w-6 h-6 text-red-600"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-gray-900 mb-2",children:["Are you sure you want to delete the tag"," ",e.jsxs("strong",{children:['"',G?.name,'"']}),"?"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"This action cannot be undone. The tag will be permanently removed from the database."}),G&&e.jsx("div",{className:"mt-3 p-3 bg-gray-50 rounded border text-sm",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Type:"})," ",G.type]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Address:"})," ",G.address]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Vendor:"})," ",G.vendor]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Scope:"})," ",G.scope]})]})})]})]})}),R&&e.jsx(Qd,{isOpen:Y,onClose:()=>W(!1),onSuccess:()=>W(!1),projectId:R,onCreate:hn}),R&&We&&e.jsx(Vd,{isOpen:Ts,onClose:()=>Gt(!1),projectId:R,projectName:We.project_name,tags:w}),R&&We&&e.jsx(Ud,{isOpen:Wt,onClose:()=>jt(!1),projectId:R,projectName:We.project_name,onSuccess:gn})]})]})},as=t=>e.jsx(_d,{children:e.jsx(eu,{...t})});function tu(){const t=he(),s=Rt(),{user:r,organizations:a,selectedOrg:o,logout:n,isAuthenticated:i,isLoading:c}=Le(),[m,u]=l.useState("overview"),[h,f]=l.useState(!1),[b,w]=l.useState(!1);l.useEffect(()=>{!c&&!i&&t("/signin",{replace:!0})},[c,i,t]);const[p,S]=l.useState({name:r?.fullName||"Loading...",email:r?.email||"Loading...",company:o?.org_name||"Loading...",timezone:"America/New_York",language:"English",tier:"Enterprise",lastLogin:"Loading..."});l.useEffect(()=>{r&&o&&S(D=>({...D,name:r.fullName,email:r.email,company:o.org_name||"Unknown Organization",tier:o.role||"Enterprise"}))},[r,o]);const[N,C]=l.useState({defaultVendor:"Rockwell",defaultExportFormat:"PDF",documentBranding:!0,aiVerbosity:"Detailed",defaultModule:"Logic Studio",codeFontSize:14,notifications:{system:!0,aiUpdates:!0,docGeneration:!1}}),[k]=l.useState([{name:"Sarah Johnson",email:"sarah@example.com",role:"Admin",lastActive:"2 hours ago"},{name:"Mike Davis",email:"mike@example.com",role:"Engineer",lastActive:"1 day ago"},{name:"Lisa Chen",email:"lisa@example.com",role:"Viewer",lastActive:"3 days ago"}]),[j]=l.useState([{name:"Production API",created:"Jul 15, 2025",lastUsed:"Aug 4, 2025",key:"pk_live_..."},{name:"Development API",created:"Jun 22, 2025",lastUsed:"Aug 2, 2025",key:"pk_test_..."}]),v=D=>{console.log(`Saving ${D} changes`),alert(`${D} settings saved successfully!`)},x=()=>{const D=s.state?.from;if(D)t(D);else{const L=window.history.length>1;t(L?-1:"/home")}},T=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white border border-light rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Profile Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Full Name"}),e.jsx("input",{type:"text",value:p.name,onChange:D=>S(L=>({...L,name:D.target.value})),className:"w-full border border-light rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-accent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email Address"}),e.jsx("input",{type:"email",value:p.email,onChange:D=>S(L=>({...L,email:D.target.value})),className:"w-full border border-light rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-accent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Company Name"}),e.jsx("input",{type:"text",value:p.company,onChange:D=>S(L=>({...L,company:D.target.value})),className:"w-full border border-light rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-accent",disabled:!0,placeholder:"Based on current organization"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Timezone"}),e.jsxs("select",{value:p.timezone,onChange:D=>S(L=>({...L,timezone:D.target.value})),className:"w-full border border-light rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-accent",children:[e.jsx("option",{value:"America/New_York",children:"Eastern Time (EST/EDT)"}),e.jsx("option",{value:"America/Chicago",children:"Central Time (CST/CDT)"}),e.jsx("option",{value:"America/Denver",children:"Mountain Time (MST/MDT)"}),e.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time (PST/PDT)"}),e.jsx("option",{value:"UTC",children:"UTC"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Language"}),e.jsxs("select",{value:p.language,onChange:D=>S(L=>({...L,language:D.target.value})),className:"w-full border border-light rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-accent",children:[e.jsx("option",{value:"English",children:"English"}),e.jsx("option",{value:"Spanish",children:"Espaol"}),e.jsx("option",{value:"German",children:"Deutsch"}),e.jsx("option",{value:"French",children:"Franais"})]})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Company Logo (Optional)"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx(_t,{className:"w-8 h-8 text-muted mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-muted",children:"Upload PNG logo for document exports"}),e.jsx("button",{className:"mt-2 text-accent hover:underline text-sm",children:"Browse Files"})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Notification Preferences"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:!0,className:"accent-primary"}),e.jsx("span",{className:"text-sm",children:"System alerts and maintenance notifications"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:!0,className:"accent-primary"}),e.jsx("span",{className:"text-sm",children:"AI model updates and new features"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"accent-primary"}),e.jsx("span",{className:"text-sm",children:"Document generation completion alerts"})]})]})]}),e.jsxs("button",{onClick:()=>v("Profile"),className:"mt-6 bg-primary text-white px-6 py-2 rounded flex items-center gap-2 hover:bg-secondary transition-colors",children:[e.jsx(He,{className:"w-4 h-4"}),"Save Changes"]})]}),e.jsxs("div",{className:"bg-white border border-light rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Organization & Account Details"}),a.length>1&&e.jsxs("span",{className:"text-xs text-muted bg-blue-50 px-2 py-1 rounded",children:[a.length," organizations"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-4 rounded-lg border border-blue-100",children:[e.jsx("label",{className:"block text-sm font-medium text-blue-900 mb-2",children:"Current Organization"}),e.jsx("p",{className:"text-lg font-semibold text-blue-900",children:o?.org_name||"Loading..."}),e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:o?.industry||"Industry not specified"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted mb-2",children:"Your Role & Permissions"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`inline-flex px-3 py-1 rounded-full text-sm font-medium ${o?.role==="Admin"?"bg-red-100 text-red-800 border border-red-200":o?.role==="Editor"?"bg-blue-100 text-blue-800 border border-blue-200":o?.role==="Viewer"?"bg-green-100 text-green-800 border border-green-200":"bg-gray-100 text-gray-800 border border-gray-200"}`,children:o?.role||"Loading..."}),e.jsx("span",{className:"text-sm text-muted",children:o?.role==="Admin"?"Full system access":o?.role==="Editor"?"Create & modify content":o?.role==="Viewer"?"View-only access":""})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted mb-1",children:"Account Security"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Two-Factor Authentication"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${r?.twoFactorEnabled?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:`text-sm font-medium ${r?.twoFactorEnabled?"text-green-700":"text-red-700"}`,children:r?.twoFactorEnabled?"Enabled":"Disabled"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Account ID"}),e.jsx("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded font-mono",children:r?.userId?.substring(0,8)||"..."})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted mb-1",children:"Organization Details"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted",children:"Size:"}),e.jsx("span",{className:"font-medium",children:o?.size||"Not specified"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted",children:"License:"}),e.jsx("span",{className:"font-medium",children:"On-Premise"})]})]})]})]})]}),a&&a.length>1&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-light",children:[e.jsxs("h4",{className:"text-sm font-medium mb-3",children:["Your Organizations (",a.length,")"]}),e.jsx("div",{className:"space-y-2",children:a.map(D=>e.jsx("div",{className:`p-3 rounded-lg border ${D.org_id===o?.org_id?"border-accent bg-accent/5":"border-light"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:D.org_name}),e.jsx("p",{className:"text-sm text-muted",children:D.industry||"Industry not specified"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:`inline-flex px-2 py-1 rounded text-xs font-medium ${D.role==="Admin"?"bg-red-100 text-red-700":D.role==="Editor"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:D.role}),D.org_id===o?.org_id&&e.jsx("p",{className:"text-xs text-accent mt-1",children:"Current"})]})]})},D.org_id))})]})]})]}),y=()=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white border border-light rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Platform Preferences"}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Default PLC Vendor"}),e.jsxs("select",{value:N.defaultVendor,onChange:D=>C(L=>({...L,defaultVendor:D.target.value})),className:"w-full border border-light rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-accent",children:[e.jsx("option",{value:"Rockwell",children:"Rockwell Automation"}),e.jsx("option",{value:"Siemens",children:"Siemens"}),e.jsx("option",{value:"Beckhoff",children:"Beckhoff"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Default Export Format"}),e.jsxs("select",{value:N.defaultExportFormat,onChange:D=>C(L=>({...L,defaultExportFormat:D.target.value})),className:"w-full border border-light rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-accent",children:[e.jsx("option",{value:"PDF",children:"PDF"}),e.jsx("option",{value:"DOCX",children:"Microsoft Word (DOCX)"}),e.jsx("option",{value:"ZIP",children:"ZIP Bundle"}),e.jsx("option",{value:"XLSX",children:"Excel (XLSX)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"AI Assistant Behavior"}),e.jsxs("select",{value:N.aiVerbosity,onChange:D=>C(L=>({...L,aiVerbosity:D.target.value})),className:"w-full border border-light rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-accent",children:[e.jsx("option",{value:"Brief",children:"Brief replies"}),e.jsx("option",{value:"Detailed",children:"Detailed explanations"}),e.jsx("option",{value:"Verbose",children:"Verbose with examples"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Default Module on Login"}),e.jsxs("select",{value:N.defaultModule,onChange:D=>C(L=>({...L,defaultModule:D.target.value})),className:"w-full border border-light rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-accent",children:[e.jsx("option",{value:"Pandaura AS",children:"Pandaura AS"}),e.jsx("option",{value:"Logic Studio",children:"Logic Studio"}),e.jsx("option",{value:"AutoDocs",children:"AutoDocs"}),e.jsx("option",{value:"Tag Database Manager",children:"Tag Database Manager"}),e.jsx("option",{value:"Projects",children:"Projects"})]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:N.documentBranding,onChange:D=>C(L=>({...L,documentBranding:D.target.checked})),className:"accent-primary"}),e.jsx("span",{className:"text-sm",children:"Include company branding on exported documents"})]})}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Code Editor Font Size"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"range",min:"10",max:"20",value:N.codeFontSize,onChange:D=>C(L=>({...L,codeFontSize:parseInt(D.target.value)})),className:"flex-1"}),e.jsxs("span",{className:"text-sm font-mono bg-gray-100 px-2 py-1 rounded",children:[N.codeFontSize,"px"]})]})]}),e.jsxs("button",{onClick:()=>v("Preferences"),className:"mt-6 bg-primary text-white px-6 py-2 rounded flex items-center gap-2 hover:bg-secondary transition-colors",children:[e.jsx(He,{className:"w-4 h-4"}),"Save Preferences"]})]})}),d=()=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white border border-light rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Team Management"}),e.jsx("span",{className:"text-sm bg-blue-100 text-blue-700 px-3 py-1 rounded",children:"Enterprise Plan"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Invite New Member"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"email",placeholder:"Enter email address...",className:"flex-1 border border-light rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-accent"}),e.jsxs("select",{className:"border border-light rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-accent",children:[e.jsx("option",{value:"Engineer",children:"Engineer"}),e.jsx("option",{value:"Admin",children:"Admin"}),e.jsx("option",{value:"Viewer",children:"Viewer"})]}),e.jsx("button",{className:"bg-primary text-white px-4 py-2 rounded hover:bg-secondary transition-colors",children:"Invite"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Team Members (3/10 seats used)"}),e.jsx("div",{className:"space-y-2",children:k.map((D,L)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:D.name}),e.jsx("div",{className:"text-xs text-muted",children:D.email})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-xs text-muted",children:D.lastActive}),e.jsx("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded",children:D.role}),e.jsx("button",{className:"text-muted hover:text-red-500",children:e.jsx(Ys,{className:"w-4 h-4"})})]})]},L))})]})]})}),g=()=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white border border-light rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Security & Authentication"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Change Password"}),e.jsxs("div",{className:"space-y-3 max-w-md",children:[e.jsx("input",{type:"password",placeholder:"Current password",className:"w-full border border-light rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-accent"}),e.jsx("input",{type:"password",placeholder:"New password",className:"w-full border border-light rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-accent"}),e.jsx("input",{type:"password",placeholder:"Confirm new password",className:"w-full border border-light rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-accent"}),e.jsx("button",{className:"bg-primary text-white px-4 py-2 rounded text-sm hover:bg-secondary transition-colors",children:"Update Password"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Two-Factor Authentication"}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qe,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"text-sm",children:"2FA is enabled via TOTP app"})]}),e.jsx("button",{onClick:()=>w(!0),className:"text-sm text-green-600 hover:underline",children:"Manage"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Active Sessions"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ma,{className:"w-4 h-4 text-muted"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:"Current Session"}),e.jsx("div",{className:"text-xs text-muted",children:"Chrome on macOS  192.168.1.100"})]})]}),e.jsx("span",{className:"text-xs text-green-600",children:"Active"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ti,{className:"w-4 h-4 text-muted"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm",children:"Mobile Browser"}),e.jsx("div",{className:"text-xs text-muted",children:"Safari on iOS  2 hours ago"})]})]}),e.jsx("button",{className:"text-xs text-red-600 hover:underline",children:"Terminate"})]})]}),e.jsx("button",{className:"mt-3 text-sm text-red-600 hover:underline",children:"Sign Out Everywhere"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Session Timeout"}),e.jsxs("select",{className:"border border-light rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-accent",children:[e.jsx("option",{value:"30",children:"30 minutes"}),e.jsx("option",{value:"120",children:"2 hours"}),e.jsx("option",{value:"480",children:"8 hours"}),e.jsx("option",{value:"never",children:"Never"})]})]})]})]})}),A=()=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white border border-light rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"API Keys"}),e.jsx("button",{className:"bg-primary text-white px-4 py-2 rounded text-sm hover:bg-secondary transition-colors",children:"Generate New Key"})]}),e.jsx("div",{className:"space-y-3",children:j.map((D,L)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-light rounded",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:D.name}),e.jsxs("div",{className:"text-xs text-muted",children:["Created: ",D.created,"  Last used: ",D.lastUsed]}),e.jsxs("div",{className:"text-xs font-mono bg-gray-100 px-2 py-1 rounded mt-1 inline-block",children:[D.key,""]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"text-sm text-muted hover:text-primary",children:"Regenerate"}),e.jsx("button",{className:"text-sm text-red-600 hover:text-red-700",children:"Revoke"})]})]},L))}),e.jsx("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(It,{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"On-Premise Security:"})," API keys are stored locally and encrypted. All API calls are processed within your network infrastructure."]})]})})]})}),O=[{id:"overview",label:"Overview",icon:ha},{id:"preferences",label:"Preferences",icon:nr},...p.tier!=="Individual"?[{id:"team",label:"Team Settings",icon:bs}]:[],{id:"billing",label:"Billing & Plan",icon:so},{id:"api",label:"API Keys",icon:ko},{id:"security",label:"Security / 2FA",icon:qe}];return e.jsxs("div",{className:"flex flex-col h-screen bg-background",children:[c||!r?e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-primary border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-muted",children:"Loading profile..."})]})}):e.jsxs(e.Fragment,{children:[e.jsx("header",{className:"bg-white border-b border-light px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:x,className:"p-2 hover:bg-gray-100 rounded-md transition-colors flex items-center gap-2 text-muted hover:text-primary",title:"Go back",children:[e.jsx(Oe,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm",children:"Back"})]}),e.jsx("div",{className:"w-12 h-12 bg-primary text-white rounded-full flex items-center justify-center font-bold text-lg",children:p.name?p.name.split(" ").map(D=>D[0]).join(""):"??"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:p.name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${o?.role==="Admin"?"bg-red-100 text-red-700":o?.role==="Editor"?"bg-blue-100 text-blue-700":o?.role==="Viewer"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:o?.role||p.tier}),o?.org_name&&e.jsxs("span",{children:["@ ",o.org_name]}),e.jsx("span",{children:""}),e.jsxs("span",{children:["Last login: ",p.lastLogin]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{className:"text-sm text-muted hover:text-primary",children:"Edit Profile"}),e.jsxs("button",{onClick:()=>{n(),t("/signin")},className:"flex items-center gap-2 px-3 py-2 text-sm text-red-600 hover:text-red-700 hover:bg-red-50 rounded-md transition-colors",children:[e.jsx(Ys,{className:"w-4 h-4"}),"Sign Out"]})]})]})}),e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsx("nav",{className:"w-64 bg-white border-r border-light p-4",children:e.jsx("div",{className:"space-y-1",children:O.map(D=>{const L=D.icon;return e.jsxs("button",{onClick:()=>u(D.id),className:`w-full flex items-center gap-3 px-3 py-2 rounded text-left transition-colors ${m===D.id?"bg-accent-light text-accent":"text-muted hover:text-primary hover:bg-gray-50"}`,children:[e.jsx(L,{className:"w-4 h-4"}),D.label]},D.id)})})}),e.jsxs("main",{className:"flex-1 p-6 overflow-y-auto",children:[m==="overview"&&T(),m==="preferences"&&y(),m==="team"&&d(),m==="security"&&g(),m==="api"&&A(),m==="billing"&&e.jsxs("div",{className:"bg-white border border-light rounded-lg p-6 text-center",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Billing & Plan Management"}),e.jsx("p",{className:"text-muted mb-4",children:"On-premise deployments use local license management"}),e.jsx("div",{className:"text-sm text-left max-w-md mx-auto",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Current Role:"}),e.jsx("span",{className:"font-medium",children:o?.role||p.tier})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Organization:"}),e.jsx("span",{className:"font-medium",children:o?.org_name||"Loading..."})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"License Type:"}),e.jsx("span",{className:"font-medium",children:"On-Premise"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Access Level:"}),e.jsx("span",{className:"font-medium",children:o?.role==="Admin"?"Full Access":o?.role==="Editor"?"Edit & View":o?.role==="Viewer"?"View Only":"Loading..."})]})]})})]})]})]})]}),e.jsx(Ha,{})]})}function su(){return e.jsx("div",{className:"flex items-center justify-center h-screen bg-background",children:e.jsxs("div",{className:"flex flex-col items-center space-y-6",children:[e.jsx("img",{src:je,alt:"Pandaura Logo",className:"h-48 w-auto animate-pulse filter-none",style:{filter:"none",imageRendering:"crisp-edges"}}),e.jsx("p",{className:"text-primary text-lg font-semibold animate-pulse",children:"Loading Pandaura..."})]})})}function ru({email:t,onVerify:s,onBack:r,isLoading:a=!1}){const[o,n]=l.useState(""),[i,c]=l.useState(!1),[m,u]=l.useState(""),[h,f]=l.useState(0);l.useEffect(()=>{o.length===6&&!a&&b()},[o,a]);const b=async()=>{if(o.length!==6){u("Please enter a 6-digit code");return}u("");try{const S=await s(o,i);S.success||(f(N=>N+1),u(S.message||"Invalid authentication code"),n(""))}catch(S){f(N=>N+1),u(S.message||"Verification failed"),n("")}},w=S=>{const N=S.target.value.replace(/[^0-9]/g,"");N.length<=6&&(n(N),u(""))},p=S=>{S.key==="Enter"&&o.length===6&&!a&&b()};return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-background relative overflow-hidden py-20 px-4",children:[e.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-accent/5 to-transparent"})}),e.jsxs("div",{className:"z-10 mb-8 flex flex-col items-center",children:[e.jsx("img",{src:je,alt:"Pandaura AS Logo",className:"h-16 w-auto filter-none",style:{filter:"none",imageRendering:"crisp-edges"}}),e.jsx("h1",{className:"text-2xl font-bold text-primary text-center mt-3",children:"Two-Factor Authentication"}),e.jsxs("p",{className:"text-sm text-muted text-center mt-2 max-w-md",children:["Enter the 6-digit code from your authenticator app for ",e.jsx("strong",{children:t})]})]}),e.jsx("div",{className:"w-full max-w-sm bg-surface border border-light rounded-lg shadow-card z-10 p-8",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"twofa-code",name:"twofa-code",type:"text",inputMode:"numeric",pattern:"[0-9]*",required:!0,autoFocus:!0,autoComplete:"one-time-code",maxLength:6,value:o,onChange:w,onKeyPress:p,disabled:a,className:"peer w-full px-4 pt-6 pb-3 bg-surface text-primary border border-light rounded-md shadow-sm outline-none focus:ring-2 focus:ring-accent focus:border-accent placeholder-transparent transition-all text-center text-2xl tracking-[0.5em] font-mono",placeholder:"000000"}),e.jsx("label",{htmlFor:"twofa-code",className:`absolute left-4 top-2 text-sm text-muted transition-all \r
                           peer-focus:text-xs peer-focus:text-secondary`,children:"Authentication Code"})]}),e.jsx("div",{className:"flex justify-center space-x-2",children:Array.from({length:6},(S,N)=>e.jsx("div",{className:`w-3 h-3 rounded-full transition-all ${N<o.length?"bg-accent":"bg-light"}`},N))}),e.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer text-sm text-muted mt-4",children:[e.jsx("input",{type:"checkbox",checked:i,onChange:S=>c(S.target.checked),disabled:a,className:"w-4 h-4 text-primary bg-surface border-strong rounded focus:ring-accent focus:ring-2"}),e.jsx("span",{children:"Trust this device for 30 days"})]})]}),m&&e.jsxs("div",{className:"text-error text-sm text-center bg-error-light border border-error/20 rounded-md p-3 flex items-center justify-center",children:[e.jsx(be,{className:"w-4 h-4 mr-2"}),m,h>0&&e.jsxs("span",{className:"ml-2 text-xs",children:["(Attempt ",h,"/5)"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{type:"button",onClick:b,disabled:o.length!==6||a,className:"w-full bg-primary hover:bg-secondary disabled:bg-disabled disabled:text-muted text-white py-3 rounded-md shadow-sm transition-all duration-200 focus:ring-2 focus:ring-accent focus:ring-offset-2 font-medium",children:a?e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"w-4 h-4 mr-2 animate-spin inline"}),"Verifying..."]}):"Verify & Sign In"}),e.jsxs("button",{type:"button",onClick:r,disabled:a,className:"w-full text-muted hover:text-primary text-sm transition-colors flex items-center justify-center",children:[e.jsx(Oe,{className:"w-4 h-4 mr-1"}),"Back to login"]})]}),h>=3&&e.jsx("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-amber-800",children:[e.jsx("strong",{children:"Having trouble?"})," Make sure your device's time is synchronized and you're using the latest code from your authenticator app."]})})]})}),e.jsx("div",{className:"mt-8 pt-4 text-center space-x-4 text-xs text-muted z-10",children:e.jsx("span",{children:"Need help? Contact your system administrator"})})]})}function au({organizations:t,onOrgSelect:s,userEmail:r,isLoading:a=!1}){const[o,n]=l.useState(null),i=()=>{o&&s(o)},c=u=>{switch(u){case"Admin":return"text-red-600 bg-red-50 border-red-200";case"Editor":return"text-blue-600 bg-blue-50 border-blue-200";case"Viewer":return"text-green-600 bg-green-50 border-green-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},m=u=>u?{startup:"1-10 employees",small:"11-50 employees",medium:"51-200 employees",large:"201-1000 employees",enterprise:"1000+ employees"}[u]||u:"";return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-background relative overflow-hidden py-20 px-4",children:[e.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-accent/5 to-transparent"})}),e.jsxs("div",{className:"z-10 mb-8 flex flex-col items-center",children:[e.jsx("img",{src:je,alt:"Pandaura AS Logo",className:"h-16 w-auto filter-none",style:{filter:"none",imageRendering:"crisp-edges"}}),e.jsx("h1",{className:"text-2xl font-bold text-primary text-center mt-3",children:"Select Organization"}),e.jsx("p",{className:"text-sm text-muted text-center mt-2 max-w-md",children:"You have access to multiple organizations. Choose which one to sign in to."}),e.jsxs("p",{className:"text-xs text-secondary text-center mt-1",children:["Signed in as: ",e.jsx("strong",{children:r})]})]}),e.jsx("div",{className:"w-full max-w-md bg-surface border border-light rounded-lg shadow-card z-10 p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-primary mb-4",children:"Your Organizations"}),e.jsx("div",{className:"space-y-3",children:t.map(u=>e.jsx("div",{children:e.jsxs("label",{className:`flex items-center p-4 border-2 rounded-lg cursor-pointer transition-all hover:border-accent/50 ${o?.org_id===u.org_id?"border-accent bg-accent/5":"border-light bg-transparent"}`,children:[e.jsx("input",{type:"radio",name:"organization",value:u.org_id,checked:o?.org_id===u.org_id,onChange:()=>n(u),disabled:a,className:"sr-only"}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(sr,{className:"w-8 h-8 text-accent"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold text-primary",children:u.org_name}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("span",{className:`inline-flex px-2 py-1 rounded-full text-xs font-medium border ${c(u.role)}`,children:u.role}),u.industry&&e.jsx("span",{className:"text-xs text-muted",children:u.industry})]}),u.size&&e.jsxs("p",{className:"text-xs text-muted mt-1 flex items-center",children:[e.jsx(bs,{className:"w-3 h-3 mr-1"}),m(u.size)]})]})]}),o?.org_id===u.org_id&&e.jsx(Qe,{className:"w-5 h-5 text-accent flex-shrink-0"})]})})]})},u.org_id))}),e.jsx("div",{className:"pt-4",children:e.jsx(F,{onClick:i,disabled:!o||a,className:"w-full",children:a?"Signing in...":"Continue"})})]})}),e.jsx("div",{className:"mt-8 pt-4 text-center text-xs text-muted z-10",children:e.jsx("p",{children:"You can switch organizations later from your profile settings"})})]})}const Xr=["The future of automation isn't wired  it's written.","Logic is your language. We just make it speak faster.","Great integrators don't copy-paste. They build systems that last.","Your plant doesn't wait. Neither should your tools.","Structured text. Unstructured power.","You didn't choose automation for paperwork.","Code once. Deploy everywhere. Trust always.","Real engineers ship reliable logic.","Automation that adapts, not breaks.","Your vision. Our intelligence. Perfect integration."];function nu(){const t=he(),{login:s,setSelectedOrg:r,organizations:a,isAuthenticated:o,isLoading:n}=Le(),[i,c]=l.useState(""),[m,u]=l.useState(""),[h,f]=l.useState(!1),[b,w]=l.useState(!1),[p,S]=l.useState("credentials"),[N,C]=l.useState([]),[k,j]=l.useState(""),[v,x]=l.useState(!1),[T,y]=l.useState(!1);l.useEffect(()=>{!n&&o&&!T&&t("/home",{replace:!0})},[o,n,T,t]);const[d,g]=l.useState(""),[A,O]=l.useState([]);l.useEffect(()=>{let z;return T&&(console.log(" Splash screen shown - starting 3 second timer"),z=window.setTimeout(()=>{console.log(" Splash timeout completed - navigating to home"),y(!1),t("/home")},3e3)),()=>{z&&(console.log(" Cleaning up splash timeout"),window.clearTimeout(z))}},[T,t]),l.useEffect(()=>{const z=Xr.filter(ue=>!A.includes(ue)),J=z.length>0?z:Xr,te=J[Math.floor(Math.random()*J.length)];g(te),O(ue=>[...ue,te])},[]);const D=async z=>{if(z.preventDefault(),!i.trim()||!m.trim()){j("Please enter both email and password.");return}x(!0),j("");try{const J=await s(i.trim(),m);J.requiresTwoFactor?S("twoFactor"):J.success?M():j(J.message||"Invalid credentials")}catch(J){console.error("Login error:",J),j(J.message||"Login failed. Please try again.")}finally{x(!1)}},L=async(z,J)=>{x(!0),j("");try{const te=await s(i.trim(),m,z);return te.success?(console.log(" 2FA verification successful"),J&&localStorage.setItem("pandaura_trusted_device","true"),console.log(" About to call handleSuccessfulLogin"),M(),{success:!0}):{success:!1,message:te.message||"Invalid authentication code"}}catch(te){return console.error("2FA verification error:",te),{success:!1,message:te.message||"Verification failed"}}finally{console.log(" Setting isLoading to false"),x(!1)}},U=z=>{r(z),S("complete"),t("/home")},M=()=>{console.log(" handleSuccessfulLogin called - setting showSplash to true"),y(!0)},R=()=>{S("credentials"),j("")};return console.log(" Render check - showSplash:",T,"currentStep:",p,"isLoading:",v),T?(console.log(" Showing splash screen"),e.jsx(su,{})):p==="twoFactor"?(console.log(" Showing 2FA screen"),e.jsx(ru,{email:i,onVerify:L,onBack:R,isLoading:v})):p==="orgSelection"&&N.length>1?e.jsx(au,{organizations:N,onOrgSelect:U,userEmail:i,isLoading:v}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-background relative overflow-hidden py-20 px-4",children:[e.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-accent/5 to-transparent"})}),e.jsxs("div",{className:"z-10 mb-8 flex flex-col items-center",children:[e.jsx("img",{src:je,alt:"Pandaura AS Logo",className:"h-24 w-auto filter-none",style:{filter:"none",imageRendering:"crisp-edges"}}),e.jsx("h1",{className:"text-3xl font-bold text-primary text-center mt-4",children:"Pandaura AS"}),e.jsx("h2",{className:"text-lg text-secondary text-center",children:"Industrial Automation Suite"}),d&&e.jsx("div",{className:"mt-4 text-center max-w-md animate-fade-in",children:e.jsxs("p",{className:"text-sm text-muted italic px-4 py-2 bg-surface/50 rounded-md border border-light/50",children:['"',d,'"']})})]}),e.jsxs("div",{className:"w-full max-w-sm bg-surface border border-light rounded-lg shadow-card z-10 p-8",children:[e.jsx("h3",{className:"text-xl font-semibold text-primary text-center mb-6",children:"Sign in to Pandaura AS"}),e.jsxs("form",{className:"space-y-6",onSubmit:D,autoComplete:"on",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"email",name:"email",type:"email",required:!0,autoComplete:"username",autoFocus:!0,value:i,onChange:z=>c(z.target.value),disabled:v,className:"peer w-full px-4 pt-6 pb-3 bg-surface text-primary border border-light rounded-md shadow-sm outline-none focus:ring-2 focus:ring-accent focus:border-accent placeholder-transparent transition-all disabled:opacity-50",placeholder:" "}),e.jsx("label",{htmlFor:"email",className:`absolute left-4 top-2 text-sm text-muted transition-all \r
                         peer-focus:text-xs peer-focus:text-secondary peer-placeholder-shown:text-base peer-placeholder-shown:top-4 peer-placeholder-shown:text-disabled`,children:"Email Address"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"password",name:"password",type:b?"text":"password",required:!0,autoComplete:"current-password",value:m,onChange:z=>u(z.target.value),disabled:v,className:"peer w-full px-4 pt-6 pb-3 bg-surface text-primary border border-light rounded-md shadow-sm outline-none focus:ring-2 focus:ring-accent focus:border-accent placeholder-transparent transition-all disabled:opacity-50",placeholder:" "}),e.jsx("label",{htmlFor:"password",className:`absolute left-4 top-2 text-sm text-muted transition-all \r
                         peer-focus:text-xs peer-focus:text-secondary peer-placeholder-shown:text-base peer-placeholder-shown:top-4 peer-placeholder-shown:text-disabled`,children:"Password"}),e.jsx("button",{type:"button",onClick:()=>w(z=>!z),disabled:v,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted hover:text-primary transition-colors disabled:opacity-50",children:b?e.jsx(cs,{className:"w-5 h-5"}):e.jsx(xt,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer text-sm text-muted",children:[e.jsx("input",{type:"checkbox",checked:h,onChange:z=>f(z.target.checked),disabled:v,className:"w-4 h-4 text-primary bg-surface border-strong rounded focus:ring-accent focus:ring-2"}),e.jsx("span",{children:"Remember me"})]}),e.jsx("button",{type:"button",className:"text-sm text-accent hover:text-secondary transition-colors",onClick:()=>{alert("Password reset functionality will be implemented soon.")},children:"Forgot password?"})]}),k&&e.jsx("div",{className:"text-error text-sm text-center bg-error-light border border-error/20 rounded-md p-3",children:k}),e.jsx("button",{type:"submit",disabled:v,className:"w-full bg-primary hover:bg-secondary disabled:bg-disabled disabled:text-muted text-white py-3 rounded-md shadow-sm transition-all duration-200 focus:ring-2 focus:ring-accent focus:ring-offset-2 font-medium",children:v?"Signing in...":"Continue"})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-light"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-surface text-muted",children:"or continue with"})})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("button",{type:"button",disabled:!0,className:"w-full inline-flex justify-center items-center px-4 py-2 border border-light rounded-md shadow-sm bg-surface text-sm font-medium text-muted hover:bg-light disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(sr,{className:"w-5 h-5 mr-2"}),"Enterprise SSO (Coming Soon)"]})})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-light text-center space-x-4 text-xs text-muted",children:[e.jsx("button",{onClick:()=>t("/terms"),className:"hover:text-primary transition-colors",children:"Terms of Use"}),e.jsx("span",{children:""}),e.jsx("button",{onClick:()=>t("/privacy"),className:"hover:text-primary transition-colors",children:"Privacy Policy"})]})]}),e.jsxs("div",{className:"mt-8 text-center text-sm text-muted z-10",children:["Don't have an account?"," ",e.jsx("button",{onClick:()=>t("/signup"),className:"text-accent hover:text-secondary font-medium transition-colors",children:"Sign up here"})]})]})}const ur=t=>{switch(t.toLowerCase()){case"completed":return"bg-green-100 text-green-700";case"in progress":return"bg-blue-100 text-blue-700";case"active":return"bg-blue-100 text-blue-700";case"archived":return"bg-gray-100 text-gray-600";default:return"bg-gray-100 text-gray-600"}},mr=t=>{if(!t||t==="N/A")return"bg-gray-100 text-gray-500";switch(t.toLowerCase()){case"rockwell":case"rockwell automation":return"bg-red-100 text-red-700";case"siemens":return"bg-teal-100 text-teal-700";case"beckhoff":return"bg-orange-100 text-orange-700";case"schneider":case"schneider electric":return"bg-green-100 text-green-700";case"omron":return"bg-blue-100 text-blue-700";default:return"bg-gray-100 text-gray-600"}},hr=t=>!t||t==="N/A"?"bg-gray-100 text-gray-500":"bg-purple-100 text-purple-700";function ou({project:t,onOpenOverview:s,onDelete:r}){return e.jsx("div",{className:`bg-surface rounded-lg border border-light p-6 hover:shadow-sm transition-all ${t.status==="archived"?"opacity-60":""}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-primary",children:t.name}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${ur(t.status)}`,children:t.status==="active"?"Active":t.status})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm text-secondary mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Client:"}),e.jsx("span",{className:`ml-2 px-2 py-1 rounded text-xs font-medium ${hr(t.client)}`,children:t.client})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Vendor:"}),e.jsx("span",{className:`ml-2 px-2 py-1 rounded text-xs font-medium ${mr(t.vendor)}`,children:t.vendor})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Modified:"})," ",t.lastModified]})]}),e.jsx("p",{className:"text-sm text-muted",children:t.description})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx(F,{onClick:()=>s(t),size:"sm",icon:Qe,iconPosition:"right",children:"Open Overview"}),e.jsx(F,{onClick:()=>r(t),variant:"ghost",size:"sm",icon:Ft,className:"text-red-600 hover:text-red-700 hover:bg-red-50",title:"Delete Project"})]})]})})}function iu({projects:t,onOpenOverview:s,onDelete:r}){return e.jsx("div",{className:"bg-surface rounded-lg border border-light overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-light",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 font-medium text-primary",children:"Project Name"}),e.jsx("th",{className:"text-left p-4 font-medium text-primary",children:"Client"}),e.jsx("th",{className:"text-left p-4 font-medium text-primary",children:"Vendor"}),e.jsx("th",{className:"text-left p-4 font-medium text-primary",children:"Status"}),e.jsx("th",{className:"text-left p-4 font-medium text-primary",children:"Last Modified"}),e.jsx("th",{className:"text-left p-4 font-medium text-primary",children:"Actions"})]})}),e.jsx("tbody",{children:t.map(a=>e.jsxs("tr",{className:`border-b border-light hover:bg-gray-50 transition-colors ${a.status==="archived"?"opacity-60":""}`,children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-primary",children:a.name}),e.jsx("p",{className:"text-sm text-muted mt-1",children:a.description})]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${hr(a.client)}`,children:a.client})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${mr(a.vendor)}`,children:a.vendor})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${ur(a.status)}`,children:a.status==="active"?"Active":a.status})}),e.jsx("td",{className:"p-4 text-secondary",children:a.lastModified}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{onClick:()=>s(a),size:"sm",icon:Qe,iconPosition:"right",children:"Open Overview"}),e.jsx(F,{onClick:()=>r(a),variant:"ghost",size:"sm",icon:Ft,className:"text-red-600 hover:text-red-700 hover:bg-red-50",title:"Delete Project"})]})})]},a.id))})]})})}const lu=[{value:"all",label:"All Projects"},{value:"active",label:"Active"},{value:"archived",label:"Archived"}];function cu({onBack:t,onOpenProject:s,onDeleteProject:r,onNewProject:a,refreshTrigger:o=0,onRefreshComplete:n}){const{isAuthenticated:i,token:c,user:m}=Le(),[u,h]=l.useState([]),[f,b]=l.useState(!0),[w,p]=l.useState(""),[S,N]=l.useState(""),[C,k]=l.useState("all"),[j,v]=l.useState("grid"),x=async()=>{if(!i||!c){console.log("ProjectsList: User not authenticated, skipping project load"),b(!1),p("Please log in to view projects");return}try{b(!0),p("");const g=(await ae.getProjects()).map(ps);console.log("ProjectsList: Loaded",g.length,"projects"),h(g),n&&n()}catch(d){console.error("Failed to load projects:",d),p(d.message||"Failed to load projects")}finally{b(!1)}};l.useEffect(()=>{i&&c&&x()},[o,i,c]);const T=d=>{r(d)},y=u.filter(d=>{const g=(d.name||"").toLowerCase().includes(S.toLowerCase())||(d.client||"").toLowerCase().includes(S.toLowerCase())||(d.description||"").toLowerCase().includes(S.toLowerCase()),A=C==="all"||d.status===C;return g&&A});return e.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(F,{onClick:t,variant:"ghost",icon:fs,size:"sm",children:"Back"}),e.jsx("h1",{className:"text-3xl font-bold text-primary",children:"Projects"}),e.jsxs("span",{className:"text-sm text-secondary px-2 py-1 bg-light rounded",children:[y.length," projects"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(F,{onClick:x,variant:"ghost",icon:Ne,disabled:f,size:"sm",children:f?"Loading...":"Refresh"}),e.jsxs("div",{className:"flex border border-light rounded overflow-hidden",children:[e.jsx("button",{onClick:()=>v("grid"),className:`p-2 ${j==="grid"?"bg-accent text-white":"bg-white text-muted hover:bg-gray-50"}`,title:"Card View",children:e.jsx(fo,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>v("list"),className:`p-2 ${j==="list"?"bg-accent text-white":"bg-white text-muted hover:bg-gray-50"}`,title:"Table View",children:e.jsx(To,{className:"w-4 h-4"})})]}),e.jsx(F,{onClick:a,icon:pt,iconPosition:"left",children:"New Project"})]})]}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx(ve,{type:"search",placeholder:"Search projects...",value:S,onChange:d=>N(d.target.value),icon:Pt,iconPosition:"left"})}),e.jsx("div",{className:"w-48",children:e.jsx(Ue,{options:lu,value:C,onChange:k,placeholder:"Filter projects"})})]}),w&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:w}),e.jsx(F,{onClick:x,variant:"ghost",size:"sm",children:"Retry"})]})}),f&&!w&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ne,{className:"w-8 h-8 text-secondary mx-auto mb-4 animate-spin"}),e.jsx("p",{className:"text-secondary",children:"Loading projects..."})]}),!f&&!w&&e.jsx("div",{className:j==="grid"?"space-y-4":"",children:y.length===0?e.jsxs("div",{className:"text-center py-12 bg-surface rounded-lg border border-light",children:[e.jsx(Hs,{className:"w-16 h-16 text-muted mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-primary mb-2",children:"No projects found"}),e.jsx("p",{className:"text-secondary mb-4",children:S||C!=="all"?"Try adjusting your search or filter criteria.":"Get started by creating your first project."}),!S&&C==="all"&&e.jsx(F,{onClick:a,icon:pt,iconPosition:"left",children:"Create New Project"})]}):j==="grid"?y.map(d=>e.jsx(ou,{project:d,onOpenOverview:s,onDelete:T},d.id)):e.jsx(iu,{projects:y,onOpenOverview:s,onDelete:T})})]})}function Jr(t){return t==null?"":typeof t=="string"?t:typeof t=="boolean"?t?"Yes":"No":typeof t=="number"?String(t):typeof t=="object"?Array.isArray(t)?t.length>0?t.join(", "):"None":Object.keys(t).length===0?"None":Object.entries(t).filter(([r,a])=>a!=null&&a!=="").map(([r,a])=>{const o=r.replace(/([A-Z])/g," $1").replace(/^./,n=>n.toUpperCase());return typeof a=="boolean"?`${o}: ${a?"Yes":"No"}`:typeof a=="object"&&a!==null?`${o}: ${JSON.stringify(a)}`:typeof a=="string"&&a.length>50?`${o}: ${a.substring(0,50)}...`:`${o}: ${a}`}).join(`
`)||"Empty":String(t)}function du({section:t,isExpanded:s,onToggle:r}){const a=t.icon;return e.jsxs("div",{className:"border border-gray-200 rounded-lg mb-3",children:[e.jsxs("div",{className:`flex items-center justify-between p-3 cursor-pointer hover:bg-gray-50 ${t.hasChanges?"bg-yellow-50 border-yellow-200":""}`,onClick:r,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(a,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"font-medium",children:t.label}),t.hasChanges&&e.jsx("span",{className:"bg-yellow-100 text-yellow-700 text-xs px-2 py-0.5 rounded-full",children:"Changed"})]}),s?e.jsx(et,{className:"w-4 h-4 text-gray-400"}):e.jsx(gt,{className:"w-4 h-4 text-gray-400"})]}),s&&e.jsx("div",{className:"border-t border-gray-200 p-3",children:t.hasChanges?e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:["Version ",t.key==="from"?"From":"To"]}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded p-2",children:e.jsx("pre",{className:"text-sm text-gray-800 whitespace-pre-wrap",children:Jr(t.fromValue)})})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:["Version ",t.key==="to"?"To":"From"]}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded p-2",children:e.jsx("pre",{className:"text-sm text-gray-800 whitespace-pre-wrap",children:Jr(t.toValue)})})]})]}):e.jsx("div",{className:"text-sm text-gray-500 italic",children:"No changes in this section"})})]})}function uu({projectId:t,fromVersion:s,toVersion:r,isOpen:a,onClose:o}){const[n,i]=l.useState(null),[c,m]=l.useState(null),[u,h]=l.useState(!1),[f,b]=l.useState(null),[w,p]=l.useState(new Set),{getVersionData:S}=Bt({projectId:t,autoCreateVersions:!1});l.useEffect(()=>{a&&t&&s&&r&&N()},[a,t,s,r]);const N=async()=>{h(!0),b(null);try{const[x,T]=await Promise.all([S(s),S(r)]);i(x),m(T)}catch(x){b(x.message||"Failed to load version data")}finally{h(!1)}},C=x=>{const T=new Set(w);T.has(x)?T.delete(x):T.add(x),p(T)},j=(()=>{if(!n||!c)return[];const x=[];if(n.module==="LogicStudio"||c.module==="LogicStudio"){x.push({key:"editorCode",label:"PLC Code",icon:Je,fromValue:n.editorCode||"",toValue:c.editorCode||"",hasChanges:(n.editorCode||"")!==(c.editorCode||"")}),x.push({key:"prompt",label:"AI Prompt",icon:ds,fromValue:n.prompt||"",toValue:c.prompt||"",hasChanges:(n.prompt||"")!==(c.prompt||"")}),x.push({key:"vendor",label:"PLC Vendor",icon:at,fromValue:n.vendor||"siemens",toValue:c.vendor||"siemens",hasChanges:(n.vendor||"siemens")!==(c.vendor||"siemens")});const T={projectName:n.projectName||"",clientName:n.clientName||"",projectType:n.projectType||"",description:n.description||"",lastActivity:n.lastActivity||"",module:n.module||"",totalLines:n.editorCode?n.editorCode.split(`
`).length:0,promptLength:n.prompt?n.prompt.length:0,timestamp:n.timestamp||"",collapseLevel:n.collapseLevel||0,editorSettings:n.editorSettings||{},tags:n.tags||[],hasPrompt:!!(n.prompt&&n.prompt.trim()),hasCode:!!(n.editorCode&&n.editorCode.trim()),codeComplexity:n.editorCode?(n.editorCode.match(/\n/g)||[]).length:0},y={projectName:c.projectName||"",clientName:c.clientName||"",projectType:c.projectType||"",description:c.description||"",lastActivity:c.lastActivity||"",module:c.module||"",totalLines:c.editorCode?c.editorCode.split(`
`).length:0,promptLength:c.prompt?c.prompt.length:0,timestamp:c.timestamp||"",collapseLevel:c.collapseLevel||0,editorSettings:c.editorSettings||{},tags:c.tags||[],hasPrompt:!!(c.prompt&&c.prompt.trim()),hasCode:!!(c.editorCode&&c.editorCode.trim()),codeComplexity:c.editorCode?(c.editorCode.match(/\n/g)||[]).length:0};x.push({key:"logicStudioMetadata",label:"Logic Studio Metadata",icon:Me,fromValue:T,toValue:y,hasChanges:JSON.stringify(T)!==JSON.stringify(y)});const d={projectName:n.projectName||"",clientName:n.clientName||"",projectType:n.projectType||"",description:n.description||""},g={projectName:c.projectName||"",clientName:c.clientName||"",projectType:c.projectType||"",description:c.description||""};x.push({key:"projectInfo",label:"Project Information",icon:Me,fromValue:d,toValue:g,hasChanges:JSON.stringify(d)!==JSON.stringify(g)}),(n.editorSettings||c.editorSettings)&&x.push({key:"editorSettings",label:"Editor Settings",icon:Je,fromValue:n.editorSettings||{},toValue:c.editorSettings||{},hasChanges:JSON.stringify(n.editorSettings||{})!==JSON.stringify(c.editorSettings||{})});const A={lastActivity:n.lastActivity||"",timestamp:n.timestamp||"",collapseLevel:n.collapseLevel||0},O={lastActivity:c.lastActivity||"",timestamp:c.timestamp||"",collapseLevel:c.collapseLevel||0};x.push({key:"activityTracking",label:"Activity & State",icon:at,fromValue:A,toValue:O,hasChanges:JSON.stringify(A)!==JSON.stringify(O)})}return(n.module==="TagManager"||c.module==="TagManager")&&x.push({key:"filters",label:"Tag Filters",icon:at,fromValue:n.filters||{},toValue:c.filters||{},hasChanges:JSON.stringify(n.filters||{})!==JSON.stringify(c.filters||{})}),(n.module==="AskPandaura"||c.module==="AskPandaura")&&x.push({key:"chatMessage",label:"Chat Message",icon:ds,fromValue:n.chatMessage||"",toValue:c.chatMessage||"",hasChanges:(n.chatMessage||"")!==(c.chatMessage||"")}),x.push({key:"lastActivity",label:"Last Activity",icon:Me,fromValue:n.lastActivity||"",toValue:c.lastActivity||"",hasChanges:(n.lastActivity||"")!==(c.lastActivity||"")}),x})(),v=j.filter(x=>x.hasChanges);return e.jsx(De,{isOpen:a,onClose:o,title:`Compare Versions ${s}  ${r}`,size:"xl",children:e.jsx("div",{className:"space-y-4",children:u?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Loading version data..."})]}):f?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-red-600 mb-2",children:"Failed to load version data"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:f}),e.jsx(F,{onClick:N,variant:"outline",children:"Try Again"})]}):j.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Me,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No data available for comparison"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"Comparison Summary"}),e.jsxs("div",{className:"text-sm text-blue-700",children:[e.jsxs("p",{children:[e.jsx("strong",{children:v.length})," section",v.length!==1?"s":""," changed out of ",e.jsx("strong",{children:j.length})," total sections"]}),v.length>0&&e.jsxs("p",{className:"mt-1",children:["Changed: ",v.map(x=>x.label).join(", ")]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(F,{size:"sm",variant:"outline",onClick:()=>{const x=new Set(j.map(T=>T.key));p(x)},children:"Expand All"}),e.jsx(F,{size:"sm",variant:"outline",onClick:()=>p(new Set),children:"Collapse All"}),e.jsx(F,{size:"sm",variant:"outline",onClick:()=>{const x=new Set(v.map(T=>T.key));p(x)},children:"Show Changes Only"})]}),e.jsx("div",{className:"space-y-3",children:j.map(x=>e.jsx(du,{section:x,isExpanded:w.has(x.key),onToggle:()=>C(x.key)},x.key))})]})})})}function mu({versions:t,isLoading:s=!1,error:r=null,onViewDiff:a,onRollback:o,onDelete:n,onRefresh:i,projectId:c}){const[m,u]=l.useState(!1),[h,f]=l.useState(1),b=5,[w,p]=l.useState(!1),[S,N]=l.useState(null),C=[...t].sort((d,g)=>g.version_number-d.version_number),k=Math.ceil(C.length/b),j=(h-1)*b,v=j+b,x=C.slice(j,v),T=d=>{f(d)},y=d=>{try{return new Date(d).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return d}};return e.jsxs(Ee,{children:[e.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer border-b border-light hover:bg-background transition-colors",onClick:()=>u(!m),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ca,{className:"w-5 h-5 text-accent"}),e.jsx("h3",{className:"font-semibold text-primary",children:"Version History"}),e.jsxs("span",{className:"text-sm text-muted",children:["(",C.length," versions)"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i&&e.jsx(F,{size:"sm",variant:"ghost",icon:Ne,onClick:()=>{i()},className:`p-1 ${s?"animate-spin":""}`,title:"Refresh version history"}),m?e.jsx(Gn,{className:"w-4 h-4 text-muted"}):e.jsx(et,{className:"w-4 h-4 text-muted"})]})]}),m&&e.jsx("div",{className:"p-4",children:s?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ne,{className:"w-8 h-8 text-muted mx-auto mb-3 animate-spin"}),e.jsx("p",{className:"text-secondary",children:"Loading version history..."})]}):r?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(be,{className:"w-8 h-8 text-red-500 mx-auto mb-3"}),e.jsx("p",{className:"text-red-600 mb-2",children:"Failed to load version history"}),e.jsx("p",{className:"text-sm text-muted mb-4",children:r}),i&&e.jsx(F,{size:"sm",variant:"outline",icon:Ne,onClick:i,children:"Try Again"})]}):C.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ft,{className:"w-12 h-12 text-muted mx-auto mb-3"}),e.jsx("p",{className:"text-secondary",children:"No version history available"}),e.jsx("p",{className:"text-sm text-muted mt-2",children:"Versions will appear here as you save your project"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-3 mb-4",children:x.map((d,g)=>{const A=j+g===0;return e.jsxs("div",{className:`flex items-center justify-between p-4 rounded-md border transition-colors ${A?"bg-accent-light border-accent":"bg-background border-light hover:border-accent"}`,children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("span",{className:"font-medium text-primary",children:["Version ",d.version_number]}),A&&e.jsx("span",{className:"bg-accent text-white text-xs px-2 py-0.5 rounded-full",children:"Current"}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${d.is_auto?"bg-blue-100 text-blue-700 border border-blue-200":"bg-green-100 text-green-700 border border-green-200"}`,children:d.is_auto?"Auto-save":"Manual"})]}),e.jsxs("div",{className:"text-sm text-secondary mb-1",children:[e.jsxs("span",{className:"font-medium",children:["User ",d.user_id]}),"  ",y(d.created_at)]}),d.message&&e.jsx("p",{className:"text-sm text-muted",children:d.message}),e.jsx("div",{className:"flex items-center gap-4 text-xs text-muted mt-2",children:e.jsxs("span",{children:["Created ",new Date(d.created_at).toLocaleDateString()]})})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[g<C.length-1&&c&&e.jsx(F,{size:"sm",variant:"outline",icon:xt,onClick:()=>{const O=C[g+1];N({from:O.version_number,to:d.version_number}),p(!0)},title:"Compare with previous version",children:"Diff"}),a&&e.jsx(F,{size:"sm",variant:"outline",icon:xt,onClick:()=>a(d),title:"View Changes",children:"View"}),!A&&e.jsxs(e.Fragment,{children:[e.jsx(F,{size:"sm",variant:"ghost",icon:us,onClick:()=>o(d),className:"text-orange-600 hover:text-orange-700 hover:bg-orange-50",title:"Rollback to this version",children:"Rollback"}),n&&e.jsx(F,{size:"sm",variant:"ghost",icon:Ft,onClick:()=>{window.confirm(`Are you sure you want to delete version ${d.version_number}? This action cannot be undone.`)&&n(d)},className:"text-red-600 hover:text-red-700 hover:bg-red-50",title:"Delete this version",children:"Delete"})]})]})]},d.id)})}),k>1&&e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-light",children:[e.jsxs("div",{className:"text-sm text-secondary",children:["Showing ",j+1,"-",Math.min(v,C.length)," of ",C.length," versions"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{size:"sm",variant:"ghost",onClick:()=>T(h-1),disabled:h===1,children:"Previous"}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:k},(d,g)=>g+1).map(d=>e.jsx(F,{size:"sm",variant:h===d?"primary":"ghost",onClick:()=>T(d),className:"w-8 h-8 p-0",children:d},d))}),e.jsx(F,{size:"sm",variant:"ghost",onClick:()=>T(h+1),disabled:h===k,children:"Next"})]})]})]})}),c&&S&&e.jsx(uu,{projectId:c,fromVersion:S.from,toVersion:S.to,isOpen:w,onClose:()=>{p(!1),N(null)}})]})}const hu=t=>{if(!t)return"No state data available";try{return JSON.stringify(t,null,2)}catch{return"Invalid state data"}},xu=t=>t==null?"Not set":typeof t=="string"?t.trim()===""?"Empty":t:typeof t=="boolean"?t?"Yes":"No":typeof t=="number"?String(t):typeof t=="object"?Array.isArray(t)?t.length>0?t.join(", "):"None":Object.keys(t).length===0?"None":Object.entries(t).filter(([r,a])=>a!=null&&a!=="").map(([r,a])=>{const o=r.replace(/([A-Z])/g," $1").replace(/^./,n=>n.toUpperCase());return typeof a=="boolean"?`${o}: ${a?"Yes":"No"}`:typeof a=="object"&&a!==null?`${o}: ${JSON.stringify(a)}`:typeof a=="string"&&a.length>100?`${o}: ${a.substring(0,100)}...`:`${o}: ${a}`}).join(`
`)||"Empty":String(t),st=({title:t,icon:s,data:r,isExpanded:a,onToggle:o,important:n=!1})=>e.jsxs("div",{className:`border rounded-lg mb-3 ${n?"border-blue-200 bg-blue-50":"border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-3 cursor-pointer hover:bg-gray-50",onClick:o,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(s,{className:`w-4 h-4 ${n?"text-blue-600":"text-gray-600"}`}),e.jsx("span",{className:`font-medium ${n?"text-blue-900":"text-gray-900"}`,children:t}),n&&e.jsx("span",{className:"bg-blue-100 text-blue-700 text-xs px-2 py-0.5 rounded-full",children:"Key Data"})]}),a?e.jsx(et,{className:"w-4 h-4 text-gray-400"}):e.jsx(gt,{className:"w-4 h-4 text-gray-400"})]}),a&&e.jsx("div",{className:"border-t border-gray-200 p-3",children:e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded p-3",children:e.jsx("pre",{className:"text-sm text-gray-800 whitespace-pre-wrap font-mono",children:xu(r)})})})]});function pu({version:t,onClose:s,onRollback:r,onExport:a,projectId:o}){const[n,i]=l.useState(!1),[c,m]=l.useState(!1),[u,h]=l.useState(new Set(["logicStudioCore"])),[f,b]=l.useState(null),[w,p]=l.useState(!1);if(l.useEffect(()=>{t&&o&&t.version_number&&(p(!0),ae.getVersion(o,t.version_number).then(x=>{console.log("VersionDiffModal: Loaded full version data:",x),b(x)}).catch(x=>{console.error("VersionDiffModal: Failed to load version data:",x),b(null)}).finally(()=>{p(!1)}))},[t,o]),!t)return null;const S=()=>{r(t),i(!1),s()},N=()=>{a&&a(t)},C=x=>{const T=new Set(u);T.has(x)?T.delete(x):T.add(x),h(T)},k=x=>{try{return new Date(x).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return new Date().toLocaleString()}},v=(()=>{if(!f)return{basicInfo:{"Version Number":t.version_number,Created:k(t.created_at),"Save Type":t.is_auto?"Auto-save":"Manual Save",Message:t.message||"No message provided",Status:w?"Loading...":"Data not loaded"}};if(f.moduleStates?.LogicStudio||f.state?.module==="LogicStudio"){const x=f.moduleStates?.LogicStudio||f.state||{};return{logicStudioCore:{"PLC Vendor":x.vendor||"siemens","Code Lines":x.editorCode?x.editorCode.split(`
`).length:0,"Has PLC Code":!!(x.editorCode&&x.editorCode.trim()),"Has AI Prompt":!!(x.prompt&&x.prompt.trim()),"Prompt Length":x.prompt?`${x.prompt.length} characters`:"0 characters","Last Activity":x.lastActivity||"Unknown"},projectInfo:{"Project Name":x.projectName||f.projectMetadata?.project_name||"Unnamed Project","Client Name":x.clientName||"No client specified","Project Type":x.projectType||"Not specified",Description:x.description||"No description",Module:x.module||"LogicStudio"},codeContent:{"Full PLC Code":x.editorCode||"No code available","Code Preview":x.editorCode?x.editorCode.length>200?`${x.editorCode.substring(0,200)}...`:x.editorCode:"No code"},aiPrompt:{"AI Prompt":x.prompt||"No prompt set","Prompt Preview":x.prompt?x.prompt.length>200?`${x.prompt.substring(0,200)}...`:x.prompt:"No prompt"},technicalDetails:{"PLC Vendor":x.vendor||"siemens","Collapse Level":x.collapseLevel||0,Timestamp:f.timestamp?new Date(f.timestamp).toLocaleString():"Unknown","Version Number":t.version_number,"Save Type":t.is_auto?"Auto-save":"Manual Save",Created:k(t.created_at)},rawData:f}}return{basicInfo:{"Version Number":t.version_number,Created:k(t.created_at),"Save Type":t.is_auto?"Auto-save":"Manual Save",Message:t.message||"No message provided","Data Type":"Non-Logic Studio data"},rawData:f}})();return e.jsxs(e.Fragment,{children:[e.jsxs(De,{isOpen:!!t,onClose:s,title:`Version ${t.version_number} - Project State`,size:"lg",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-background rounded-lg p-4 border border-light",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-lg font-semibold text-primary",children:["Version ",t.version_number]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${t.is_auto?"bg-blue-100 text-blue-700 border border-blue-200":"bg-green-100 text-green-700 border border-green-200"}`,children:t.is_auto?"Auto-save":"Manual"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a&&e.jsx(F,{size:"sm",variant:"outline",icon:Ze,onClick:N,children:"Export"}),e.jsx(F,{size:"sm",variant:"outline",icon:us,onClick:()=>i(!0),className:"text-orange-600 hover:text-orange-700",children:"Rollback"})]})]}),e.jsxs("div",{className:"text-sm text-secondary",children:[e.jsxs("span",{className:"font-medium",children:["User ",t.user_id]}),"  ",k(t.created_at)]}),t.message&&e.jsx("p",{className:"text-sm text-primary mt-2",children:t.message})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium text-primary",children:"Project State Snapshot"}),e.jsx(F,{size:"sm",variant:"outline",icon:Je,onClick:()=>m(!c),children:c?"Hide Raw Data":"Show Raw Data"})]}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:w?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600",children:"Loading Logic Studio metadata..."})]}):e.jsxs(e.Fragment,{children:[v.logicStudioCore&&e.jsx(st,{title:" Logic Studio Core Data",icon:Je,data:v.logicStudioCore,isExpanded:u.has("logicStudioCore"),onToggle:()=>C("logicStudioCore"),important:!0}),v.projectInfo&&e.jsx(st,{title:"Project Information",icon:Me,data:v.projectInfo,isExpanded:u.has("projectInfo"),onToggle:()=>C("projectInfo")}),v.codeContent&&e.jsx(st,{title:"PLC Code Content",icon:Je,data:v.codeContent,isExpanded:u.has("codeContent"),onToggle:()=>C("codeContent")}),v.aiPrompt&&e.jsx(st,{title:"AI Prompt",icon:ds,data:v.aiPrompt,isExpanded:u.has("aiPrompt"),onToggle:()=>C("aiPrompt")}),v.technicalDetails&&e.jsx(st,{title:"Technical Details",icon:at,data:v.technicalDetails,isExpanded:u.has("technicalDetails"),onToggle:()=>C("technicalDetails")}),v.basicInfo&&!v.logicStudioCore&&e.jsx(st,{title:"Version Information",icon:Me,data:v.basicInfo,isExpanded:u.has("basicInfo"),onToggle:()=>C("basicInfo"),important:!0}),v.rawData&&e.jsx(st,{title:"Raw Version Data (Debug)",icon:at,data:v.rawData,isExpanded:u.has("rawData"),onToggle:()=>C("rawData")})]})}),c&&e.jsxs("div",{className:"bg-background border border-light rounded-md p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(Je,{className:"w-5 h-5 text-accent"}),e.jsx("span",{className:"font-medium text-primary",children:"Raw Version Data (JSON)"})]}),e.jsx("div",{className:"bg-surface rounded-md p-3 max-h-96 overflow-y-auto",children:e.jsx("pre",{className:"text-xs text-primary whitespace-pre-wrap font-mono",children:hu(t)})})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Note:"})," This system stores complete project state snapshots. Rolling back will restore the entire project to this version's state."]})})]})]}),e.jsx("div",{className:"flex justify-end gap-3 mt-6",children:e.jsx(F,{variant:"ghost",onClick:s,children:"Close"})})]}),e.jsxs(De,{isOpen:n,onClose:()=>i(!1),title:"Confirm Rollback",size:"sm",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-secondary mb-4",children:["Are you sure you want to rollback to ",e.jsxs("strong",{children:["Version ",t.version_number]}),"?"]}),e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-md p-3",children:e.jsxs("p",{className:"text-sm text-orange-800",children:[e.jsx("strong",{children:"Warning:"})," This action will create a new version with the rollback changes. Your current work will be preserved as the latest version."]})})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(F,{variant:"ghost",onClick:()=>i(!1),children:"Cancel"}),e.jsxs(F,{variant:"danger",onClick:S,icon:us,children:["Rollback to Version ",t.version_number]})]})]})]})}function gu(t){return e.jsx(Xe,{children:e.jsx(fu,{...t})})}function fu({project:t,onBack:s,onOpenWorkspace:r}){const[a,o]=l.useState(!1),[n,i]=l.useState(!1),[c,m]=l.useState(null),{project:u,isLoading:h,error:f,isDirty:b,lastSaved:w,autosave:p,save:S}=xc(t?.id||0),{versions:N,isLoading:C,error:k,rollbackToVersion:j,deleteVersion:v,refreshVersions:x}=Bt({projectId:t?.id||0,autoCreateVersions:!0}),{safeVersions:T,recentActivity:y}=l.useMemo(()=>{const M=N||[];return{safeVersions:M,recentActivity:M.slice(0,5).map(R=>({action:R.is_auto?"Auto-saved project":"Manually saved version",user:`User ${R.user_id}`,timestamp:new Date(R.created_at).toLocaleString(),details:R.message||`Version ${R.version_number} created`}))}},[N]),d=l.useCallback(async()=>{if(S)try{const M={currentView:"overview",savedAt:new Date().toISOString(),hasUnsavedChanges:!1};await S(M),o(!1),i(!1),console.log("Project saved successfully")}catch(M){console.error("Failed to save project:",M)}},[S]),g=l.useCallback(()=>{a||b?i(!0):r(t)},[a,b,r,t]),A=l.useCallback(()=>{i(!1),r(t)},[r,t]),O=l.useCallback(M=>{m(M)},[]),D=l.useCallback(async M=>{if(j)try{console.log("Rolling back to version:",M.version_number),await j(M.version_number),console.log("Rollback completed successfully")}catch(R){console.error("Rollback failed:",R);const z=R instanceof Error?R.message:"Failed to rollback to version. Please try again.";console.error(z)}},[j]),L=l.useCallback(async M=>{if(v)try{console.log("Deleting version:",M.version_number),await v(M.version_number),console.log("Version deleted successfully")}catch(R){console.error("Delete failed:",R);const z=R instanceof Error?R.message:"Failed to delete version. Please try again.";console.error(z)}},[v]);if(l.useEffect(()=>{if(!b||!p)return;const M=setTimeout(async()=>{const R={currentView:"overview",lastActivity:new Date().toISOString(),hasUnsavedChanges:a};await p(R),console.log("Auto-saved project state")},3e4);return()=>clearTimeout(M)},[b,a,p]),l.useEffect(()=>{const M=R=>{if(a||b)return R.preventDefault(),R.returnValue="You have unsaved changes. Are you sure you want to leave?",R.returnValue};return window.addEventListener("beforeunload",M),()=>window.removeEventListener("beforeunload",M)},[a,b]),l.useEffect(()=>{t?.id&&console.log("Project Overview - Version Control Debug:",{projectId:t.id,versionsLoading:C,versionsError:k,versionsCount:T.length,versions:T,recentActivityCount:y.length})},[t?.id,C,k,T,y]),!t)return e.jsx("div",{className:"max-w-4xl mx-auto px-6 py-8",children:e.jsxs("div",{className:"text-center py-12 bg-red-50 rounded-lg border border-red-200",children:[e.jsx(be,{className:"w-8 h-8 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-red-700 mb-2",children:"No Project Selected"}),e.jsx("p",{className:"text-red-600 mb-4",children:"No project data was provided."}),e.jsx(F,{onClick:s,children:"Back to Projects"})]})});if(h)return e.jsx("div",{className:"max-w-4xl mx-auto px-6 py-8",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-accent mx-auto mb-4"}),e.jsx("p",{className:"text-secondary",children:"Loading project..."})]})});if(f)return e.jsx("div",{className:"max-w-4xl mx-auto px-6 py-8",children:e.jsxs("div",{className:"text-center py-12 bg-red-50 rounded-lg border border-red-200",children:[e.jsx(be,{className:"w-8 h-8 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-red-700 mb-2",children:"Failed to load project"}),e.jsx("p",{className:"text-red-600 mb-4",children:f}),e.jsx(F,{onClick:()=>window.location.reload(),children:"Try Again"})]})});const U=u||t;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"max-w-4xl mx-auto px-6 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(F,{onClick:s,variant:"ghost",icon:fs,size:"sm",children:"Back to Projects"}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-primary",children:["Project: ",U.name]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-secondary",children:[e.jsxs("span",{children:["Last modified ",U.lastModified]}),b&&e.jsxs("div",{className:"flex items-center gap-1 text-orange-600",children:[e.jsx(ft,{className:"w-4 h-4"}),e.jsx("span",{children:"Auto-saving..."})]}),w&&e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(He,{className:"w-4 h-4"}),e.jsxs("span",{children:["Saved ",w.toLocaleTimeString()]})]})]})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:(a||b)&&e.jsx(F,{onClick:d,variant:"secondary",icon:He,iconPosition:"left",children:"Save Changes"})})]}),(a||b)&&e.jsx("div",{className:"mb-6 bg-orange-50 border border-orange-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(be,{className:"w-5 h-5 text-orange-600"}),e.jsx("p",{className:"text-orange-700",children:"You have unsaved changes. These will be auto-saved every 30 seconds, or you can save them manually."})]})}),n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Unsaved Changes"}),e.jsx("p",{className:"text-secondary mb-6",children:"You have unsaved changes. Would you like to save them before opening the workspace?"}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(F,{variant:"ghost",onClick:A,children:"Don't Save"}),e.jsx(F,{onClick:d,icon:He,iconPosition:"left",children:"Save & Continue"})]})]})}),e.jsx(Ee,{className:"mb-6",children:e.jsxs("div",{className:"grid grid-cols-2 gap-6 p-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-secondary",children:"Name"}),e.jsx("p",{className:"text-primary",children:U.name})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-secondary",children:"Client"}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium w-fit ${hr(U.client)}`,children:U.client})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium text-secondary",children:"Type"}),e.jsx("p",{className:"text-primary w-fit",children:U.type})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-secondary",children:"Target PLC Vendor"}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium w-fit ${mr(U.vendor)}`,children:U.vendor})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-secondary",children:"Status"}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium w-fit ${ur(U.status)}`,children:U.status==="active"?"Active":U.status})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-secondary",children:"Description"}),e.jsx("p",{className:"text-primary",children:U.description})]})]})]})}),e.jsx("div",{className:"mb-6",children:e.jsx(F,{onClick:g,size:"lg",icon:Qe,iconPosition:"right",className:"w-full py-4",children:"Open Full Project Workspace"})}),e.jsxs("div",{className:"grid gap-6",children:[e.jsx(mu,{versions:T,isLoading:C,error:k,projectId:t.id,onViewDiff:O,onRollback:D,onDelete:L,onRefresh:x}),e.jsxs(Ee,{children:[e.jsxs("div",{className:"flex items-center gap-2 p-4 border-b border-light",children:[e.jsx(jr,{className:"w-5 h-5 text-accent"}),e.jsx("h3",{className:"font-semibold text-primary",children:"Recent Activity"})]}),e.jsx("div",{className:"p-4",children:C?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-2"}),e.jsx("p",{className:"text-secondary",children:"Loading recent activity..."})]}):y.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(jr,{className:"w-12 h-12 text-muted mx-auto mb-3"}),e.jsx("p",{className:"text-secondary",children:"No recent activity"}),e.jsx("p",{className:"text-xs text-muted mt-1",children:"Activity will appear here as you work on the project"})]}):e.jsx("div",{className:"space-y-3",children:y.map((M,R)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-background rounded-md",children:[e.jsx("div",{className:"w-2 h-2 bg-accent rounded-full mt-2 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-primary",children:M.action}),e.jsxs("p",{className:"text-xs text-muted",children:[M.user,"  ",M.timestamp]}),M.details&&e.jsx("p",{className:"text-xs text-secondary mt-1",children:M.details})]})]},R))})})]})]})]}),e.jsx(pu,{version:c,projectId:t.id,onClose:()=>m(null),onRollback:M=>{D(M),m(null)}})]})}const yu=[{value:"",label:"Select project type"},{value:"new-installation",label:"New Installation"},{value:"migration",label:"Migration/Upgrade"},{value:"integration",label:"System Integration"},{value:"maintenance",label:"Maintenance/Support"},{value:"industrial-automation",label:"Industrial Automation"}],bu=[{value:"",label:"Select PLC vendor"},{value:"siemens",label:"Siemens"},{value:"rockwell",label:"Rockwell Automation"},{value:"beckhoff",label:"Beckhoff"}];function ju({isOpen:t,onClose:s,onSubmit:r,onSuccess:a}){const{showToast:o}=Ge(),[n,i]=l.useState({name:"",client:"",type:"",vendor:"",description:""}),[c,m]=l.useState({}),[u,h]=l.useState(!1),[f,b]=l.useState(""),w=async()=>{const S={};if(n.name.trim()||(S.name="Project name is required"),n.vendor&&!["siemens","rockwell","beckhoff"].includes(n.vendor)&&(S.vendor="Please select a valid PLC vendor"),m(S),b(""),Object.keys(S).length===0){h(!0);try{const N={projectName:n.name.trim(),clientName:n.client.trim()||void 0,projectType:n.type||void 0,targetPLCVendor:n.vendor,description:n.description.trim()||void 0},C=await ae.createProject(N);console.log("Project created successfully:",C),o({variant:"success",title:"Success!",message:`Project "${n.name.trim()}" has been created successfully.`,duration:4e3}),r(n),a&&a(),p()}catch(N){console.error("Failed to create project:",N),b(N.message||"Failed to create project. Please try again.")}finally{h(!1)}}},p=()=>{i({name:"",client:"",type:"",vendor:"",description:""}),m({}),s()};return e.jsxs(De,{isOpen:t,onClose:p,title:"Create New Project",size:"lg",children:[e.jsxs("div",{className:"space-y-4",children:[f&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md text-sm",children:f}),e.jsx(ve,{label:"Project Name",required:!0,value:n.name,onChange:S=>i(N=>({...N,name:S.target.value})),placeholder:"Enter project name",error:c.name,disabled:u}),e.jsx(ve,{label:"Client Name",value:n.client,onChange:S=>i(N=>({...N,client:S.target.value})),placeholder:"Enter client name",disabled:u}),e.jsx(Ue,{label:"Project Type",options:yu,value:n.type,onChange:S=>i(N=>({...N,type:S})),disabled:u}),e.jsx(Ue,{label:"Target PLC Vendor",options:bu,value:n.vendor,onChange:S=>i(N=>({...N,vendor:S})),error:c.vendor,disabled:u}),e.jsx(Et,{label:"Brief Description",value:n.description,onChange:S=>i(N=>({...N,description:S.target.value})),placeholder:"Describe the project scope and objectives...",rows:3,disabled:u})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(F,{variant:"ghost",onClick:p,disabled:u,children:"Cancel"}),e.jsx(F,{onClick:w,disabled:u,children:u?"Creating...":"Create Project"})]})]})}function vu({project:t,onClose:s,onConfirm:r,onSuccess:a}){const{showToast:o}=Ge(),[n,i]=l.useState(!1),c=async()=>{if(t)try{i(!0),await ae.deleteProject(t.id),o({variant:"success",title:"Project Deleted",message:`Project "${t.name}" has been deleted successfully.`,duration:4e3}),r(t),a&&a(),s()}catch(m){console.error("Failed to delete project:",m),o({variant:"error",title:"Delete Failed",message:m.message||"Failed to delete project. Please try again.",duration:5e3})}finally{i(!1)}};return e.jsxs(De,{isOpen:!!t,onClose:s,title:"Delete Project",size:"sm",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("p",{className:"text-secondary",children:["Are you sure you want to delete ",e.jsx("strong",{children:t?.name}),"? This action cannot be undone and will permanently remove all project data, including version history and activity logs."]})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(F,{variant:"ghost",onClick:s,disabled:n,children:"Cancel"}),e.jsx(F,{variant:"danger",onClick:c,disabled:n,children:n?"Deleting...":"Delete Project"})]})]})}function wu({tools:t,onBack:s}){const r=he();return e.jsxs("div",{className:"max-w-4xl mx-auto px-6 py-8",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx(F,{onClick:s,variant:"ghost",icon:fs,size:"sm",children:"Back"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-primary",children:"Quick Tools"}),e.jsx("p",{className:"text-secondary",children:"Single-use sessions for quick tasks and testing"})]})]}),e.jsx("div",{className:"grid gap-4",children:t.map(a=>e.jsxs("button",{onClick:()=>!a.comingSoon&&r(a.path),disabled:a.comingSoon,className:`flex items-center gap-4 p-6 bg-surface rounded-lg border border-light transition-all text-left relative ${a.comingSoon?"opacity-75 cursor-not-allowed":"hover:border-accent hover:shadow-sm"}`,children:[e.jsx("div",{className:`p-3 rounded-lg ${a.comingSoon?"bg-gray-100":"bg-accent-light"}`,children:e.jsx(a.icon,{className:`w-6 h-6 ${a.comingSoon?"text-gray-400":"text-accent"}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-primary",children:a.name}),a.comingSoon&&e.jsx("span",{className:"bg-green-100 text-green-700 text-xs px-2 py-1 rounded-full border border-green-200",children:"Coming Soon"})]}),e.jsx("p",{className:"text-secondary",children:a.description})]}),!a.comingSoon&&e.jsx(Qe,{className:"w-5 h-5 text-muted flex-shrink-0"})]},a.name))})]})}const Nu=[{name:"Logic Studio",icon:la,path:"/tool/logic",description:"Turn natural language into vendor-ready PLC code instantly.",comingSoon:!1},{name:"Tag Database Manager",icon:at,path:"/tool/tags",description:"Organize and maintain all your PLC tags in one place.",comingSoon:!1},{name:"AutoDocs",icon:Me,path:"/tool/autodocs",description:"Auto-generate professional PLC documentation.",comingSoon:!1},{name:"SignalFlow",icon:js,path:"/tool/signalflow",description:"Visualize and trace signal paths through your automation system.",comingSoon:!0},{name:"Pandaura AS Assistant",icon:ar,path:"/tool/assistant",description:"Get instant help with automation documents, logic files, and real-time support.",comingSoon:!1}];function ns(){const t=he(),s=Rt(),{projectId:r}=Mt(),{isAuthenticated:a,isLoading:o,user:n,token:i}=Le(),[c,m]=l.useState(!1),[u,h]=l.useState(null),[f,b]=l.useState(0),[w,p]=l.useState(null),[S,N]=l.useState(!1);we.useEffect(()=>{console.log("Home component mounted/updated"),console.log("Authentication state:",{isAuthenticated:a,isLoading:o,hasUser:!!n,hasToken:!!i,currentPath:s.pathname}),console.log("Token storage debug:",{contextToken:i?`${i.substring(0,10)}...`:"none",localStorageToken:localStorage.getItem("authToken")?`${localStorage.getItem("authToken").substring(0,10)}...`:"none",localStorageKeys:Object.keys(localStorage),userInfo:n?{userId:n.userId,email:n.email}:"none"})},[a,o,n,i,s.pathname]);const C=s.pathname==="/home/projects",k=s.pathname.startsWith("/home/projects/")&&r,j=s.pathname==="/home/quick-tools";l.useEffect(()=>{(async()=>{if(r&&a&&i){N(!0);try{console.log("Loading project with ID:",r);const g=await ae.getProjects();console.log("All projects from API:",g.map(O=>({id:O.id,name:O.project_name})));const A=g.find(O=>O.id.toString()===r);A?(console.log("Found project:",A.project_name),p(ps(A))):(console.warn("Project not found with ID:",r),console.log("Available project IDs:",g.map(O=>O.id)),p(null))}catch(g){console.error("Failed to load project:",g),p(null)}finally{N(!1)}}else console.log("Clearing selected project - projectId:",r,"isAuthenticated:",a,"hasToken:",!!i),p(null),N(!1)})()},[r,a,i]);const v=d=>{console.log("Creating project:",d),b(g=>g+1)},x=d=>{console.log("Delete confirmed for project:",d.name)},T=d=>{t(`/home/projects/${d.id}`)},y=d=>{if(!a){console.log("User not authenticated, redirecting to login"),t("/signin");return}console.log("User authenticated, navigating to workspace"),localStorage.setItem("currentProjectId",d.id.toString()),t(`/workspace/${d.id}/pandaura-as`,{state:{project:d}})};return k?(console.log("Project Overview View - Debug:",{projectId:r,isAuthenticated:a,isLoading:o,loadingProject:S,selectedProject:w?w.name:"null",pathname:s.pathname}),o?(console.log("Auth loading, showing spinner"),e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-secondary",children:"Loading authentication..."})]})})):a?S?(console.log("Project loading, showing spinner"),e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-secondary",children:"Loading project..."})]})})):w?(console.log("Rendering project overview for:",w.name),e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("header",{className:"flex items-center justify-between bg-surface px-6 py-4 border-b border-light shadow",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("img",{src:je,alt:"Pandaura Logo",className:"h-16 w-auto filter-none",style:{filter:"none",imageRendering:"crisp-edges"}})}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(ut,{})})]}),e.jsx(gu,{project:w,onBack:()=>t("/home/projects"),onOpenWorkspace:y})]})):(console.log("Project not found, showing error state"),e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("header",{className:"flex items-center justify-between bg-surface px-6 py-4 border-b border-light shadow",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("img",{src:je,alt:"Pandaura Logo",className:"h-16 w-auto filter-none",style:{filter:"none",imageRendering:"crisp-edges"}})}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(ut,{})})]}),e.jsx("div",{className:"flex items-center justify-center",style:{height:"calc(100vh - 88px)"},children:e.jsxs("div",{className:"text-center",children:[e.jsx(Hs,{className:"w-16 h-16 text-muted mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-primary mb-2",children:"Project not found"}),e.jsxs("p",{className:"text-secondary mb-4",children:["The requested project (ID: ",r,") could not be found or you don't have access to it."]}),e.jsx(F,{onClick:()=>t("/home/projects"),children:"Back to Projects"})]})})]})):(console.log("Project overview accessed but user not authenticated, redirecting to signin"),setTimeout(()=>t("/signin"),100),e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-secondary",children:"Redirecting to sign in..."})]})}))):C?o?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-secondary",children:"Loading authentication..."})]})}):a?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("header",{className:"flex items-center justify-between bg-surface px-6 py-4 border-b border-light shadow",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("img",{src:je,alt:"Pandaura Logo",className:"h-16 w-auto filter-none",style:{filter:"none",imageRendering:"crisp-edges"}})}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(ut,{})})]}),e.jsx(cu,{onBack:()=>t("/home"),onOpenProject:T,onDeleteProject:d=>h(d),onNewProject:()=>m(!0),refreshTrigger:f}),e.jsx(ju,{isOpen:c,onClose:()=>m(!1),onSubmit:v,onSuccess:()=>b(d=>d+1)}),e.jsx(vu,{project:u,onClose:()=>h(null),onConfirm:x,onSuccess:()=>b(d=>d+1)})]}):(console.log("Projects view accessed but user not authenticated, redirecting to signin"),setTimeout(()=>t("/signin"),100),e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-secondary",children:"Redirecting to sign in..."})]})})):j?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("header",{className:"flex items-center justify-between bg-surface px-6 py-4 border-b border-light shadow",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("img",{src:je,alt:"Pandaura Logo",className:"h-16 w-auto filter-none",style:{filter:"none",imageRendering:"crisp-edges"}})}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(ut,{})})]}),e.jsx(wu,{tools:Nu,onBack:()=>t("/home")})]}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("header",{className:"flex items-center justify-between bg-surface px-6 py-4 border-b border-light shadow",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("img",{src:je,alt:"Pandaura Logo",className:"h-16 w-auto filter-none",style:{filter:"none",imageRendering:"crisp-edges"}})}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(ut,{})})]}),e.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-12",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-4xl font-bold text-primary mb-4",children:"Welcome to Pandaura AS"}),e.jsx("p",{className:"text-lg text-secondary max-w-2xl mx-auto",children:"Your complete industrial automation suite. Choose how you want to work today."})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8 mb-16",children:[e.jsx(Ee,{variant:"elevated",icon:Hs,title:"Projects",subtitle:"Manage your automation projects with full history and collaboration.",className:"text-center",children:e.jsxs("div",{children:[e.jsx("div",{className:"mb-6",children:e.jsx("p",{className:"text-xs text-secondary bg-background rounded-md p-3 border border-light",children:"Access all modules with persistent project history, version control, and team collaboration features."})}),e.jsx(F,{onClick:()=>t("/home/projects"),className:"w-full py-4",icon:Qe,iconPosition:"right",size:"lg",children:"Browse Projects"})]})}),e.jsx(Ee,{variant:"elevated",icon:js,title:"Quick Tools",subtitle:"Single-use sessions for quick tasks and testing.",className:"text-center",children:e.jsxs("div",{children:[e.jsx("div",{className:"mb-6",children:e.jsx("p",{className:"text-xs text-secondary bg-background rounded-md p-3 border border-light",children:"These tools are available for one-time use. You can upload files, use all features, and export results  but your session will not be saved."})}),e.jsx(F,{onClick:()=>t("/home/quick-tools"),className:"w-full py-4",variant:"outline",icon:Qe,iconPosition:"right",size:"lg",children:"Launch Quick Tools"})]})})]}),e.jsxs("div",{className:"flex items-center justify-center mb-8",children:[e.jsx("div",{className:"h-px bg-light flex-1"}),e.jsx("span",{className:"px-4 text-sm text-muted",children:"Pandaura Labs"}),e.jsx("div",{className:"h-px bg-light flex-1"})]}),e.jsxs("div",{className:"text-center text-sm text-muted space-x-6",children:[e.jsx("span",{children:" 2025"}),e.jsx("button",{onClick:()=>t("/feedback"),className:"hover:text-primary transition-colors",children:"Support"}),e.jsx("button",{onClick:()=>t("/terms"),className:"hover:text-primary transition-colors",children:"Terms"}),e.jsx("button",{onClick:()=>t("/privacy"),className:"hover:text-primary transition-colors",children:"Privacy"})]})]})]})}function Su(){he();const[t,s]=l.useState(""),[r,a]=l.useState(""),[o,n]=l.useState(""),[i,c]=l.useState(!1),[m,u]=l.useState("idle"),h=async w=>{if(w.preventDefault(),!(!t.trim()&&!r.trim()&&!o.trim())){c(!0),u("idle");try{await new Promise(S=>setTimeout(S,2e3));const p=f();console.log("Feedback submission:",p),u("success"),setTimeout(()=>{s(""),a(""),n(""),u("idle")},3e3)}catch{u("error")}finally{c(!1)}}},f=()=>{let w="";return t.trim()&&(w+=` Feedback About the App 
`+t.trim()+`

`),r.trim()&&(w+=` Feedback About the AI 
`+r.trim()+`

`),o.trim()&&(w+=` Advanced Feedback 
`+o.trim()+`

`),w+=`Submitted on: ${new Date().toLocaleString()}
`,w+=`User Session: ${Math.random().toString(36).substr(2,9)}`,w},b=t.trim()||r.trim()||o.trim();return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(lc,{title:"Feedback",subtitle:"Help us improve Pandaura AS",showBackButton:!0}),e.jsxs("div",{className:"max-w-4xl mx-auto px-6 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-primary mb-2",children:"We'd love to hear from you"}),e.jsx("p",{className:"text-muted",children:"Your feedback helps us build better automation tools. Share your thoughts in any or all sections below."})]}),e.jsxs("form",{onSubmit:h,className:"space-y-8",children:[e.jsx(Ee,{title:"Your thoughts on the app",subtitle:"What's been working well? What's been frustrating? Tell us anything about your experience with Pandaura.",children:e.jsx(Et,{value:t,onChange:w=>s(w.target.value),placeholder:"Share your experience with the app...",rows:6,maxLength:2e3,helpText:"Optional  Be as detailed as you'd like",showCharCount:!0})}),e.jsx(Ee,{title:"Your thoughts on the AI",subtitle:"How helpful has the AI been for you? Any moments it surprised youor totally missed the mark?",children:e.jsx(Et,{value:r,onChange:w=>a(w.target.value),placeholder:"Tell us about your AI assistant experience...",rows:6,maxLength:2e3,helpText:"Optional  We're always improving the AI",showCharCount:!0})}),e.jsx(Ee,{title:"Want to go deeper?",subtitle:"If you've got technical notes, feature requests, or specific examples  we'd love to hear them here.",children:e.jsx(Et,{value:o,onChange:w=>n(w.target.value),placeholder:"Share technical feedback, feature requests, or specific examples...",rows:6,maxLength:3e3,helpText:"Optional  Technical details welcome",showCharCount:!0})}),e.jsxs(Ee,{children:[m==="success"&&e.jsx(ht,{variant:"success",className:"mb-4",children:"Thanks  we seriously read every message. "}),m==="error"&&e.jsx(ht,{variant:"error",className:"mb-4",children:"Something went wrong. Try again or email us directly at pandauracares@mail.com. "}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-muted",children:["Your feedback goes directly to ",e.jsx("span",{className:"font-mono",children:"pandauracares@mail.com"})]}),e.jsx(F,{type:"submit",disabled:!b||i,loading:i,icon:i?ua:ys,children:i?"Sending...":"Send Feedback"})]})]})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsx("p",{className:"text-xs text-muted",children:"All feedback is sent securely and never shared with third parties. We read everything and use it to improve Pandaura AS."})})]})]})}function ku(){const t=he(),[s,r]=l.useState(new Set),[a,o]=l.useState(!1),[n,i]=l.useState(""),[c,m]=l.useState(!1),u=b=>{const w=new Set(s);w.has(b)?w.delete(b):w.add(b),r(w)},h=b=>{b.preventDefault(),n.trim()&&(console.log("Privacy feedback:",n),m(!0),i(""),setTimeout(()=>{m(!1),o(!1)},2e3))},f=[{id:"data-collection",title:"What We Don't Collect",icon:"",content:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-primary font-medium",children:"We don't collect your code. Ever."}),e.jsx("p",{className:"text-muted",children:"Pandaura AS runs entirely on-premise. Your PLC logic, structured text, tag databases, and any project files never leave your local machine. There's no cloud syncing, no background uploads, and no external servers involved."})]})},{id:"ai-privacy",title:"AI Model Privacy",icon:"",content:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-primary font-medium",children:"The AI doesn't train on your data."}),e.jsx("p",{className:"text-muted",children:"The AI features built into Pandaura (like logic generation, signal tracing, and auto-documentation) do not learn from your inputs. Your prompts and results are used in real time to help you  and that's it. Nothing is saved, reused, or sent to a central server."})]})},{id:"file-uploads",title:"Uploaded Files",icon:"",content:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-primary font-medium",children:"Uploaded files stay local."}),e.jsx("p",{className:"text-muted",children:"Files uploaded for context (like machine specs, manuals, or existing logic files) are only used during that session  they're never saved or transmitted elsewhere. Everything resets when the session ends or the app is closed."})]})},{id:"case-studies",title:"Case Study Consent",icon:"",content:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-primary font-medium",children:"Case studies are always opt-in."}),e.jsx("p",{className:"text-muted",children:"We'll only collect feedback or usage examples if you explicitly submit a case study. Even then, all identifying data must be removed by you. If anything sensitive is left in by mistake, we'll delete it immediately upon notice  no questions asked."})]})},{id:"diagnostics",title:"Troubleshooting & Diagnostics (Optional)",icon:"",content:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-primary font-medium",children:"You're in control of diagnostics."}),e.jsx("p",{className:"text-muted",children:"If you reach out for support, you can choose whether or not to share technical logs. By default, no diagnostic data is collected or sent. You're always in full control of what you share."})]})},{id:"user-accounts",title:"User Accounts & Sessions",icon:"",content:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-primary font-medium",children:"No user tracking."}),e.jsx("p",{className:"text-muted",children:"Pandaura doesn't require a cloud login, and we don't track behavior. If we add optional features like user profiles or saved projects in the future, they'll also stay entirely local unless you opt in to share."})]})},{id:"feedback",title:"Feedback You Submit",icon:"",content:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-primary font-medium",children:"Feedback goes straight to us  nowhere else."}),e.jsx("p",{className:"text-muted",children:"If you submit app or AI feedback, it's sent directly to our internal support email: pandauracares@mail.com. It's never sold, stored in the cloud, or analyzed by third parties. We read it. That's all."})]})},{id:"user-control",title:"Your Control, Always",icon:"",content:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-primary font-medium",children:"You can clear all local data at any time."}),e.jsx("p",{className:"text-muted",children:"We give you full control to reset, clear, or delete all project data stored locally. You'll always be able to start fresh  no hidden caches, no stored prompts, no buried files."})]})},{id:"contact",title:"Contacting Us",icon:"",content:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-primary font-medium",children:"Questions about privacy? Reach out to us directly."}),e.jsxs("div",{className:"space-y-2 text-muted",children:[e.jsxs("p",{children:["Email: ",e.jsx("span",{className:"font-mono text-primary",children:"pandauracares@mail.com"})]}),e.jsxs("p",{children:["Case Study Privacy Team: ",e.jsx("span",{className:"font-mono text-primary",children:"privacy@pandauralabs.com"})]})]})]})}];return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"bg-surface border-b border-light px-6 py-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>t(-1),className:"p-2 hover:bg-background rounded-md transition-colors",title:"Go back",children:e.jsx(Oe,{className:"w-5 h-5 text-secondary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-primary",children:"Privacy Policy"}),e.jsx("p",{className:"text-sm text-secondary",children:e.jsx("button",{onClick:()=>t("/terms"),className:"hover:text-primary transition-colors underline",children:"View Terms of Use"})})]})]}),e.jsxs("button",{onClick:()=>o(!a),className:"p-3 hover:bg-background rounded-full transition-colors relative",title:"Privacy Feedback",children:[e.jsx(ar,{className:"w-5 h-5 text-secondary"}),a&&e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-80 bg-surface border border-light rounded-lg shadow-lg p-4 z-50",children:[e.jsx("h3",{className:"font-medium text-primary mb-2",children:"Have ideas for better privacy?"}),e.jsx("p",{className:"text-xs text-muted mb-3",children:"We take your trust seriously. If there's a privacy feature you think we should add, or if something feels unclear, let us know."}),c?e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-sm text-green-600",children:"Thank you for your feedback! "})}):e.jsxs("form",{onSubmit:h,className:"space-y-3",children:[e.jsx("textarea",{value:n,onChange:b=>i(b.target.value),placeholder:"Your privacy feedback...",className:"w-full px-3 py-2 bg-background border border-light rounded text-sm resize-none focus:outline-none focus:ring-2 focus:ring-accent",rows:3,maxLength:500}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-xs text-muted",children:[n.length,"/500"]}),e.jsxs("button",{type:"submit",disabled:!n.trim(),className:"bg-primary text-white px-3 py-1 rounded text-xs hover:bg-secondary transition-colors disabled:opacity-50 flex items-center gap-1",children:[e.jsx(ys,{className:"w-3 h-3"}),"Send"]})]})]}),e.jsx("p",{className:"text-xs text-muted mt-2",children:"Your message goes straight to our core team. All feedback welcome."})]})]})]})}),e.jsxs("div",{className:"max-w-4xl mx-auto px-6 py-8",children:[e.jsx("div",{className:"space-y-4 mb-8",children:f.map(b=>e.jsxs("div",{className:"bg-surface border border-light rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>u(b.id),className:"w-full flex items-center justify-between p-6 text-left hover:bg-background transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:b.icon}),e.jsx("h2",{className:"text-lg font-semibold text-primary",children:b.title})]}),s.has(b.id)?e.jsx(et,{className:"w-5 h-5 text-secondary"}):e.jsx(gt,{className:"w-5 h-5 text-secondary"})]}),s.has(b.id)&&e.jsx("div",{className:"px-6 pb-6 border-t border-light",children:e.jsx("div",{className:"pt-4",children:b.content})})]},b.id))}),e.jsxs("div",{className:"bg-primary/5 border border-primary/20 rounded-lg p-6 text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:""}),e.jsx("h3",{className:"text-lg font-semibold text-primary mb-2",children:"We built Pandaura to be local-first  because we know your data is critical."}),e.jsx("p",{className:"text-muted",children:"You control your environment. You own your code. That will never change."})]})]})]})}function Cu(){const t=he(),[s,r]=l.useState(new Set),a=i=>{const c=new Set(s);c.has(i)?c.delete(i):c.add(i),r(c)},o=()=>{console.log("Downloading Terms of Use PDF..."),alert("PDF download would be available in production version.")},n=[{id:"introduction",title:"Introduction",content:e.jsx("div",{className:"space-y-4",children:e.jsx("p",{className:"text-muted",children:"Welcome to Pandaura AS. These Terms of Use govern your use of the Pandaura AS software platform, licensed and operated by Pandaura Labs AS. By using our software, you agree to the terms below. If you do not agree, you should not use the software."})})},{id:"scope",title:"Scope of Use",content:e.jsx("div",{className:"space-y-4",children:e.jsx("p",{className:"text-muted",children:"Pandaura AS is licensed software designed for use in professional industrial automation environments. You may use the software solely within your organization for engineering, configuration, logic generation, and automation project development."})})},{id:"licensing",title:"Licensing & Ownership",content:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-muted",children:"Pandaura AS is licensed, not sold. All rights, title, and interest in the softwareincluding AI-generated logic, interface design, and proprietary workflowsremain the property of Pandaura Labs AS."}),e.jsx("p",{className:"text-muted",children:"You may not reverse engineer, decompile, or resell the software without express written permission."})]})},{id:"responsibilities",title:"User Responsibilities",content:e.jsx("div",{className:"space-y-4",children:e.jsxs("ul",{className:"space-y-2 text-muted list-disc list-inside",children:[e.jsx("li",{children:"You are responsible for how the software is used within your organization."}),e.jsx("li",{children:"You must ensure only authorized users access the software."}),e.jsx("li",{children:"You agree not to use Pandaura AS for unlawful or unsafe automation tasks."})]})})},{id:"ai-content",title:"AI-Generated Content",content:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-muted",children:"Pandaura AS includes AI systems that assist in generating automation logic. While powerful, this logic may require review by qualified engineers."}),e.jsx("p",{className:"text-muted font-medium",children:"You remain solely responsible for validating and approving all outputs used in real-world environments."})]})},{id:"data-privacy",title:"Data & Privacy",content:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-muted",children:"Pandaura AS is a fully on-premise platform. We do not collect or transmit user data, logic, or documents externally."}),e.jsx("p",{className:"text-muted font-medium",children:"Your data remains 100% within your environment, under your control."})]})},{id:"updates",title:"Software Updates",content:e.jsx("div",{className:"space-y-4",children:e.jsx("p",{className:"text-muted",children:"Any software updates or patches will be delivered offline, and it is your responsibility to apply them. Pandaura Labs is not liable for issues arising from the use of outdated software versions."})})},{id:"warranty",title:"Warranty Disclaimer",content:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-muted font-medium",children:'Pandaura AS is provided "as is" without warranties of any kind.'}),e.jsx("p",{className:"text-muted",children:"We do not guarantee uninterrupted operation, nor do we accept liability for logic errors, production downtime, or misconfigurations caused by user input or AI-generated suggestions."})]})},{id:"liability",title:"Limitation of Liability",content:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-muted",children:"To the maximum extent permitted by law, Pandaura Labs AS shall not be liable for any indirect, incidental, or consequential damages resulting from the use of Pandaura AS."}),e.jsx("p",{className:"text-muted",children:"Your sole remedy for dissatisfaction with the software is to stop using it."})]})},{id:"termination",title:"Termination",content:e.jsx("div",{className:"space-y-4",children:e.jsx("p",{className:"text-muted",children:"Pandaura Labs reserves the right to revoke access or terminate licenses if terms are violated or if the software is used in breach of ethical or legal standards."})})},{id:"governing-law",title:"Governing Law",content:e.jsx("div",{className:"space-y-4",children:e.jsx("p",{className:"text-muted",children:"These Terms are governed by the laws of Norway. Any disputes shall be resolved in the appropriate courts of Oslo, Norway."})})},{id:"contact",title:"Contact",content:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-muted",children:"For licensing inquiries or enterprise agreements, please contact your Pandaura Labs representative directly."}),e.jsx("p",{className:"text-xs text-muted italic",children:"(Note: No public email or feedback form is provided on this page.)"})]})}];return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"bg-surface border-b border-light px-6 py-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>t(-1),className:"p-2 hover:bg-background rounded-md transition-colors",title:"Go back",children:e.jsx(Oe,{className:"w-5 h-5 text-secondary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-primary",children:"Terms of Use"}),e.jsx("p",{className:"text-sm text-secondary",children:e.jsx("button",{onClick:()=>t("/privacy"),className:"hover:text-primary transition-colors underline",children:"View Privacy Policy"})})]})]}),e.jsxs("button",{onClick:o,className:"flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-md hover:bg-secondary transition-colors text-sm",children:[e.jsx(Ze,{className:"w-4 h-4"}),"Download Terms of Use (PDF)"]})]})}),e.jsxs("div",{className:"max-w-4xl mx-auto px-6 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-primary mb-2",children:"Terms of Use"}),e.jsx("p",{className:"text-sm text-muted",children:"Last Updated: August 5, 2025"})]}),e.jsx("div",{className:"space-y-4 mb-8",children:n.map(i=>e.jsxs("div",{className:"bg-surface border border-light rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>a(i.id),className:"w-full flex items-center justify-between p-6 text-left hover:bg-background transition-colors",children:[e.jsx("h3",{className:"text-lg font-semibold text-primary",children:i.title}),s.has(i.id)?e.jsx(et,{className:"w-5 h-5 text-secondary"}):e.jsx(gt,{className:"w-5 h-5 text-secondary"})]}),s.has(i.id)&&e.jsx("div",{className:"px-6 pb-6 border-t border-light",children:e.jsx("div",{className:"pt-4",children:i.content})})]},i.id))}),e.jsx("div",{className:"text-center text-sm text-muted",children:e.jsx("p",{children:"For questions about these terms, please contact your Pandaura Labs representative."})})]})]})}function Bs(){const t=he(),[s,r]=l.useState(null),[a]=l.useState([{id:"1",title:"Water Treatment Automation",status:"completed",lastModified:"2 days ago"},{id:"2",title:"Packaging Line Integration",status:"draft",lastModified:"1 week ago"}]),[o,n]=l.useState([{id:"overview",title:"Project Overview",description:"Basic project information and scope",isExpanded:!0},{id:"challenge",title:"Technical Challenge",description:"What made this project unique or difficult",isExpanded:!1},{id:"pandaura",title:"How Pandaura Helped",description:"Which features were used and their impact",isExpanded:!1},{id:"outcome",title:"Outcome & Results",description:"Final results and client feedback",isExpanded:!1},{id:"media",title:"Media Uploads",description:"Screenshots, PDFs, and documentation",isExpanded:!1},{id:"privacy",title:"Privacy & Security",description:"Data protection and sharing preferences",isExpanded:!1}]),[i,c]=l.useState(""),[m,u]=l.useState({title:"",company:"",industry:"",platforms:[],scope:"",timeline:"",challenge:"",uniqueAspects:"",featuresUsed:[],howPandauraHelped:"",aiUsed:"",timeSavings:"",outcome:"",clientQuote:"",metrics:"",removeClientData:!0,confirmNoSensitiveData:!1}),[h,f]=l.useState([]),b={selectProject:"Link this case study to an existing project for automatic data import",projectTitle:"Give your case study a clear, descriptive title that highlights the key achievement",plcPlatforms:"Select all PLC platforms that were used in this project",scopeSummary:"Briefly describe what the project covered - scope, systems involved, and scale",finalOutcome:"Describe the successful completion and measurable results of the project",uploadFiles:"Upload project documentation, screenshots, or technical diagrams (max 10MB each)"},w=({id:y,content:d})=>{const[g,A]=l.useState({x:0,y:0}),O=we.useRef(null),D=()=>{if(O.current){const L=O.current.getBoundingClientRect();A({x:L.left+L.width/2,y:L.top-10})}r(y)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:O,className:"relative inline-block",children:e.jsx(da,{className:"w-4 h-4 inline ml-1 text-muted hover:text-primary cursor-help transition-colors",onMouseEnter:D,onMouseLeave:()=>r(null)})}),s===y&&e.jsxs("div",{className:"fixed px-3 py-2 bg-gray-900 text-white text-xs rounded-md whitespace-nowrap shadow-lg pointer-events-none",style:{left:`${g.x}px`,top:`${g.y}px`,transform:"translate(-50%, -100%)",zIndex:99999},children:[d,e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-gray-900"})]})]})},p=y=>{n(d=>d.map(g=>g.id===y?{...g,isExpanded:!g.isExpanded}:g))},S=(y,d,g)=>{(y==="platforms"||y==="featuresUsed")&&u(A=>({...A,[y]:g?[...A[y],d]:A[y].filter(O=>O!==d)}))},N=y=>{y.target.files&&f(d=>[...d,...Array.from(y.target.files)])},C=y=>{f(d=>d.filter((g,A)=>A!==y))},k=()=>{console.log("Saving draft...",m),alert("Case study saved as draft locally.")},j=()=>{if(!m.confirmNoSensitiveData){alert("Please confirm that no sensitive client data is included before uploading.");return}console.log("Uploading to Case Study Hub...",m),window.confirm("Looks great. Once you submit, your case study will be visible to others on the Pandaura Case Study Hub. Just make sure you've removed anything private  you're always in full control.")&&alert(" Case study uploaded to Pandaura Case Study Hub!")},v=["Oil & Gas","Pharmaceutical","Food & Beverage","OEM","Automotive","Water Treatment","Power Generation","Manufacturing","Chemical","Other"],x=["Rockwell","Siemens","Beckhoff","Schneider","Omron","ABB","Other"],T=["Logic Studio","Tag Manager","SignalFlow","AutoDocs","Assistant / Mini"];return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"bg-surface border-b border-light px-6 py-4",children:e.jsxs("div",{className:"max-w-6xl mx-auto flex items-center gap-4",children:[e.jsx("button",{onClick:()=>t(-1),className:"p-2 hover:bg-background rounded-md transition-colors",title:"Go back",children:e.jsx(Oe,{className:"w-5 h-5 text-secondary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-primary",children:"Create a Case Study"}),e.jsx("p",{className:"text-sm text-secondary",children:"Generate professional case studies from your projects"})]})]})}),e.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-8",children:[e.jsxs("div",{className:"bg-surface border border-light rounded-lg p-6 mb-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h2",{className:"text-lg font-semibold text-primary",children:"Project Selection"})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-secondary mb-2",children:["Select Project (Optional)",e.jsx(w,{id:"selectProject",content:b.selectProject})]}),e.jsxs("select",{value:i,onChange:y=>c(y.target.value),className:"w-full px-3 py-2 bg-background border border-light rounded-md text-primary focus:outline-none focus:ring-2 focus:ring-accent",children:[e.jsx("option",{value:"",children:"Start from scratch"}),e.jsx("option",{value:"water-treatment",children:"Water Treatment Plant"}),e.jsx("option",{value:"packaging-line",children:"Packaging Line Control"}),e.jsx("option",{value:"hvac-system",children:"HVAC System Integration"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{onClick:()=>{console.log("Starting new case study...")},className:"flex items-center gap-2 bg-primary text-white px-4 py-2 rounded-md hover:bg-secondary transition-colors",children:[e.jsx(pt,{className:"w-4 h-4"}),"Start New Case Study"]})})]}),a.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-sm font-medium text-secondary mb-3",children:"Recent Case Studies"}),e.jsx("div",{className:"grid md:grid-cols-2 gap-3",children:a.map(y=>e.jsx("button",{className:"text-left p-3 bg-background border border-light rounded-md hover:border-accent transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-primary",children:y.title}),e.jsxs("p",{className:"text-xs text-muted",children:[y.status,"  ",y.lastModified]})]}),e.jsx("div",{className:`w-2 h-2 rounded-full ${y.status==="completed"?"bg-green-500":"bg-yellow-500"}`})]})},y.id))})]})]}),e.jsxs("div",{className:"space-y-6",children:[o.map(y=>e.jsxs("div",{className:"bg-surface border border-light rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>p(y.id),className:"w-full flex items-center justify-between p-6 text-left hover:bg-background transition-colors",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-primary",children:y.title}),e.jsx("p",{className:"text-sm text-muted",children:y.description})]}),y.isExpanded?e.jsx(et,{className:"w-5 h-5 text-secondary"}):e.jsx(gt,{className:"w-5 h-5 text-secondary"})]}),y.isExpanded&&e.jsx("div",{className:"px-6 pb-6 border-t border-light",children:e.jsxs("div",{className:"pt-6 space-y-4",children:[y.id==="overview"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-secondary mb-2",children:["Project Title",e.jsx(w,{id:"projectTitle",content:b.projectTitle})]}),e.jsx("input",{type:"text",value:m.title,onChange:d=>u(g=>({...g,title:d.target.value})),className:"w-full px-3 py-2 bg-background border border-light rounded-md text-primary focus:outline-none focus:ring-2 focus:ring-accent",placeholder:"e.g., Smart Water Treatment Integration"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary mb-2",children:"Integrator Name / Company (Optional)"}),e.jsx("input",{type:"text",value:m.company,onChange:d=>u(g=>({...g,company:d.target.value})),className:"w-full px-3 py-2 bg-background border border-light rounded-md text-primary focus:outline-none focus:ring-2 focus:ring-accent",placeholder:"Your company name"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary mb-2",children:"Client Industry"}),e.jsxs("select",{value:m.industry,onChange:d=>u(g=>({...g,industry:d.target.value})),className:"w-full px-3 py-2 bg-background border border-light rounded-md text-primary focus:outline-none focus:ring-2 focus:ring-accent",children:[e.jsx("option",{value:"",children:"Select industry..."}),v.map(d=>e.jsx("option",{value:d,children:d},d))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary mb-2",children:"Timeline (Optional)"}),e.jsx("input",{type:"text",value:m.timeline,onChange:d=>u(g=>({...g,timeline:d.target.value})),className:"w-full px-3 py-2 bg-background border border-light rounded-md text-primary focus:outline-none focus:ring-2 focus:ring-accent",placeholder:"e.g., 3 months, Q1 2024"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-secondary mb-2",children:["PLC Platforms Used",e.jsx(w,{id:"plcPlatforms",content:b.plcPlatforms})]}),e.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 gap-2",children:x.map(d=>e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:m.platforms.includes(d),onChange:g=>S("platforms",d,g.target.checked),className:"w-4 h-4 text-primary bg-surface border-strong rounded focus:ring-accent focus:ring-2"}),e.jsx("span",{className:"text-sm text-primary",children:d})]},d))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-secondary mb-2",children:["Scope Summary",e.jsx(w,{id:"scopeSummary",content:b.scopeSummary})]}),e.jsx("textarea",{value:m.scope,onChange:d=>u(g=>({...g,scope:d.target.value})),className:"w-full px-3 py-2 bg-background border border-light rounded-md text-primary focus:outline-none focus:ring-2 focus:ring-accent resize-none",rows:4,placeholder:"Describe the overall project scope and objectives..."})]})]}),y.id==="challenge"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary mb-2",children:"What was the original challenge or complexity?"}),e.jsx("textarea",{value:m.challenge,onChange:d=>u(g=>({...g,challenge:d.target.value})),className:"w-full px-3 py-2 bg-background border border-light rounded-md text-primary focus:outline-none focus:ring-2 focus:ring-accent resize-none",rows:4,placeholder:"Describe the technical challenges you faced..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary mb-2",children:"What made this project unique or difficult?"}),e.jsx("textarea",{value:m.uniqueAspects,onChange:d=>u(g=>({...g,uniqueAspects:d.target.value})),className:"w-full px-3 py-2 bg-background border border-light rounded-md text-primary focus:outline-none focus:ring-2 focus:ring-accent resize-none",rows:4,placeholder:"What set this project apart from typical automation work..."})]})]}),y.id==="pandaura"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary mb-2",children:"Which Pandaura AS features were used?"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:T.map(d=>e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:m.featuresUsed.includes(d),onChange:g=>S("featuresUsed",d,g.target.checked),className:"w-4 h-4 text-primary bg-surface border-strong rounded focus:ring-accent focus:ring-2"}),e.jsx("span",{className:"text-sm text-primary",children:d})]},d))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary mb-2",children:"Describe how Pandaura made the project easier or faster"}),e.jsx("textarea",{value:m.howPandauraHelped,onChange:d=>u(g=>({...g,howPandauraHelped:d.target.value})),className:"w-full px-3 py-2 bg-background border border-light rounded-md text-primary focus:outline-none focus:ring-2 focus:ring-accent resize-none",rows:4,placeholder:"Explain the specific ways Pandaura helped..."})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary mb-2",children:"Any AI-generated logic or documents used?"}),e.jsx("textarea",{value:m.aiUsed,onChange:d=>u(g=>({...g,aiUsed:d.target.value})),className:"w-full px-3 py-2 bg-background border border-light rounded-md text-primary focus:outline-none focus:ring-2 focus:ring-accent resize-none",rows:3,placeholder:"Describe AI assistance received..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary mb-2",children:"Time savings or value gained? (Optional)"}),e.jsx("textarea",{value:m.timeSavings,onChange:d=>u(g=>({...g,timeSavings:d.target.value})),className:"w-full px-3 py-2 bg-background border border-light rounded-md text-primary focus:outline-none focus:ring-2 focus:ring-accent resize-none",rows:3,placeholder:"Quantify benefits if possible..."})]})]})]}),y.id==="outcome"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-secondary mb-2",children:["Final project outcome",e.jsx(w,{id:"finalOutcome",content:b.finalOutcome})]}),e.jsx("textarea",{value:m.outcome,onChange:d=>u(g=>({...g,outcome:d.target.value})),className:"w-full px-3 py-2 bg-background border border-light rounded-md text-primary focus:outline-none focus:ring-2 focus:ring-accent resize-none",rows:4,placeholder:"Describe the successful outcome and results..."})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary mb-2",children:"What did the client say? (Optional quote/testimonial)"}),e.jsx("textarea",{value:m.clientQuote,onChange:d=>u(g=>({...g,clientQuote:d.target.value})),className:"w-full px-3 py-2 bg-background border border-light rounded-md text-primary focus:outline-none focus:ring-2 focus:ring-accent resize-none",rows:3,placeholder:"Client feedback or testimonial..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary mb-2",children:"Did Pandaura reduce time, errors, or handoff problems?"}),e.jsx("textarea",{value:m.metrics,onChange:d=>u(g=>({...g,metrics:d.target.value})),className:"w-full px-3 py-2 bg-background border border-light rounded-md text-primary focus:outline-none focus:ring-2 focus:ring-accent resize-none",rows:3,placeholder:"Specific improvements achieved..."})]})]})]}),y.id==="media"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-secondary mb-2",children:["Upload Files (Optional)",e.jsx(w,{id:"uploadFiles",content:b.uploadFiles})]}),e.jsxs("div",{className:"border-2 border-dashed border-light rounded-lg p-6 text-center",children:[e.jsx("input",{type:"file",multiple:!0,onChange:N,className:"hidden",id:"file-upload",accept:".jpg,.jpeg,.png,.pdf,.doc,.docx"}),e.jsx("label",{htmlFor:"file-upload",className:"cursor-pointer",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(wo,{className:"w-8 h-8 text-muted"}),e.jsx(Me,{className:"w-8 h-8 text-muted"})]})}),e.jsx("p",{className:"text-primary",children:"Click to upload files"}),e.jsx("p",{className:"text-xs text-muted",children:"Screenshots, PDFs, exported logic blocks"}),e.jsx("p",{className:"text-xs text-muted",children:"Max 10MB per file  JPG, PNG, PDF, DOC"})]})})]})]}),h.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-secondary mb-2",children:"Uploaded Files"}),e.jsx("div",{className:"space-y-2",children:h.map((d,g)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-background border border-light rounded-md",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Me,{className:"w-4 h-4 text-muted"}),e.jsx("span",{className:"text-sm text-primary",children:d.name}),e.jsxs("span",{className:"text-xs text-muted",children:["(",(d.size/1024).toFixed(1)," KB)"]})]}),e.jsx("button",{onClick:()=>C(g),className:"text-error hover:text-error-dark transition-colors",children:e.jsx(Ft,{className:"w-4 h-4"})})]},g))})]})]}),y.id==="privacy"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-accent/5 border border-accent/20 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(qe,{className:"w-5 h-5 text-accent flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-primary mb-2",children:"Privacy & Security Controls"}),e.jsx("p",{className:"text-sm text-muted",children:"You're always in control. Please double-check that any identifying info is removed  we'll never expose sensitive details."})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:m.removeClientData,onChange:d=>u(g=>({...g,removeClientData:d.target.checked})),className:"w-4 h-4 text-primary bg-surface border-strong rounded focus:ring-accent focus:ring-2 mt-1"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-primary",children:"Remove client-identifying data"}),e.jsx("p",{className:"text-xs text-muted",children:"Automatically sanitize client names and sensitive information (recommended)"})]})]}),e.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:m.confirmNoSensitiveData,onChange:d=>u(g=>({...g,confirmNoSensitiveData:d.target.checked})),className:"w-4 h-4 text-primary bg-surface border-strong rounded focus:ring-accent focus:ring-2 mt-1"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-primary",children:"I confirm this case study contains no confidential or sensitive client data"}),e.jsx("p",{className:"text-xs text-muted",children:"Required before uploading to public Case Study Hub"})]})]})]})]})]})})]},y.id)),e.jsxs("div",{className:"bg-surface border border-light rounded-lg p-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 justify-between",children:[e.jsxs("button",{onClick:k,className:"flex items-center gap-2 px-6 py-3 bg-background border border-light rounded-md hover:border-accent transition-colors",children:[e.jsx(He,{className:"w-4 h-4"}),"Save Draft"]}),e.jsxs("button",{onClick:j,className:"flex items-center gap-2 px-6 py-3 bg-primary text-white rounded-md hover:bg-secondary transition-colors",children:[e.jsx(_t,{className:"w-4 h-4"}),"Upload to Case Study Hub"]})]}),e.jsx("p",{className:"text-xs text-muted mt-3 text-center",children:"Drafts are stored locally only. Uploading shares your case study publicly with the automation community."})]})]})]})]})}function Au(){const t=Le(),[s,r]=l.useState({auth:{isAuthenticated:!1,token:null,user:null},api:{canConnect:!1,error:null},projects:{count:0,data:[],error:null}}),[a,o]=l.useState(!1),[n,i]=l.useState(""),c=async()=>{o(!0),i("");try{const u={projectName:`Test Project ${Date.now()}`,clientName:"Debug Client",projectType:"industrial-automation",targetPLCVendor:"siemens",description:"This is a test project created from the debug page"},h=await ae.createProject(u);console.log("Created test project:",h),await m()}catch(u){console.error("Failed to create test project:",u),i(u.message||"Failed to create project")}finally{o(!1)}},m=async()=>{const u={auth:{isAuthenticated:t.isAuthenticated,token:t.token,user:t.user},api:{canConnect:!1,error:null},projects:{count:0,data:[],error:null}};if(t.isAuthenticated&&t.token)try{const h=await ae.getProjects();u.api.canConnect=!0,u.projects.count=h.length,u.projects.data=h}catch(h){u.api.error=h.message,u.projects.error=h.message}else u.api.error="Not authenticated",u.projects.error="Not authenticated";r(u)};return l.useEffect(()=>{m()},[t.isAuthenticated,t.token]),e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-primary",children:"Projects Debug Dashboard"}),e.jsx(Ee,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Authentication Status"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-3 h-3 rounded-full ${s.auth.isAuthenticated?"bg-green-500":"bg-red-500"}`}),e.jsxs("span",{children:["Authenticated: ",s.auth.isAuthenticated?"Yes":"No"]})]}),e.jsx("div",{children:e.jsxs("span",{children:["User: ",s.auth.user?.email||"None"]})}),e.jsx("div",{children:e.jsxs("span",{children:["Token: ",s.auth.token?"Present":"Missing"]})})]})]})}),e.jsx(Ee,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"API Connection"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-3 h-3 rounded-full ${s.api.canConnect?"bg-green-500":"bg-red-500"}`}),e.jsxs("span",{children:["API Connection: ",s.api.canConnect?"Working":"Failed"]})]}),s.api.error&&e.jsxs(ht,{variant:"error",children:["API Error: ",s.api.error]})]})]})}),e.jsx(Ee,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4",children:["Projects (",s.projects.count,")"]}),s.projects.error?e.jsxs(ht,{variant:"error",children:["Projects Error: ",s.projects.error]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{children:["Total Projects: ",s.projects.count]}),e.jsxs("div",{className:"space-x-2",children:[e.jsx(F,{onClick:m,variant:"secondary",size:"sm",children:"Refresh"}),e.jsx(F,{onClick:c,disabled:!s.auth.isAuthenticated||a,children:a?"Creating...":"Create Test Project"})]})]}),n&&e.jsxs(ht,{variant:"error",children:["Create Project Error: ",n]}),s.projects.data.length>0&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 max-h-64 overflow-y-auto",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Project List:"}),s.projects.data.map((u,h)=>e.jsxs("div",{className:"border-b border-gray-200 pb-2 mb-2 last:border-b-0",children:[e.jsx("div",{className:"font-medium",children:u.project_name}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Client: ",u.client_name||"N/A"," | Type: ",u.project_type||"N/A"," | Vendor: ",u.target_plc_vendor||"N/A"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Created: ",new Date(u.created_at).toLocaleString()]})]},u.id||h))]})]})]})}),e.jsx(Ee,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Instructions"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("p",{children:"1. Make sure you're logged in (authentication status should be green)"}),e.jsx("p",{children:"2. Check that the API connection is working (should be green)"}),e.jsx("p",{children:"3. Create a test project using the button above"}),e.jsx("p",{children:"4. Navigate to /home/projects to see your projects"}),e.jsx("p",{children:"5. Click on a project to view the Project Overview screen"})]})]})})]})})}const dn=l.createContext(void 0),Kr={orgChoice:null,organizationCreated:!1},Tu=({children:t})=>{const[s,r]=l.useState(Kr),a=(i,c)=>{r(m=>({...m,[i]:c}))},o=()=>{r(Kr)},n=!!(s.orgChoice&&s.accountData?.fullName&&s.accountData?.email&&s.accountData?.password&&(s.orgChoice==="join"?s.inviteData:s.orgData)&&s.securityData?.verified&&s.consentData?.termsAccepted&&s.consentData?.privacyAccepted&&s.environmentData&&s.organizationCreated);return e.jsx(dn.Provider,{value:{signUpData:s,updateSignUpData:a,clearSignUpData:o,isComplete:n},children:t})},tt=()=>{const t=l.useContext(dn);if(!t)throw new Error("useSignUp must be used within SignUpProvider");return t};function Qr({nextStep:t}){const s=he();return e.jsx("div",{className:"w-full max-w-md mx-auto",children:e.jsx("div",{className:"bg-white rounded-lg shadow-lg p-8",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("img",{src:je,alt:"Pandaura AS Logo",className:"h-20 w-auto filter-none mb-6",style:{filter:"none",imageRendering:"crisp-edges"}}),e.jsx("h1",{className:"text-2xl font-bold text-primary text-center mb-2",children:"Welcome to Pandaura AS"}),e.jsx("p",{className:"text-secondary text-center mb-8",children:"Your complete industrial automation platform for PLCs, SCADA, and robotics"}),e.jsxs("div",{className:"w-full space-y-4",children:[e.jsx(F,{onClick:t,className:"w-full",size:"lg",children:"Create Organization / Join Team"}),e.jsx(F,{onClick:()=>s("/signin"),variant:"outline",className:"w-full",size:"lg",children:"Sign In"})]}),e.jsx("div",{className:"mt-8 text-center text-sm text-muted",children:e.jsx("p",{children:"Secure  On-Premise  Zero Trust"})})]})})})}function Pu({nextStep:t,prevStep:s,onOrgChoice:r}){const{signUpData:a}=tt(),[o,n]=l.useState(a.orgChoice),[i,c]=l.useState(a.inviteData?.code||""),[m,u]=l.useState(!1),[h,f]=l.useState(""),{validateInvite:b}=Le(),w=()=>{r("create"),t()},p=async()=>{if(!i.trim()){f("Please enter an invite code");return}u(!0),f("");try{const N=await b(i.trim());N.valid?(r("join",{code:i.trim(),orgName:N.orgName,role:N.role,email:N.email}),t()):f(N.message||"Invalid or expired invite code")}catch{f("Failed to validate invite code. Please try again.")}finally{u(!1)}},S=N=>{navigator.clipboard.writeText(N),c(N)};return e.jsx("div",{className:"w-full max-w-md mx-auto",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("button",{onClick:s,className:"mr-3 p-1 rounded-md hover:bg-gray-100 transition-colors",children:e.jsx(Oe,{className:"w-5 h-5 text-secondary"})}),e.jsx("h2",{className:"text-xl font-semibold text-primary",children:"Get Started"})]}),e.jsx("p",{className:"text-secondary mb-6",children:"Choose how you'd like to begin with Pandaura AS:"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:`border-2 rounded-lg p-4 cursor-pointer transition-all ${o==="create"?"border-accent bg-accent-light":"border-light hover:border-accent/50"}`,onClick:()=>n("create"),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-2 rounded-md mr-4 ${o==="create"?"bg-accent text-white":"bg-gray-100 text-secondary"}`,children:e.jsx(sr,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-primary",children:"Create New Organization"}),e.jsx("p",{className:"text-sm text-secondary",children:"Start fresh and set up your team's automation workspace"})]})]})}),e.jsx("div",{className:`border-2 rounded-lg p-4 cursor-pointer transition-all ${o==="join"?"border-accent bg-accent-light":"border-light hover:border-accent/50"}`,onClick:()=>n("join"),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-2 rounded-md mr-4 ${o==="join"?"bg-accent text-white":"bg-gray-100 text-secondary"}`,children:e.jsx(bs,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-primary",children:"Join Existing Team"}),e.jsx("p",{className:"text-sm text-secondary",children:"Use an invite code to join your organization"})]})]})})]}),o==="join"&&e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-3",children:"For Testing - Sample Invite Codes:"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"bg-white rounded border p-2 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-mono text-sm text-blue-800",children:"TESTCODE123"}),e.jsx("div",{className:"text-xs text-blue-600",children:"Viewer role  test@example.com"})]}),e.jsx("button",{onClick:()=>S("TESTCODE123"),className:"p-1 text-blue-600 hover:text-blue-800 hover:bg-blue-100 rounded",title:"Copy and use this code",children:e.jsx(Ds,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"bg-white rounded border p-2 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-mono text-sm text-blue-800",children:"ADMINCODE456"}),e.jsx("div",{className:"text-xs text-blue-600",children:"Admin role  admin@example.com"})]}),e.jsx("button",{onClick:()=>S("ADMINCODE456"),className:"p-1 text-blue-600 hover:text-blue-800 hover:bg-blue-100 rounded",title:"Copy and use this code",children:e.jsx(Ds,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"bg-white rounded border p-2 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-mono text-sm text-blue-800",children:"EDITORCODE789"}),e.jsx("div",{className:"text-xs text-blue-600",children:"Editor role  editor@example.com"})]}),e.jsx("button",{onClick:()=>S("EDITORCODE789"),className:"p-1 text-blue-600 hover:text-blue-800 hover:bg-blue-100 rounded",title:"Copy and use this code",children:e.jsx(Ds,{className:"w-4 h-4"})})]})]}),e.jsx("p",{className:"text-xs text-blue-700 mt-2",children:"Click the copy icon to use any of these test codes."})]}),e.jsxs("div",{children:[e.jsx(ve,{label:"Invite Code",placeholder:"Enter your invite code or paste invite link",value:i,onChange:N=>c(N.target.value),error:h,disabled:m}),e.jsx("p",{className:"text-xs text-muted mt-2",children:"Contact your organization admin for an invite code"})]}),e.jsx(F,{onClick:p,disabled:!i.trim()||m,className:"w-full",loading:m,children:m?"Validating...":"Validate & Continue"})]}),o==="create"&&e.jsx("div",{className:"mt-6",children:e.jsx(F,{onClick:w,className:"w-full",children:"Continue to Organization Setup"})}),e.jsx("div",{className:"mt-6 text-center text-sm text-muted",children:e.jsx("p",{children:"Need help? Contact your administrator or check your email for an invite."})})]})})}const Eu=[{value:"manufacturing",label:"Manufacturing"},{value:"automotive",label:"Automotive"},{value:"food-beverage",label:"Food & Beverage"},{value:"oil-gas",label:"Oil & Gas"},{value:"pharmaceuticals",label:"Pharmaceuticals"},{value:"water-treatment",label:"Water Treatment"},{value:"power-energy",label:"Power & Energy"},{value:"mining",label:"Mining"},{value:"chemical",label:"Chemical"},{value:"other",label:"Other"}],Du=[{value:"1-10",label:"1-10 employees"},{value:"11-50",label:"11-50 employees"},{value:"51-200",label:"51-200 employees"},{value:"201-1000",label:"201-1000 employees"},{value:"1000+",label:"1000+ employees"}];function Ou({nextStep:t,prevStep:s,onOrgData:r,isJoining:a=!1,inviteData:o}){const{signUpData:n}=tt(),[i,c]=l.useState({orgName:o?.orgName||n.orgData?.orgName||"",industry:n.orgData?.industry||"",size:n.orgData?.size||""}),[m,u]=l.useState({});l.useEffect(()=>{n.orgData&&c(w=>({...w,orgName:o?.orgName||n.orgData?.orgName||w.orgName,industry:n.orgData?.industry||w.industry,size:n.orgData?.size||w.size}))},[n.orgData,o?.orgName]);const h=(w,p)=>{c(S=>({...S,[w]:p})),m[w]&&u(S=>({...S,[w]:""}))},f=()=>{const w={};return!a&&!i.orgName.trim()&&(w.orgName="Organization name is required"),i.industry||(w.industry="Please select your industry"),i.size||(w.size="Please select organization size"),u(w),Object.keys(w).length===0},b=()=>{f()&&(r(i),t())};return e.jsx("div",{className:"w-full max-w-md mx-auto",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("button",{onClick:s,className:"mr-3 p-1 rounded-md hover:bg-gray-100 transition-colors",children:e.jsx(Oe,{className:"w-5 h-5 text-secondary"})}),e.jsx("h2",{className:"text-xl font-semibold text-primary",children:a?"Organization Details":"Create Organization"})]}),a&&e.jsxs("div",{className:"mb-6 p-4 bg-accent-light rounded-lg",children:[e.jsxs("p",{className:"text-sm text-primary",children:[e.jsx("strong",{children:"Joining:"})," ",o?.orgName]}),e.jsxs("p",{className:"text-sm text-secondary",children:["Role: ",o?.role]})]}),e.jsxs("div",{className:"space-y-4",children:[!a&&e.jsx(ve,{label:"Organization / Company Name",placeholder:"Enter your organization name",value:i.orgName,onChange:w=>h("orgName",w.target.value),error:m.orgName,required:!0}),e.jsx(Ue,{label:"Industry Sector",placeholder:"Select your industry",options:Eu,value:i.industry,onChange:w=>h("industry",w),error:m.industry,required:!0}),e.jsx(Ue,{label:"Organization Size",placeholder:"Select organization size",options:Du,value:i.size,onChange:w=>h("size",w),error:m.size,required:!0})]}),e.jsx("div",{className:"mt-8",children:e.jsx(F,{onClick:b,className:"w-full",size:"lg",children:"Continue to Account Setup"})}),e.jsx("div",{className:"mt-6 text-center text-sm text-muted",children:e.jsx("p",{children:"This information helps us customize your automation workspace"})})]})})}function Zr(t){return/.+@.+\..+/.test(t)}function ea(t){return{length:t.length>=12,uppercase:/[A-Z]/.test(t),lowercase:/[a-z]/.test(t),number:/[0-9]/.test(t),special:/[^A-Za-z0-9]/.test(t)}}function ta({nextStep:t,prevStep:s,onAccountData:r,isJoining:a=!1,inviteData:o}){const[n,i]=l.useState({fullName:"",email:"",password:"",confirmPassword:""}),[c,m]=l.useState({}),[u,h]=l.useState(!1),[f,b]=l.useState(!1),[w,p]=l.useState(!1),{createOrganization:S,acceptInvite:N}=Le(),{signUpData:C,updateSignUpData:k}=tt(),{showToast:j}=Ge();we.useEffect(()=>{C.accountData&&i(d=>({...d,fullName:C.accountData?.fullName||d.fullName,email:C.accountData?.email||d.email,password:C.accountData?.password||d.password,confirmPassword:C.accountData?.confirmPassword||d.confirmPassword}))},[C.accountData]);const v=(d,g)=>{const A={...n,[d]:g};if(i(A),k("accountData",{fullName:A.fullName,email:A.email,password:A.password,confirmPassword:A.confirmPassword}),c[d]&&m(O=>({...O,[d]:""})),d==="email"&&g&&!Zr(g)&&m(O=>({...O,email:"Please enter a valid email address"})),d==="confirmPassword"||d==="password"&&A.confirmPassword){const O=d==="password"?g:A.password,D=d==="confirmPassword"?g:A.confirmPassword;m(D&&O!==D?L=>({...L,confirmPassword:"Passwords do not match"}):L=>({...L,confirmPassword:""}))}},x=()=>{const d={};if(n.fullName.trim()||(d.fullName="Full name is required"),n.email.trim()?Zr(n.email)||(d.email="Please enter a valid email address"):d.email="Email is required",!n.password)d.password="Password is required";else{const g=ea(n.password);Object.values(g).every(Boolean)||(d.password="Password does not meet all requirements")}return n.confirmPassword?n.password!==n.confirmPassword&&(d.confirmPassword="Passwords do not match"):d.confirmPassword="Please confirm your password",m(d),Object.keys(d).length===0},T=async()=>{if(x()){p(!0);try{if(k("accountData",{fullName:n.fullName,email:n.email,password:n.password,confirmPassword:n.confirmPassword}),r(n),C.orgChoice==="create"&&C.orgData&&!a){const d=await S({orgName:C.orgData.orgName,industry:C.orgData.industry,size:C.orgData.size,fullName:n.fullName,email:n.email,password:n.password});d.success?(j({variant:"success",title:"Organization Created!",message:`Welcome to ${C.orgData.orgName}! Your organization has been successfully created.`,duration:5e3}),k("organizationCreated",!0),t()):j({variant:"error",title:"Organization Creation Failed",message:d.message||"Failed to create organization. Please try again.",duration:5e3})}else if(C.orgChoice==="join"&&C.inviteData&&a){const d=await N({code:C.inviteData.code,fullName:n.fullName,email:n.email,password:n.password});d.success?(j({variant:"success",title:"Welcome to the Team!",message:`Successfully joined ${C.inviteData.orgName}! Your account has been created.`,duration:5e3}),k("organizationCreated",!0),t()):j({variant:"error",title:"Join Organization Failed",message:d.message||"Failed to join organization. Please try again.",duration:5e3})}else t()}catch(d){console.error("Organization creation error:",d),j({variant:"error",title:"Error",message:"An unexpected error occurred. Please try again.",duration:5e3})}finally{p(!1)}}},y=ea(n.password);return e.jsx("div",{className:"w-full max-w-md mx-auto",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("button",{onClick:s,className:"mr-3 p-1 rounded-md hover:bg-gray-100 transition-colors",children:e.jsx(Oe,{className:"w-5 h-5 text-secondary"})}),e.jsx("h2",{className:"text-xl font-semibold text-primary",children:"Account Setup"})]}),a&&o&&e.jsxs("div",{className:"mb-6 p-4 bg-accent-light rounded-lg",children:[e.jsxs("p",{className:"text-sm text-primary",children:[e.jsx("strong",{children:"Joining:"})," ",o.orgName]}),e.jsxs("p",{className:"text-sm text-secondary",children:["Role: ",o.role]}),e.jsx("p",{className:"text-xs text-secondary mt-2",children:"You can use any email address for your account."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(ve,{label:"Full Name",placeholder:"Enter your full name",value:n.fullName,onChange:d=>v("fullName",d.target.value),error:c.fullName,required:!0}),e.jsx(ve,{label:"Work Email",type:"email",placeholder:"Enter your work email",value:n.email,onChange:d=>v("email",d.target.value),error:c.email,required:!0}),e.jsxs("div",{className:"relative",children:[e.jsx(ve,{label:"Create Password",type:u?"text":"password",placeholder:"Create a strong password",value:n.password,onChange:d=>v("password",d.target.value),error:c.password,required:!0}),e.jsx("button",{type:"button",onClick:()=>h(!u),className:"absolute right-3 top-8 text-secondary hover:text-primary transition-colors",children:u?e.jsx(cs,{className:"w-5 h-5"}):e.jsx(xt,{className:"w-5 h-5"})})]}),n.password&&e.jsxs("div",{className:"text-xs space-y-1 p-3 bg-gray-50 rounded-md",children:[e.jsx("p",{className:"font-medium text-secondary mb-2",children:"Password Requirements:"}),e.jsxs("div",{className:"grid grid-cols-1 gap-1",children:[e.jsxs("div",{className:`flex items-center ${y.length?"text-green-600":"text-gray-400"}`,children:[e.jsx("span",{className:"mr-2",children:y.length?"":""}),"At least 12 characters"]}),e.jsxs("div",{className:`flex items-center ${y.uppercase?"text-green-600":"text-gray-400"}`,children:[e.jsx("span",{className:"mr-2",children:y.uppercase?"":""}),"Uppercase letter"]}),e.jsxs("div",{className:`flex items-center ${y.lowercase?"text-green-600":"text-gray-400"}`,children:[e.jsx("span",{className:"mr-2",children:y.lowercase?"":""}),"Lowercase letter"]}),e.jsxs("div",{className:`flex items-center ${y.number?"text-green-600":"text-gray-400"}`,children:[e.jsx("span",{className:"mr-2",children:y.number?"":""}),"Number"]}),e.jsxs("div",{className:`flex items-center ${y.special?"text-green-600":"text-gray-400"}`,children:[e.jsx("span",{className:"mr-2",children:y.special?"":""}),"Special character"]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(ve,{label:"Confirm Password",type:f?"text":"password",placeholder:"Confirm your password",value:n.confirmPassword,onChange:d=>v("confirmPassword",d.target.value),error:c.confirmPassword,required:!0}),e.jsx("button",{type:"button",onClick:()=>b(!f),className:"absolute right-3 top-8 text-secondary hover:text-primary transition-colors",children:f?e.jsx(cs,{className:"w-5 h-5"}):e.jsx(xt,{className:"w-5 h-5"})})]})]}),e.jsx("div",{className:"mt-8",children:e.jsx(F,{onClick:T,className:"w-full",size:"lg",disabled:w,children:w?"Creating Organization...":"Continue to Security Setup"})}),e.jsx("div",{className:"mt-6 text-center text-sm text-muted",children:e.jsx("p",{children:"Strong passwords help protect your automation workspace"})})]})})}function sa({nextStep:t,prevStep:s,onSecurityData:r}){const{signUpData:a,updateSignUpData:o}=tt(),{setupTwoFactor:n,verifyTwoFactor:i,login:c,logout:m,isAuthenticated:u,token:h}=Le(),{showToast:f}=Ge(),[b,w]=l.useState(a.securityData?.method||null),[p,S]=l.useState(a.securityData?.code||""),[N,C]=l.useState(a.securityData?.secret||""),[k,j]=l.useState(a.securityData?.qrCodeUrl||""),[v,x]=l.useState(""),[T,y]=l.useState(!1),[d,g]=l.useState(!1),[A,O]=l.useState(a.securityData?.verified||!1),[D,L]=l.useState(!1),[U,M]=l.useState(0),[R,z]=l.useState(0),[J,te]=l.useState(!1);l.useEffect(()=>{b==="totp"&&!N&&!k&&a.accountData&&ue()},[b,N,k,a.accountData]);const ue=async()=>{if(!a.accountData?.email||!a.accountData?.password){x("Account credentials not available. Please go back and complete account creation.");return}if(a.orgChoice==="create"&&!a.organizationCreated){x("Organization not yet created. Please go back and complete the previous step.");return}y(!0),x("");try{let G=!u||!h;if(console.log(" Authentication check:",{isAuthenticated:u,hasToken:!!h,orgChoice:a.orgChoice,organizationCreated:a.organizationCreated,needsLogin:G}),G){L(!0),console.log(" User not authenticated, logging in...");const ze=await c(a.accountData.email,a.accountData.password);if(!ze.success)throw new Error(ze.message||"Failed to authenticate");L(!1),console.log(" Login successful for 2FA setup")}else console.log(" User already authenticated, proceeding with 2FA setup");console.log(" Calling setupTwoFactor...");const X=await n();console.log(" setupTwoFactor result:",X),C(X.secret),j(X.qrCodeUrl),o("securityData",{...a.securityData,method:"totp",secret:X.secret,qrCodeUrl:X.qrCodeUrl,code:p}),f({variant:"success",title:"2FA Setup Initiated",message:"Please scan the QR code with your authenticator app."})}catch(G){console.error("2FA setup error:",G),console.error("Error details:",{message:G.message,response:G.response?.data,status:G.response?.status,config:G.config}),M(X=>X+1),x(G.message||"Failed to setup 2FA. Please try again."),f({variant:"error",title:"2FA Setup Failed",message:`Attempt ${U+1}/3: Unable to generate QR code. ${U>=2?"Please contact support if issue persists.":"Please try again."}`})}finally{y(!1),L(!1)}},I=()=>{C(""),j(""),x(""),ue()},Y=async()=>{if(p.length!==6){x("Please enter a 6-digit code");return}g(!0),x("");try{const G=await i(p);if(G.success){O(!0);const X={method:b,secret:N,qrCodeUrl:k,code:p,verified:!0};o("securityData",X),r(X),f({variant:"success",title:"2FA Verified",message:"Two-factor authentication has been successfully enabled."}),setTimeout(()=>{t()},1500)}else throw new Error(G.message)}catch(G){console.error("2FA verification error:",G),z(X=>X+1),x(G.message||"Invalid verification code. Please try again."),f({variant:"error",title:"Verification Failed",message:`Attempt ${R+1}/5: Invalid code. ${R>=4?"Please check your authenticator app setup.":"Please check your authenticator app and try again."}`})}finally{g(!1)}},W=G=>{w(G),x(""),S(""),O(!1),G==="sms"&&o("securityData",{method:"sms",code:"",verified:!1})},oe=()=>{if(!b){x("Please select a security method.");return}if(b==="totp"&&!A){x("Please verify your 2FA setup before continuing.");return}if(b==="sms"&&p.length!==6){x("Please enter the 6-digit SMS code.");return}const G={method:b,secret:N,qrCodeUrl:k,code:p,verified:b==="sms"||A};o("securityData",G),r(G),t()},xe=b==="totp"?A:b==="sms"&&p.length===6;return e.jsx("div",{className:"w-full max-w-md mx-auto",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("button",{onClick:s,className:"mr-3 p-1 rounded-md hover:bg-gray-100 transition-colors",children:e.jsx(Oe,{className:"w-5 h-5 text-secondary"})}),e.jsx("h2",{className:"text-xl font-semibold text-primary",children:"Secure Your Account"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-3 text-base font-medium text-secondary",children:"Choose your security method:"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:`flex items-center border-2 rounded-lg px-4 py-3 cursor-pointer transition-all ${b==="totp"?"border-accent bg-accent/5":"border-gray-200 bg-transparent hover:border-accent/50"}`,children:[e.jsx("input",{type:"radio",name:"method",value:"totp",checked:b==="totp",onChange:()=>W("totp"),className:"hidden"}),e.jsx("span",{className:"mr-3",children:b==="totp"?e.jsx(Pe,{className:"w-5 h-5 text-accent"}):e.jsx(wr,{className:"w-5 h-5 text-gray-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-base font-medium text-primary",children:"Authenticator App (TOTP)"}),e.jsx("p",{className:"text-sm text-secondary mt-1",children:"Recommended - Use Google Authenticator or similar app"})]}),A&&b==="totp"&&e.jsx(Pe,{className:"w-5 h-5 text-green-600 ml-2"})]}),e.jsxs("label",{className:`flex items-center border-2 rounded-lg px-4 py-3 cursor-pointer transition-all ${b==="sms"?"border-accent bg-accent/5":"border-gray-200 bg-transparent hover:border-accent/50"}`,children:[e.jsx("input",{type:"radio",name:"method",value:"sms",checked:b==="sms",onChange:()=>W("sms"),className:"hidden"}),e.jsx("span",{className:"mr-3",children:b==="sms"?e.jsx(Pe,{className:"w-5 h-5 text-accent"}):e.jsx(wr,{className:"w-5 h-5 text-gray-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-base font-medium text-primary",children:"SMS Backup Code"}),e.jsx("p",{className:"text-sm text-secondary mt-1",children:"Receive codes via text message"})]})]})]})]}),b==="totp"&&e.jsxs("div",{className:"space-y-4",children:[!N&&!k&&e.jsxs("div",{className:"text-center py-4",children:[e.jsx(F,{onClick:ue,disabled:T||!a.accountData?.email,className:"w-full",children:T?e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"w-4 h-4 mr-2 animate-spin"}),D?"Authenticating...":"Setting up 2FA..."]}):"Setup Authenticator App"}),!a.accountData?.email&&e.jsxs("p",{className:"text-sm text-yellow-600 mt-2 flex items-center justify-center",children:[e.jsx(be,{className:"w-4 h-4 mr-1"}),"Account credentials not available"]})]}),k&&e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("p",{className:"text-sm text-secondary",children:"Scan this QR code with your authenticator app:"}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-48 h-48 border-2 border-gray-200 rounded-lg flex items-center justify-center bg-white",children:e.jsx("img",{src:`https://api.qrserver.com/v1/create-qr-code/?size=192x192&data=${encodeURIComponent(k)}`,alt:"2FA QR Code",className:"w-44 h-44"})})}),U>0&&U<3&&e.jsx("div",{className:"mt-4",children:e.jsxs(F,{onClick:I,variant:"outline",size:"sm",disabled:T,children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Retry QR Code Generation"]})})]}),k&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(ve,{label:"Verification Code",placeholder:"Enter 6-digit code",value:p,onChange:G=>{const X=G.target.value.replace(/\D/g,"");S(X),x("")},maxLength:6,error:v,disabled:A,className:"text-center text-lg font-mono"}),!A&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(F,{onClick:Y,disabled:p.length!==6||d,className:"w-full",variant:A?"success":"primary",children:d?e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"w-4 h-4 mr-2 animate-spin"}),"Verifying..."]}):"Verify & Enable 2FA"}),R>0&&R<5&&e.jsxs("p",{className:"text-sm text-yellow-600 text-center",children:["Attempt ",R,"/5 - Double-check the code in your authenticator app"]}),R>=3&&!A&&e.jsx("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Having trouble?"})," Make sure your device's time is synchronized and you're using the latest code."]})})]}),A&&e.jsx("div",{className:"text-center py-2",children:e.jsxs("div",{className:"inline-flex items-center text-green-600",children:[e.jsx(Pe,{className:"w-5 h-5 mr-2"}),e.jsx("span",{className:"font-medium",children:"2FA Successfully Enabled!"})]})})]})]}),b==="sms"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Note:"})," SMS-based 2FA is available as a backup option. For this demo, enter any 6-digit code to continue."]})}),e.jsx(ve,{label:"SMS Verification Code",placeholder:"Enter 6-digit SMS code",value:p,onChange:G=>{const X=G.target.value.replace(/\D/g,"");S(X),x("")},maxLength:6,error:v,className:"text-center text-lg font-mono"})]}),v&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-red-600 flex items-center",children:[e.jsx(be,{className:"w-4 h-4 mr-2"}),v]})}),e.jsxs("div",{className:"flex justify-between pt-4",children:[e.jsx(F,{variant:"secondary",onClick:s,disabled:d,children:"Back"}),e.jsx(F,{onClick:oe,disabled:!xe||d,children:b==="totp"&&A?"Continue":"Next"})]})]})]})})}function ra({nextStep:t,prevStep:s,onConsentData:r}){const{signUpData:a}=tt(),[o,n]=l.useState(a.consentData?.termsAccepted||!1),[i,c]=l.useState(a.consentData?.privacyAccepted||!1),[m,u]=l.useState({}),h=()=>{const f={};o||(f.consent1="You must acknowledge zero-trust policy."),i||(f.consent2="You must agree to the EULA."),u(f),Object.keys(f).length===0&&(r({termsAccepted:o,privacyAccepted:i}),t())};return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-fit bg-background relative overflow-hidden py-0 px-4",children:[e.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-accent/5 to-transparent"})}),e.jsx("div",{className:"z-10 mb-8 flex flex-col items-center",children:e.jsx("img",{src:je,alt:"Pandaura AS Logo",className:"h-24 w-auto filter-none",style:{filter:"none",imageRendering:"crisp-edges"}})}),e.jsxs("div",{className:"w-[600px] max-w-lg bg-surface border border-light rounded-lg shadow-card z-10 p-8",children:[e.jsx("h3",{className:"text-xl font-semibold text-primary text-center mb-6",children:"Zero-Trust Ready Consent"}),e.jsxs("form",{className:"space-y-6",onSubmit:f=>{f.preventDefault(),h()},children:[e.jsxs("div",{className:"relative",children:[e.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:o,onChange:f=>n(f.target.checked),className:"accent-accent w-[15px] h-[15px] mt-1"}),e.jsx("span",{className:"text-primary text-base",children:"I acknowledge Pandaura AS uses role-based access and activity monitoring in accordance with zero-trust security principles."})]}),m.consent1&&e.jsx("p",{className:"text-error text-sm mt-2",children:m.consent1})]}),e.jsx("div",{className:"relative",children:e.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i,onChange:f=>c(f.target.checked),className:"accent-accent w-[15px] h-[15px] mt-1"}),e.jsx("span",{className:"text-primary text-base",children:"I agree to the End User License Agreement."})]})}),e.jsx("a",{href:"/eula",target:"_blank",rel:"noopener noreferrer",className:"text-[#9090ee] underline ml-2 text-sm",children:"View EULA"}),m.consent2&&e.jsx("p",{className:"text-error text-sm mt-2",children:m.consent2}),e.jsxs("div",{className:"flex justify-between pt-2",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300 text-muted font-medium transition-all",onClick:s,children:"Back"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary hover:bg-secondary text-white rounded-md shadow-sm transition-all duration-200 focus:ring-2 focus:ring-accent focus:ring-offset-2 font-medium",children:"Next"})]})]})]})]})}function Lu(){const t=localStorage.getItem("pandaura_instance_id");if(t)return t;const s="INST-"+Math.random().toString(36).substr(2,9).toUpperCase();return localStorage.setItem("pandaura_instance_id",s),s}function Ru(){const t=document.createElement("canvas"),s=t.getContext("2d");s.textBaseline="top",s.font="14px Arial",s.fillText("Device fingerprint",2,2);const r=[navigator.userAgent,navigator.language,screen.width+"x"+screen.height,Intl.DateTimeFormat().resolvedOptions().timeZone,t.toDataURL()].join("|");let a=0;for(let o=0;o<r.length;o++){const n=r.charCodeAt(o);a=(a<<5)-a+n,a=a&a}return Math.abs(a).toString(36)}function aa({nextStep:t,prevStep:s,onEnvironmentData:r}){const{signUpData:a,updateSignUpData:o}=tt(),{showToast:n}=Ge(),[i,c]=l.useState(a.environmentData?.instanceId||""),[m,u]=l.useState(a.environmentData?.fingerprint||""),[h,f]=l.useState(!1),[b,w]=l.useState(""),[p,S]=l.useState(a.environmentData?.bound||!1),[N,C]=l.useState(0),[k,j]=l.useState(!1),[v,x]=l.useState(!1);l.useEffect(()=>{const g=Lu(),A=Ru();c(g),u(A);const O=a.orgChoice==="create";x(O),o("environmentData",{...a.environmentData,instanceId:g,fingerprint:A})},[]);const T=async()=>{f(!0),w("");try{console.log("Starting device binding for email:",a.accountData?.email);const g=await fetch(`${it.apiBaseUrl}/api/v1/auth/signup-device-bind`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({instanceId:i,deviceFingerprintHash:m,email:a.accountData?.email})});if(!g.ok){const O=await g.json().catch(()=>({}));throw new Error(O.message||"Failed to bind device")}S(!0),C(0);const A={instanceId:i,fingerprint:m,bound:!0,bindingTimestamp:new Date().toISOString(),isOrgCreator:v};o("environmentData",A),r(A),n({variant:"success",title:"Device Bound Successfully",message:"Your account is now securely bound to this device."}),setTimeout(()=>{t()},2e3)}catch(g){console.error("Device binding error:",g),C(A=>A+1),w(g.message||"Failed to bind device. Please try again."),n({variant:"error",title:"Device Binding Failed",message:`Attempt ${N+1}/3: ${g.message||"Device binding failed"}`})}finally{f(!1)}},y=()=>{w(""),S(!1),T()},d=()=>{if(!v){w("Manual override is only available for organization creators."),n({variant:"error",title:"Access Denied",message:"Manual override is restricted to organization creators only."});return}const g={instanceId:i,fingerprint:m,bound:!0,manualOverride:!0,bindingTimestamp:new Date().toISOString(),isOrgCreator:v};o("environmentData",g),r(g),n({variant:"success",title:"Manual Override Applied",message:"Device binding bypassed by organization creator."}),t()};return e.jsx("div",{className:"w-full max-w-md mx-auto",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("button",{onClick:s,className:"mr-3 p-1 rounded-md hover:bg-gray-100 transition-colors",children:e.jsx(Oe,{className:"w-5 h-5 text-secondary"})}),e.jsx("h2",{className:"text-xl font-semibold text-primary",children:"Environment Binding"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-16 h-16 bg-accent/10 rounded-full flex items-center justify-center",children:e.jsx(qe,{className:"w-8 h-8 text-accent"})})}),e.jsx("h3",{className:"text-lg font-semibold text-primary",children:"Secure Your Account"}),e.jsx("p",{className:"text-sm text-secondary",children:v?"As an organization creator, bind your device for enhanced security.":"Bind your account to this device and environment to prevent unauthorized access."}),v&&e.jsx("div",{className:"p-2 bg-blue-50 border border-blue-200 rounded-md",children:e.jsxs("p",{className:"text-xs text-blue-700",children:[e.jsx(qe,{className:"w-3 h-3 inline mr-1"}),"Organization Creator: Manual override available if binding fails"]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ma,{className:"w-5 h-5 text-secondary"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-primary",children:"Device Instance"}),e.jsx("p",{className:"text-xs text-secondary font-mono",children:i})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(qe,{className:"w-5 h-5 text-secondary"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-primary",children:"Device Fingerprint"}),e.jsxs("p",{className:"text-xs text-secondary font-mono",children:[m.substring(0,16),"..."]})]})]})]}),p?e.jsx("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Pe,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-800",children:"Device Successfully Bound"}),e.jsx("p",{className:"text-xs text-green-600",children:"Your account is now secured to this environment"})]})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(F,{onClick:T,disabled:h,className:"w-full",size:"lg",children:h?e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"w-4 h-4 mr-2 animate-spin"}),"Binding Device..."]}):e.jsxs(e.Fragment,{children:[e.jsx(qe,{className:"w-4 h-4 mr-2"}),"Bind This Device"]})}),N>0&&N<3&&!p&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs(F,{onClick:y,variant:"outline",className:"w-full",disabled:h,children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Retry Device Binding"]}),e.jsxs("p",{className:"text-sm text-yellow-600 text-center",children:["Attempt ",N,"/3 failed. Please try again."]})]}),(N>=3||v)&&!p&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-800",children:N>=3?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Multiple binding attempts failed."}),v?" As an organization creator, you can use manual override.":" Please contact support."]}):e.jsx(e.Fragment,{children:"Organization creators can use manual override if needed."})})}),(N>=3||v)&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>j(!k),className:"text-sm text-accent hover:text-accent-dark underline",children:[k?"Hide":"Show"," organization creator options"]}),k&&e.jsxs("div",{className:"p-3 bg-gray-50 border rounded-lg space-y-3",children:[e.jsx("p",{className:"text-sm font-medium text-secondary",children:"Organization Creator Options:"}),e.jsx(F,{onClick:d,variant:"outline",size:"sm",className:"w-full border-yellow-300 text-yellow-700 hover:bg-yellow-50",disabled:!v,children:v?"Manual Override (Creator)":"Override Not Available"}),e.jsxs("p",{className:"text-xs text-yellow-600",children:[" ",v?"As organization creator, you can bypass device binding. Use with caution.":"Manual override is only available to organization creators."]})]})]})]})]}),b&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-red-600 flex items-center",children:[e.jsx(be,{className:"w-4 h-4 mr-2"}),b]})}),e.jsxs("div",{className:"pt-4 space-y-3",children:[e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-xs text-secondary",children:"Device binding prevents credential reuse on unauthorized devices"})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(F,{variant:"secondary",onClick:s,disabled:h,children:"Back"}),p&&e.jsx(F,{onClick:t,children:"Continue to Finish"})]})]})]})]})]})})}function na({onComplete:t,isLoading:s}){const{signUpData:r}=tt(),a=()=>r.orgChoice==="create"?r.orgData?.orgName||"your organization":r.orgChoice==="join"?r.inviteData?.orgName||"the organization":"your organization",o=()=>r.orgChoice==="join"?r.inviteData?.role||"Member":"Admin",n=()=>r.securityData?.verified?"2FA Authentication enabled":r.securityData?.method==="sms"?"SMS backup authentication configured":"Basic authentication",i=()=>r.environmentData?.bound?r.environmentData.manualOverride?"Device binding overridden by administrator":"Device securely bound to account":"Device binding skipped";return e.jsx("div",{className:"w-full max-w-lg mx-auto",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[e.jsxs("div",{className:"text-center space-y-4 mb-8",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(Pe,{className:"w-12 h-12 text-green-600"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-primary mb-2",children:"Welcome to Pandaura AS!"}),e.jsxs("p",{className:"text-lg text-secondary",children:["Account created and joined ",e.jsx("strong",{children:a()})]}),e.jsx("p",{className:"text-sm text-secondary mt-1",children:"You're ready to collaborate with your team."})]})]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsx("h3",{className:"text-sm font-semibold text-secondary uppercase tracking-wide",children:"Setup Summary"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-blue-50 rounded-lg",children:[e.jsx(bs,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-blue-900",children:a()}),e.jsxs("p",{className:"text-xs text-blue-600",children:["Role: ",o()]})]}),e.jsx(Pe,{className:"w-4 h-4 text-green-600"})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-green-50 rounded-lg",children:[e.jsx(qe,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-green-900",children:"Security Setup"}),e.jsx("p",{className:"text-xs text-green-600",children:n()})]}),e.jsx(Pe,{className:"w-4 h-4 text-green-600"})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-purple-50 rounded-lg",children:[e.jsx(qe,{className:"w-5 h-5 text-purple-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-purple-900",children:"Device Security"}),e.jsx("p",{className:"text-xs text-purple-600",children:i()})]}),e.jsx(Pe,{className:"w-4 h-4 text-green-600"})]})]})]}),e.jsx("div",{className:"p-4 bg-gray-50 rounded-lg mb-8",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-secondary",children:"Account Email:"}),e.jsx("span",{className:"text-sm text-primary",children:r.accountData?.email})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-secondary",children:"Full Name:"}),e.jsx("span",{className:"text-sm text-primary",children:r.accountData?.fullName})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-secondary",children:"Organization:"}),e.jsx("span",{className:"text-sm text-primary",children:a()})]}),r.environmentData?.instanceId&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-secondary",children:"Device Instance:"}),e.jsx("span",{className:"text-xs font-mono text-secondary",children:r.environmentData.instanceId})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(F,{onClick:t,disabled:s,className:"w-full",size:"lg",children:s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Finalizing Setup..."]}):e.jsxs(e.Fragment,{children:["Go to Dashboard",e.jsx(Qe,{className:"w-4 h-4 ml-2"})]})}),e.jsx("p",{className:"text-center text-xs text-secondary",children:"Your organization context and team permissions are now active."})]}),e.jsx("div",{className:"mt-6 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("p",{className:"text-xs text-yellow-800",children:[e.jsx("strong",{children:"Security Notice:"})," Your account has been configured with enhanced security features.",r.securityData?.verified&&" Keep your authenticator app accessible for future logins.",r.environmentData?.bound&&" Your device binding helps protect against unauthorized access."]})})]})})}function Mu(){const[t,s]=l.useState(0),[r,a]=l.useState(!1),{createOrganization:o,acceptInvite:n,login:i,isAuthenticated:c,isLoading:m}=Le(),{signUpData:u,updateSignUpData:h,clearSignUpData:f,isComplete:b}=tt(),w=he();l.useEffect(()=>{!m&&!c?console.log(" SignUp: User not authenticated, staying in signup flow"):!m&&c&&u.orgChoice&&console.log(" SignUp: User is authenticated and in signup flow, continuing with steps")},[c,m,u.orgChoice]);const p=()=>s(g=>g+1),S=()=>s(g=>Math.max(g-1,0)),N=(g,A)=>{h("orgChoice",g),g==="join"&&A&&h("inviteData",A)},C=g=>{h("orgData",g)},k=g=>{h("accountData",g)},j=g=>{h("securityData",g)},v=g=>{h("consentData",g)},x=g=>{h("environmentData",g)},T=()=>{console.log(" SignUp: Clearing all signup data including localStorage for future sessions"),f(),localStorage.removeItem("pandaura_instance_id"),console.log(" SignUp: All signup data cleared - form will be empty on next visit")},y=async()=>{if(!u.accountData)throw new Error("Account data is required");a(!0);try{if(u.organizationCreated){T(),w("/home",{replace:!0});return}if(u.orgChoice==="create"){if(!u.orgData)throw new Error("Organization data is required");const g=await o({orgName:u.orgData.orgName,industry:u.orgData.industry,size:u.orgData.size,fullName:u.accountData.fullName,email:u.accountData.email,password:u.accountData.password});if(g.success)T(),w("/home",{replace:!0});else throw new Error(g.message||"Failed to create organization")}else if(u.orgChoice==="join"){if(!u.inviteData)throw new Error("Invite data is required");const g=await n({code:u.inviteData.code,fullName:u.accountData.fullName,email:u.accountData.email,password:u.accountData.password});if(g.success)T(),w("/home",{replace:!0});else throw new Error(g.message||"Failed to join organization")}}catch(g){console.error("Sign up error:",g),alert("Sign up failed. Please try again.")}finally{a(!1)}},d=()=>{switch(t){case 0:return e.jsx(Qr,{nextStep:p});case 1:return e.jsx(Pu,{nextStep:p,prevStep:S,onOrgChoice:N});case 2:return u.orgChoice==="join"?e.jsx(ta,{nextStep:p,prevStep:S,onAccountData:k,isJoining:!0,inviteData:u.inviteData}):e.jsx(Ou,{nextStep:p,prevStep:S,onOrgData:C,isJoining:!1,inviteData:u.inviteData});case 3:return u.orgChoice==="join"?e.jsx(sa,{nextStep:p,prevStep:S,onSecurityData:j}):e.jsx(ta,{nextStep:p,prevStep:S,onAccountData:k,isJoining:!1,inviteData:u.inviteData});case 4:return u.orgChoice==="join"?e.jsx(ra,{nextStep:p,prevStep:S,onConsentData:v}):e.jsx(sa,{nextStep:p,prevStep:S,onSecurityData:j});case 5:return u.orgChoice==="join"?e.jsx(aa,{nextStep:p,prevStep:S,onEnvironmentData:x}):e.jsx(ra,{nextStep:p,prevStep:S,onConsentData:v});case 6:return u.orgChoice==="join"?e.jsx(na,{onComplete:y,isLoading:r}):e.jsx(aa,{nextStep:p,prevStep:S,onEnvironmentData:x});case 7:return e.jsx(na,{onComplete:y,isLoading:r});default:return e.jsx(Qr,{nextStep:p})}};return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-background relative overflow-hidden py-8 px-4",children:[e.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-accent/5 to-transparent"})}),e.jsxs("div",{className:"z-10 w-full max-w-md",children:[t>0&&t<7&&e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"flex justify-center mb-2",children:e.jsxs("span",{className:"text-sm text-secondary",children:["Step ",t," of 6"]})}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-accent h-2 rounded-full transition-all duration-300",style:{width:`${t/6*100}%`}})})]}),d()]})]})}function Fu(){const{isAuthenticated:t,isLoading:s}=Le();return s?e.jsx("div",{className:"flex-1 flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-primary border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-muted",children:"Loading..."})]})}):e.jsx(qs,{to:"/signup",replace:!0})}function Iu(){return we.useEffect(()=>{cr()},[]),e.jsx(Zl,{children:e.jsx(Tu,{children:e.jsx(uc,{children:e.jsx(ec,{children:e.jsx(wn,{children:e.jsxs(Nn,{children:[e.jsx(Q,{path:"/",element:e.jsx(Fu,{})}),e.jsx(Q,{path:"/signup",element:e.jsx(Mu,{})}),e.jsx(Q,{path:"/signin",element:e.jsx(nu,{})}),e.jsx(Q,{path:"/eula",element:e.jsx(rc,{})}),e.jsx(Q,{path:"/home",element:e.jsx(ge,{children:e.jsx(ns,{})})}),e.jsx(Q,{path:"/home/projects",element:e.jsx(ge,{children:e.jsx(ns,{})})}),e.jsx(Q,{path:"/home/projects/:projectId",element:e.jsx(ge,{children:e.jsx(ns,{})})}),e.jsx(Q,{path:"/home/quick-tools",element:e.jsx(ge,{children:e.jsx(ns,{})})}),e.jsx(Q,{path:"/debug/projects",element:e.jsx(ge,{children:e.jsx(Au,{})})}),e.jsx(Q,{path:"/app",element:e.jsx(qs,{to:"/pandaura-as",replace:!0})}),e.jsx(Q,{path:"/pandaura-as",element:e.jsx(ge,{children:e.jsx(Re,{children:e.jsx(Ms,{})})})}),e.jsx(Q,{path:"/logic-studio",element:e.jsx(ge,{children:e.jsx(Re,{children:e.jsx(Xe,{children:e.jsx(Vs,{})})})})}),e.jsx(Q,{path:"/autodocs",element:e.jsx(ge,{children:e.jsx(Re,{children:e.jsx(Us,{})})})}),e.jsx(Q,{path:"/tag-database",element:e.jsx(ge,{children:e.jsx(Re,{children:e.jsx(Xe,{children:e.jsx(as,{})})})})}),e.jsx(Q,{path:"/tag-database/:projectId",element:e.jsx(ge,{children:e.jsx(Re,{children:e.jsx(Xe,{children:e.jsx(as,{})})})})}),e.jsx(Q,{path:"/case-studies",element:e.jsx(ge,{children:e.jsx(Re,{children:e.jsx(Bs,{})})})}),e.jsx(Q,{path:"/workspace/:projectId/pandaura-as",element:e.jsx(ge,{children:e.jsx(Ct,{children:e.jsx(Re,{children:e.jsx(Ms,{})})})})}),e.jsx(Q,{path:"/workspace/:projectId/logic-studio",element:e.jsx(ge,{children:e.jsx(Ct,{children:e.jsx(Re,{children:e.jsx(Xe,{children:e.jsx(Vs,{})})})})})}),e.jsx(Q,{path:"/workspace/:projectId/autodocs",element:e.jsx(ge,{children:e.jsx(Ct,{children:e.jsx(Re,{children:e.jsx(Us,{})})})})}),e.jsx(Q,{path:"/workspace/:projectId/tag-database",element:e.jsx(ge,{children:e.jsx(Ct,{children:e.jsx(Re,{children:e.jsx(Xe,{children:e.jsx(as,{})})})})})}),e.jsx(Q,{path:"/workspace/:projectId/case-studies",element:e.jsx(ge,{children:e.jsx(Ct,{children:e.jsx(Re,{children:e.jsx(Bs,{})})})})}),e.jsx(Q,{path:"/tool/logic",element:e.jsx(kt,{children:e.jsx(Xe,{children:e.jsx(Vs,{sessionMode:!0})})})}),e.jsx(Q,{path:"/tool/tags",element:e.jsx(kt,{children:e.jsx(Xe,{children:e.jsx(as,{sessionMode:!0})})})}),e.jsx(Q,{path:"/tool/autodocs",element:e.jsx(kt,{children:e.jsx(Us,{sessionMode:!0})})}),e.jsx(Q,{path:"/tool/signalflow",element:e.jsx(kt,{children:e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-primary",children:"SignalFlow (Coming Soon)"}),e.jsx("p",{className:"text-muted mt-2",children:"Signal path visualization and tracing"})]})})}),e.jsx(Q,{path:"/tool/assistant",element:e.jsx(kt,{children:e.jsx(Ms,{sessionMode:!0})})}),e.jsx(Q,{path:"/profile",element:e.jsx(ge,{children:e.jsx(tu,{})})}),e.jsx(Q,{path:"/feedback",element:e.jsx(Su,{})}),e.jsx(Q,{path:"/privacy",element:e.jsx(ku,{})}),e.jsx(Q,{path:"/terms",element:e.jsx(Cu,{})}),e.jsx(Q,{path:"/case-study-library",element:e.jsx(Bs,{})}),e.jsx(Q,{path:"*",element:e.jsx(qs,{to:"/signin",replace:!0})})]})})})})})})}cr();Tn.createRoot(document.getElementById("root")).render(e.jsx(we.StrictMode,{children:e.jsx(Iu,{})}));
